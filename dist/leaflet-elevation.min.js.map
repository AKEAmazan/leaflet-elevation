{"version":3,"file":"leaflet-elevation.min.js","sources":["../src/utils.js","../node_modules/leaflet-i18n/Leaflet.i18n.js","../src/components.js","../src/chart.js","../src/marker.js","../src/options.js","../src/summary.js","../src/control.js","../src/slope.js","../src/index.js"],"sourcesContent":["/**\n * Recursive deep merge objects.\n * Alternative to L.Util.setOptions(this, options).\n */\nexport function deepMerge(target, ...sources) {\n\tif (!sources.length) return target;\n\tconst source = sources.shift();\n\tif (isObject(target) && isObject(source)) {\n\t\tfor (const key in source) {\n\t\t\tif (isObject(source[key])) {\n\t\t\t\tif (!target[key]) Object.assign(target, {\n\t\t\t\t\t[key]: {}\n\t\t\t\t});\n\t\t\t\tdeepMerge(target[key], source[key]);\n\t\t\t} else {\n\t\t\t\tObject.assign(target, {\n\t\t\t\t\t[key]: source[key]\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\treturn deepMerge(target, ...sources);\n}\n\n/**\n * Wait for document load before execute function.\n */\nexport function deferFunc(f) {\n\tif (document.readyState !== 'complete') window.addEventListener(\"load\", f, { once: true });\n\telse f();\n}\n\n/*\n * Formatting funciton using the given decimals and seperator.\n */\nexport function formatter(num, dec, sep) {\n\tlet res = L.Util.formatNum(num, dec).toString();\n\tlet numbers = res.split(\".\");\n\tif (numbers[1]) {\n\t\tfor (let d = dec - numbers[1].length; d > 0; d--) {\n\t\t\tnumbers[1] += \"0\";\n\t\t}\n\t\tres = numbers.join(sep || \".\");\n\t}\n\treturn res;\n}\n\n/**\n * Simple GeoJSON data loader.\n */\nexport function GeoJSONLoader(data, control) {\n\tif (typeof data === \"string\") {\n\t\tdata = JSON.parse(data);\n\t}\n\tcontrol = control || this;\n\n\tlet layer = L.geoJson(data, {\n\t\tstyle: (feature) => {\n\t\t\tlet style = L.extend({}, control.options.polyline);\n\t\t\tif (control.options.theme) {\n\t\t\t\tstyle.className += ' ' + control.options.theme;\n\t\t\t}\n\t\t\treturn style;\n\t\t},\n\t\tpointToLayer: (feature, latlng) => {\n\t\t\tlet marker = L.marker(latlng, { icon: control.options.gpxOptions.marker_options.wptIcons[''] });\n\t\t\tlet desc = feature.properties.desc ? feature.properties.desc : '';\n\t\t\tlet name = feature.properties.name ? feature.properties.name : '';\n\t\t\tif (name || desc) {\n\t\t\t\tmarker.bindPopup(\"<b>\" + name + \"</b>\" + (desc.length > 0 ? '<br>' + desc : '')).openPopup();\n\t\t\t}\n\t\t\tcontrol.fire('waypoint_added', { point: marker, point_type: 'waypoint', element: latlng });\n\t\t\treturn marker;\n\t\t},\n\t\tonEachFeature: (feature, layer) => {\n\t\t\tif (feature.geometry.type == 'Point') return;\n\n\t\t\tcontrol.addData(feature, layer);\n\n\t\t\tcontrol.track_info = L.extend({}, control.track_info, { type: \"geojson\", name: data.name });\n\t\t},\n\t});\n\n\tcontrol._fireEvt(\"eledata_loaded\", { data: data, layer: layer, name: control.track_info.name, track_info: control.track_info }, true);\n\n\treturn layer;\n}\n\n/**\n * Simple GPX data loader.\n */\nexport function GPXLoader(data, control) {\n\tcontrol = control || this;\n\n\tcontrol.options.gpxOptions.polyline_options = L.extend({}, control.options.polyline, control.options.gpxOptions.polyline_options);\n\n\tif (control.options.theme) {\n\t\tcontrol.options.gpxOptions.polyline_options.className += ' ' + control.options.theme;\n\t}\n\n\tlet layer = new L.GPX(data, control.options.gpxOptions);\n\n\t// similar to L.GeoJSON.pointToLayer\n\tlayer.on('addpoint', (e) => {\n\t\tcontrol.fire(\"waypoint_added\", e, true);\n\t});\n\n\t// similar to L.GeoJSON.onEachFeature\n\tlayer.once(\"addline\", (e) => {\n\t\tcontrol.addData(e.line /*, layer*/ );\n\t\tcontrol.track_info = L.extend({}, control.track_info, { type: \"gpx\", name: layer.get_name() });\n\t});\n\n\t// unlike the L.GeoJSON, L.GPX parsing is async\n\tlayer.once('loaded', (e) => {\n\t\tcontrol._fireEvt(\"eledata_loaded\", { data: data, layer: layer, name: control.track_info.name, track_info: control.track_info }, true);\n\t});\n\n\treturn layer;\n}\n\n/**\n * Check DOM element visibility.\n */\nexport function isDomVisible(elem) {\n\treturn !!(elem.offsetWidth || elem.offsetHeight || elem.getClientRects().length);\n}\n\n/**\n * Check object type.\n */\nexport function isObject(item) {\n\treturn (item && typeof item === 'object' && !Array.isArray(item));\n}\n\n/**\n * Check DOM element viewport visibility.\n */\nexport function isVisible(elem) {\n\tif (!elem) return false;\n\n\tlet styles = window.getComputedStyle(elem);\n\n\tfunction isVisibleByStyles(elem, styles) {\n\t\treturn styles.visibility !== 'hidden' && styles.display !== 'none';\n\t}\n\n\tfunction isAboveOtherElements(elem, styles) {\n\t\tlet boundingRect = elem.getBoundingClientRect();\n\t\tlet left = boundingRect.left + 1;\n\t\tlet right = boundingRect.right - 1;\n\t\tlet top = boundingRect.top + 1;\n\t\tlet bottom = boundingRect.bottom - 1;\n\t\tlet above = true;\n\n\t\tlet pointerEvents = elem.style.pointerEvents;\n\n\t\tif (styles['pointer-events'] == 'none') elem.style.pointerEvents = 'auto';\n\n\t\tif (document.elementFromPoint(left, top) !== elem) above = false;\n\t\tif (document.elementFromPoint(right, top) !== elem) above = false;\n\n\t\t// Only for completely visible elements\n\t\t// if (document.elementFromPoint(left, bottom) !== elem) above = false;\n\t\t// if (document.elementFromPoint(right, bottom) !== elem) above = false;\n\n\t\telem.style.pointerEvents = pointerEvents;\n\n\t\treturn above;\n\t}\n\n\tif (!isVisibleByStyles(elem, styles)) return false;\n\tif (!isAboveOtherElements(elem, styles)) return false;\n\treturn true;\n}\n\n/**\n * Check JSON object type.\n */\nexport function isJSONDoc(doc, lazy) {\n\tlazy = typeof lazy === \"undefined\" ? true : lazy;\n\tif (typeof doc === \"string\" && lazy) {\n\t\tdoc = doc.trim();\n\t\treturn doc.indexOf(\"{\") == 0 || doc.indexOf(\"[\") == 0;\n\t} else {\n\t\ttry {\n\t\t\tJSON.parse(doc.toString());\n\t\t} catch (e) {\n\t\t\tif (typeof doc === \"object\" && lazy) return true;\n\t\t\tconsole.warn(e);\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n}\n\n/**\n * Check XML object type.\n */\nexport function isXMLDoc(doc, lazy) {\n\tlazy = typeof lazy === \"undefined\" ? true : lazy;\n\tif (typeof doc === \"string\" && lazy) {\n\t\tdoc = doc.trim();\n\t\treturn doc.indexOf(\"<\") == 0;\n\t} else {\n\t\tlet documentElement = (doc ? doc.ownerDocument || doc : 0).documentElement;\n\t\treturn documentElement ? documentElement.nodeName !== \"HTML\" : false;\n\t}\n}\n\n/**\n * Async JS script download.\n */\nexport function lazyLoader(url, skip, loader) {\n\tif (skip === false) {\n\t\treturn Promise.resolve();\n\t}\n\tif (loader instanceof Promise) {\n\t\treturn loader;\n\t}\n\treturn new Promise((resolve, reject) => {\n\t\tlet tag = document.createElement(\"script\");\n\t\ttag.addEventListener('load', resolve, { once: true });\n\t\ttag.src = url;\n\t\tdocument.head.appendChild(tag);\n\t});\n}\n\n/**\n * Download data from a remote url.\n */\nexport function loadFile(url, success) {\n\treturn new Promise((resolve, reject) => {\n\t\tlet xhr = new XMLHttpRequest();\n\t\txhr.responseType = \"text\";\n\t\txhr.open('GET', url);\n\t\txhr.onload = () => resolve(xhr.response);\n\t\txhr.onerror = () => reject(\"Error \" + xhr.status + \" while fetching remote file: \" + url);\n\t\txhr.send();\n\t});\n}\n\n/**\n * Generate download data event.\n */\nexport function saveFile(dataURI, fileName) {\n\tlet a = create('a', '', { href: dataURI, target: '_new', download: fileName || \"\", style: \"display:none;\" });\n\tlet b = document.body;\n\tb.appendChild(a);\n\ta.click();\n\tb.removeChild(a);\n}\n\n/**\n * Wait for element visible before execute function.\n */\nexport function waitHolder(elem) {\n\treturn new Promise((resolve, reject) => {\n\t\tlet ticking = false;\n\t\tlet scrollFn = () => {\n\t\t\tif (!ticking) {\n\t\t\t\tL.Util.requestAnimFrame(() => {\n\t\t\t\t\tif (isVisible(elem)) {\n\t\t\t\t\t\twindow.removeEventListener('scroll', scrollFn);\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t}\n\t\t\t\t\tticking = false;\n\t\t\t\t});\n\t\t\t\tticking = true;\n\t\t\t}\n\t\t};\n\t\twindow.addEventListener('scroll', scrollFn);\n\t\tif (elem) elem.addEventListener('mouseenter', scrollFn, { once: true });\n\t\tscrollFn();\n\t});\n}\n\n/**\n * A little bit safier than L.DomUtil.addClass\n */\nexport function addClass(targetNode, className) {\n\teach(className.split(\" \"), s => { if (targetNode && className) L.DomUtil.addClass(targetNode, s); });\n}\n\n/**\n * A little bit safier than L.DomUtil.removeClass()\n */\nexport function removeClass(targetNode, className) {\n\teach(className.split(\" \"), s => { if (targetNode && className) L.DomUtil.removeClass(targetNode, s); });\n}\n\nexport function style(targetNode, name, value) {\n\tif (typeof value === \"undefined\") return L.DomUtil.getStyle(targetNode, name);\n\telse return targetNode.style.setProperty(name, value);\n}\n\n/**\n * A little bit shorter than L.DomUtil.create()\n */\nexport function create(tagName, className, attributes, parent) {\n\tlet elem = L.DomUtil.create(tagName, className || \"\");\n\tif (attributes) setAttributes(elem, attributes);\n\tif (parent) append(parent, elem);\n\treturn elem;\n}\n\n/**\n * Same as node.appendChild()\n */\nexport function append(parent, child) {\n\treturn parent.appendChild(child);\n}\n\n/**\n * Same as node.insertAdjacentElement()\n */\nexport function insert(parent, child, position) {\n\treturn parent.insertAdjacentElement(position, child);\n}\n\n/**\n * Loop for node.setAttribute()\n */\nexport function setAttributes(elem, attrs) {\n\tfor (let k in attrs) { elem.setAttribute(k, attrs[k]); }\n}\n\n/**\n * Same as node.querySelector().\n */\nexport function select(selector, context) {\n\treturn (context || document).querySelector(selector);\n}\n\n/**\n * Alias for L.DomEvent.on.\n */\nexport const on = L.DomEvent.on;\n\n/**\n * Alias for L.DomEvent.off.\n */\nexport const off = L.DomEvent.off;\n\n/**\n * Alias for L.DomUtil.hasClass.\n */\nexport const hasClass = L.DomUtil.hasClass;\n\n\nexport function randomId() {\n\treturn Math.random().toString(36).substr(2, 9);\n}\n\nexport function each(obj, fn) {\n\tfor (let i in obj) fn(obj[i]);\n}\n","// Following https://github.com/Leaflet/Leaflet/blob/master/PLUGIN-GUIDE.md\n(function (factory, window) {\n\n    // define an AMD module that relies on 'leaflet'\n    if (typeof define === 'function' && define.amd) {\n        define(['leaflet'], factory);\n\n        // define a Common JS module that relies on 'leaflet'\n    } else if (typeof exports === 'object') {\n        module.exports = factory(require('leaflet'));\n    }\n\n    // attach your plugin to the global 'L' variable\n    if (typeof window !== 'undefined' && window.L) {\n        factory(window.L);\n\n    }\n}(function (L) {\n    L.locales = {};\n    L.locale = null;\n    L.registerLocale = function registerLocale(code, locale) {\n        L.locales[code] = L.Util.extend({}, L.locales[code], locale);\n    };\n    L.setLocale = function setLocale(code) {\n        L.locale = code;\n    };\n    return L.i18n = L._ = function translate(string, data) {\n        if (L.locale && L.locales[L.locale] && L.locales[L.locale][string]) {\n            string = L.locales[L.locale][string];\n        }\n        try {\n            // Do not fail if some data is missing\n            // a bad translation should not break the app\n            string = L.Util.template(string, data);\n        }\n        catch (err) {/*pass*/\n        }\n\n        return string;\n    };\n}, window));\n","export const Area = ({\n\tdata,\n\tname,\n\txAttr,\n\tyAttr,\n\tscaleX,\n\tscaleY,\n\theight,\n\tinterpolation = \"curveLinear\",\n}) => {\n\treturn path => {\n\t\tif (typeof interpolation === 'string') interpolation = d3[interpolation];\n\n\t\tlet area = d3.area().curve(interpolation)\n\t\t\t.x(d => (d.xDiagCoord = scaleX(d[xAttr])))\n\t\t\t.y0(height)\n\t\t\t.y1(d => scaleY(d[yAttr]));\n\n\t\tif (data) path.datum(data).attr(\"d\", area);\n\t\tif (name) path.attr('data-name', name);\n\n\t\treturn area;\n\t};\n};\n\nexport const AreaPath = (props) => {\n\treturn d3.create('svg:path')\n\t\t.attr(\"class\", \"area\")\n\t\t.call(Area(props));\n};\n\nexport const Axis = ({\n\ttype = \"axis\",\n\ttickSize = 6,\n\ttickPadding = 3,\n\tposition,\n\theight,\n\twidth,\n\taxis,\n\tscale,\n\tticks,\n\ttickFormat,\n\tlabel,\n\tlabelX,\n\tlabelY\n}) => {\n\treturn g => {\n\t\tlet [w, h] = [0, 0];\n\t\tif (position == \"bottom\") h = height;\n\t\tif (position == \"right\") w = width;\n\n\t\tif (axis == \"x\" && type == \"grid\") {\n\t\t\ttickSize = -height;\n\t\t} else if (axis == \"y\" && type == \"grid\") {\n\t\t\ttickSize = -width;\n\t\t}\n\n\t\tlet axisScale = d3[\"axis\" + position.replace(/\\b\\w/g, l => l.toUpperCase())]()\n\t\t\t.scale(scale)\n\t\t\t.ticks(ticks)\n\t\t\t.tickPadding(tickPadding)\n\t\t\t.tickSize(tickSize)\n\t\t\t.tickFormat(tickFormat);\n\n\t\tlet axisGroup = g.append(\"g\")\n\t\t\t.attr(\"class\", [axis, type, position].join(\" \"))\n\t\t\t.attr(\"transform\", \"translate(\" + w + \",\" + h + \")\")\n\t\t\t.call(axisScale);\n\n\t\tif (label) {\n\t\t\taxisGroup.append(\"text\")\n\t\t\t\t.attr(\"x\", labelX)\n\t\t\t\t.attr(\"y\", labelY)\n\t\t\t\t.text(label);\n\t\t}\n\n\t\treturn axisGroup;\n\t};\n};\n\nexport const DragRectangle = ({\n\tdragStartCoords,\n\tdragEndCoords,\n\theight,\n}) => {\n\treturn rect => {\n\t\tlet x1 = Math.min(dragStartCoords[0], dragEndCoords[0]);\n\t\tlet x2 = Math.max(dragStartCoords[0], dragEndCoords[0]);\n\n\t\treturn rect\n\t\t\t.attr(\"width\", x2 - x1)\n\t\t\t.attr(\"height\", height)\n\t\t\t.attr(\"x\", x1);\n\t};\n};\n\nexport const FocusRect = ({\n\twidth,\n\theight,\n}) => {\n\treturn rect => rect\n\t\t.attr(\"width\", width)\n\t\t.attr(\"height\", height)\n\t\t.style(\"fill\", \"none\")\n\t\t.style(\"stroke\", \"none\")\n\t\t.style(\"pointer-events\", \"all\");\n};\n\nexport const Grid = (props) => {\n\tprops.type = \"grid\";\n\treturn Axis(props);\n};\n\nexport const HeightFocusLine = ({\n\ttheme,\n\txCoord = 0,\n\tyCoord = 0,\n\tlength = 0,\n}) => {\n\treturn line => line\n\t\t.attr(\"class\", theme + \" height-focus line\")\n\t\t.attr(\"x1\", xCoord)\n\t\t.attr(\"x2\", xCoord)\n\t\t.attr(\"y1\", yCoord)\n\t\t.attr(\"y2\", length);\n};\n\nexport const HeightFocusLabel = ({\n\ttheme,\n\txCoord = 0,\n\tyCoord = 0,\n\tlabel,\n}) => {\n\treturn text => {\n\t\ttext\n\t\t\t.attr(\"class\", theme + \" height-focus-label\")\n\t\t\t.style(\"pointer-events\", \"none\")\n\t\t\t.attr(\"x\", xCoord + 5)\n\t\t\t.attr(\"y\", yCoord);\n\n\t\tlet y = text.select(\".height-focus-y\");\n\t\tif (!y.node()) y = text.append(\"svg:tspan\");\n\n\t\ty\n\t\t\t.attr(\"class\", \"height-focus-y\")\n\t\t\t.text(label);\n\n\t\ttext.selectAll('tspan').attr(\"x\", xCoord + 5);\n\n\t\treturn text;\n\t};\n};\n\nexport const HeightFocusPoint = ({\n\ttheme,\n\txCoord = 0,\n\tyCoord = 0,\n}) => {\n\treturn circle => circle\n\t\t.attr(\"class\", theme + \" height-focus circle-lower\")\n\t\t.attr(\"transform\", \"translate(\" + xCoord + \",\" + yCoord + \")\")\n\t\t.attr(\"r\", 6)\n\t\t.attr(\"cx\", 0)\n\t\t.attr(\"cy\", 0);\n};\n\n\nexport const LegendItem = ({\n\tname,\n\twidth,\n\theight,\n\tmargins = {},\n}) => {\n\treturn g => {\n\t\tg\n\t\t\t.attr(\"class\", \"legend-item legend-\" + name.toLowerCase())\n\t\t\t.attr(\"data-name\", name);\n\n\t\tg.append(\"rect\")\n\t\t\t.attr(\"class\", \"area\")\n\t\t\t.attr(\"x\", (width / 2) - 50)\n\t\t\t.attr(\"y\", height + margins.bottom / 2)\n\t\t\t.attr(\"width\", 50)\n\t\t\t.attr(\"height\", 10)\n\t\t\t.attr(\"opacity\", 0.75);\n\n\t\tg.append('text')\n\t\t\t.text(L._(name))\n\t\t\t.attr(\"x\", (width / 2) + 5)\n\t\t\t.attr(\"font-size\", 10)\n\t\t\t.style(\"text-decoration-thickness\", \"2px\")\n\t\t\t.style(\"font-weight\", \"700\")\n\t\t\t.attr('y', height + margins.bottom / 2)\n\t\t\t.attr('dy', \"0.75em\");\n\n\t\treturn g;\n\t}\n};\n\nexport const MouseFocusLine = ({\n\txCoord = 0,\n\theight,\n}) => {\n\treturn line => line\n\t\t.attr('class', 'mouse-focus-line')\n\t\t.attr('x2', xCoord)\n\t\t.attr('y2', 0)\n\t\t.attr('x1', xCoord)\n\t\t.attr('y1', height);\n};\n\nexport const MouseFocusLabel = ({\n\txCoord,\n\tyCoord,\n\tlabelX = \"\",\n\tlabelY = \"\",\n\twidth,\n}) => {\n\treturn g => {\n\n\t\tg.attr('class', 'mouse-focus-label');\n\n\t\tlet rect = g.select(\".mouse-focus-label-rect\");\n\t\tlet text = g.select(\".mouse-focus-label-text\");\n\t\tlet y = text.select(\".mouse-focus-label-y\");\n\t\tlet x = text.select(\".mouse-focus-label-x\");\n\n\t\tif (!rect.node()) rect = g.append(\"rect\");\n\t\tif (!text.node()) text = g.append(\"svg:text\");\n\t\tif (!y.node()) y = text.append(\"svg:tspan\");\n\t\tif (!x.node()) x = text.append(\"svg:tspan\");\n\n\t\ty.text(labelY);\n\t\tx.text(labelX);\n\n\t\t// Sets focus-label-text position to the left / right of the mouse-focus-line\n\t\tlet xAlign = 0;\n\t\tlet yAlign = 0;\n\t\tlet bbox = { width: 0, height: 0 };\n\t\ttry { bbox = text.node().getBBox(); } catch (e) { return g; }\n\n\t\tif (xCoord) xAlign = xCoord + (xCoord < width / 2 ? 10 : -bbox.width - 10);\n\t\tif (yCoord) yAlign = Math.max(yCoord - bbox.height, L.Browser.webkit ? 0 : -Infinity);\n\n\t\trect\n\t\t\t.attr(\"class\", \"mouse-focus-label-rect\")\n\t\t\t.attr(\"x\", xAlign - 5)\n\t\t\t.attr(\"y\", yAlign - 5)\n\t\t\t.attr(\"width\", bbox.width + 10)\n\t\t\t.attr(\"height\", bbox.height + 10)\n\t\t\t.attr(\"rx\", 3)\n\t\t\t.attr(\"ry\", 3);\n\t\ttext\n\t\t\t.attr(\"class\", \"mouse-focus-label-text\")\n\t\t\t.style(\"font-weight\", \"700\")\n\t\t\t.attr(\"y\", yAlign);\n\t\ty\n\t\t\t.attr(\"class\", \"mouse-focus-label-y\")\n\t\t\t.attr(\"dy\", \"1em\");\n\t\tx\n\t\t\t.attr(\"class\", \"mouse-focus-label-x\")\n\t\t\t.attr(\"dy\", \"2em\");\n\n\t\ttext.selectAll('tspan').attr(\"x\", xAlign);\n\n\t\treturn g;\n\t};\n};\n\nexport const Scale = ({\n\tdata,\n\tattr,\n\tmin,\n\tforceBounds,\n\trange,\n}) => {\n\tlet domain = data ? d3.extent(data, d => d[attr]) : [0, 1];\n\tif (typeof min !== \"undefined\" && (min < domain[0] || forceBounds)) {\n\t\tdomain[0] = min;\n\t}\n\tif (typeof max !== \"undefined\" && (max > domain[1] || forceBounds)) {\n\t\tdomain[1] = max;\n\t}\n\treturn d3.scaleLinear()\n\t\t.range(range)\n\t\t.domain(domain);\n};\n\nexport const Bisect = ({\n\tdata = [0, 1],\n\tscale,\n\tx,\n\tattr\n}) => {\n\treturn d3\n\t\t.bisector(d => d[attr])\n\t\t.left(data, scale.invert(x));\n};\n","import 'leaflet-i18n';\nimport * as _ from './utils';\nimport * as D3 from './components';\n\nexport var Chart = L.Class.extend({\n\n\tincludes: L.Evented ? L.Evented.prototype : L.Mixin.Events,\n\n\tinitialize: function(options) {\n\t\tlet opts = this.options = options;\n\n\t\tthis._data = [];\n\t\tthis._draggingEnabled = opts.dragging;\n\n\t\tif (this.options.imperial) {\n\t\t\t// this._distanceFactor = this.__mileFactor;\n\t\t\t// this._heightFactor = this.__footFactor;\n\t\t\tthis._xLabel = \"mi\";\n\t\t\tthis._yLabel = \"ft\";\n\t\t} else {\n\t\t\t// this._distanceFactor = this.options.distanceFactor;\n\t\t\t// this._heightFactor = this.options.heightFactor;\n\t\t\tthis._xLabel = this.options.xLabel;\n\t\t\tthis._yLabel = this.options.yLabel;\n\t\t}\n\n\t\tthis._xTicks = opts.xTicks;\n\t\tthis._yTicks = opts.yTicks;\n\n\t\tlet scale = this._updateScale();\n\n\t\tlet svg = this._svg = d3.create(\"svg\")\n\t\t\t.attr(\"class\", \"background\")\n\t\t\t.attr(\"width\", opts.width)\n\t\t\t.attr(\"height\", opts.height);\n\n\t\tlet g = svg\n\t\t\t.append(\"g\")\n\t\t\t.attr(\"transform\", \"translate(\" + opts.margins.left + \",\" + opts.margins.top + \")\")\n\t\t\t.call(this._appendGrid())\n\t\t\t.call(this._appendAxis())\n\t\t\t.call(this._appendAreaPath())\n\t\t\t.call(this._appendFocusable())\n\t\t\t.call(this._appendLegend());\n\n\t\tthis._grid = svg.select('.grid');\n\t\tthis._area = svg.select('.area');\n\t\tthis._path = svg.select('.area path');\n\t\tthis._axis = svg.select('.axis');\n\t\tthis._focus = svg.select('.focus');\n\t\tthis._focusRect = this._focus.select('rect');\n\t\tthis._legend = svg.select('.legend');\n\t\tthis._x = scale.x;\n\t\tthis._y = scale.y;\n\n\t},\n\n\tupdate: function(props) {\n\t\tif (props.data) this._data = props.data;\n\t\tif (props.options) this.options = props.options;\n\n\t\tthis._updateScale();\n\t\tthis._updateAxis();\n\t\tthis._updateAreaPath();\n\n\t\treturn this;\n\t},\n\n\trender: function() {\n\t\treturn container => container.append(() => this._svg.node());\n\t},\n\n\t_updateScale: function() {\n\t\tlet opts = this.options;\n\n\t\tthis._x = D3.Scale({\n\t\t\tdata: this._data,\n\t\t\trange: [0, this._width()],\n\t\t\tattr: opts.xAttr,\n\t\t\tmin: opts.xAxisMin,\n\t\t\tmax: opts.xAxisMax,\n\t\t\tforceBounds: opts.forceAxisBounds,\n\t\t});\n\n\t\tthis._y = D3.Scale({\n\t\t\tdata: this._data,\n\t\t\trange: [this._height(), 0],\n\t\t\tattr: opts.yAttr,\n\t\t\tmin: opts.yAxisMin,\n\t\t\tmax: opts.yAxisMax,\n\t\t\tforceBounds: opts.forceAxisBounds,\n\t\t});\n\n\t\treturn { x: this._x, y: this._y };\n\t},\n\n\t/**\n\t * Update chart axis.\n\t */\n\t_updateAxis: function() {\n\t\tthis._grid.selectAll('g').remove();\n\t\tthis._axis.selectAll('g').remove();\n\t\tthis._grid\n\t\t\t.call(this._appendXGrid())\n\t\t\t.call(this._appendYGrid());\n\t\tthis._axis\n\t\t\t.call(this._appendXaxis())\n\t\t\t.call(this._appendYaxis());\n\n\t\t// this.fire('axis_updated');\n\t},\n\n\t_updateAreaPath: function() {\n\t\tlet opts = this.options;\n\t\tthis._path\n\t\t\t.call(\n\t\t\t\tD3.Area({\n\t\t\t\t\tinterpolation: opts.interpolation,\n\t\t\t\t\tdata: this._data,\n\t\t\t\t\tname: 'Altitude',\n\t\t\t\t\txAttr: opts.xAttr,\n\t\t\t\t\tyAttr: opts.yAttr,\n\t\t\t\t\twidth: this._width(),\n\t\t\t\t\theight: this._height(),\n\t\t\t\t\tscaleX: this._x,\n\t\t\t\t\tscaleY: this._y,\n\t\t\t\t})\n\t\t\t);\n\t},\n\n\t/**\n\t * Generate \"grid\".\n\t */\n\t_appendGrid: function() {\n\t\treturn g =>\n\t\t\tg.append(\"g\")\n\t\t\t.attr(\"class\", \"grid\")\n\t\t\t.call(this._appendXGrid())\n\t\t\t.call(this._appendYGrid());\n\t},\n\n\t/**\n\t * Generate \"x-grid\".\n\t */\n\t_appendXGrid: function() {\n\t\treturn D3.Grid({\n\t\t\taxis: \"x\",\n\t\t\tposition: \"bottom\",\n\t\t\twidth: this._width(),\n\t\t\theight: this._height(),\n\t\t\tscale: this._x,\n\t\t\tticks: this._xTicks,\n\t\t\ttickFormat: \"\",\n\t\t});\n\t},\n\n\t/**\n\t * Generate \"y-grid\".\n\t */\n\t_appendYGrid: function() {\n\t\treturn D3.Grid({\n\t\t\taxis: \"y\",\n\t\t\tposition: \"left\",\n\t\t\twidth: this._width(),\n\t\t\theight: this._height(),\n\t\t\tscale: this._y,\n\t\t\tticks: this.options.yTicks,\n\t\t\ttickFormat: \"\",\n\t\t});\n\t},\n\n\t/**\n\t * Generate \"axis\".\n\t */\n\t_appendAxis: function() {\n\t\treturn g =>\n\t\t\tg.append(\"g\")\n\t\t\t.attr(\"class\", \"axis\")\n\t\t\t.call(this._appendXaxis())\n\t\t\t.call(this._appendYaxis());\n\t},\n\n\t/**\n\t * Generate \"x-axis\".\n\t */\n\t_appendXaxis: function() {\n\t\treturn D3.Axis({\n\t\t\taxis: \"x\",\n\t\t\tposition: \"bottom\",\n\t\t\twidth: this._width(),\n\t\t\theight: this._height(),\n\t\t\tscale: this._x,\n\t\t\tticks: this._xTicks,\n\t\t\tlabel: this._xLabel,\n\t\t\tlabelY: 25,\n\t\t\tlabelX: this._width() + 6,\n\t\t});\n\t},\n\n\t/**\n\t * Generate \"y-axis\".\n\t */\n\t_appendYaxis: function() {\n\t\treturn D3.Axis({\n\t\t\taxis: \"y\",\n\t\t\tposition: \"left\",\n\t\t\twidth: this._width(),\n\t\t\theight: this._height(),\n\t\t\tscale: this._y,\n\t\t\tticks: this.options.yTicks,\n\t\t\tlabel: this._yLabel,\n\t\t\tlabelX: -25,\n\t\t\tlabelY: 3,\n\t\t});\n\t},\n\n\t/**\n\t * Generate \"path\".\n\t */\n\t_appendAreaPath: function() {\n\t\treturn g => g.append('g')\n\t\t\t.attr(\"class\", \"area\")\n\t\t\t.append('path');\n\t},\n\n\t_appendFocusable: function() {\n\t\treturn g => {\n\t\t\treturn g.append('g')\n\t\t\t\t.attr(\"class\", 'focus')\n\t\t\t\t.call(this._appendFocusRect())\n\t\t\t\t.call(this._appendMouseFocusG());\n\t\t};\n\t},\n\n\t/**\n\t * Generate \"mouse-focus\" and \"drag-rect\".\n\t */\n\t_appendFocusRect: function() {\n\t\treturn g => {\n\t\t\tlet focusRect = g.append(\"rect\")\n\t\t\t\t.call(\n\t\t\t\t\tD3.FocusRect({\n\t\t\t\t\t\twidth: this._width(),\n\t\t\t\t\t\theight: this._height()\n\t\t\t\t\t})\n\t\t\t\t);\n\n\t\t\tif (L.Browser.mobile) {\n\t\t\t\tfocusRect\n\t\t\t\t\t.on(\"touchstart.drag\", this._dragStartHandler.bind(this))\n\t\t\t\t\t.on(\"touchmove.drag\", this._dragHandler.bind(this))\n\t\t\t\t\t.on(\"touchstart.focus\", this._mousemoveHandler.bind(this))\n\t\t\t\t\t.on(\"touchmove.focus\", this._mousemoveHandler.bind(this));\n\t\t\t\tL.DomEvent.on(this._svg.node(), 'touchend', this._dragEndHandler, this);\n\t\t\t}\n\n\t\t\tfocusRect\n\t\t\t\t.on(\"mousedown.drag\", this._dragStartHandler.bind(this))\n\t\t\t\t.on(\"mousemove.drag\", this._dragHandler.bind(this))\n\t\t\t\t.on(\"mouseenter.focus\", this._mouseenterHandler.bind(this))\n\t\t\t\t.on(\"mousemove.focus\", this._mousemoveHandler.bind(this))\n\t\t\t\t.on(\"mouseout.focus\", this._mouseoutHandler.bind(this));\n\t\t\tL.DomEvent.on(this._svg.node(), 'mouseup', this._dragEndHandler, this);\n\n\t\t\treturn focusRect;\n\t\t};\n\t},\n\n\t/**\n\t * Generate \"mouse-focus\".\n\t */\n\t_appendMouseFocusG: function() {\n\t\treturn g => {\n\t\t\tlet focusG = this._focusG = g.append(\"g\")\n\t\t\t\t.attr(\"class\", \"mouse-focus-group hidden\");\n\n\t\t\tthis._focusline = focusG.append('svg:line')\n\t\t\t\t.call(\n\t\t\t\t\tD3.MouseFocusLine({\n\t\t\t\t\t\txCoord: 0,\n\t\t\t\t\t\theight: this._height()\n\t\t\t\t\t})\n\t\t\t\t);;\n\t\t\tthis._focuslabel = focusG.append(\"g\")\n\t\t\t\t.call(\n\t\t\t\t\tD3.MouseFocusLabel({\n\t\t\t\t\t\txCoord: 0,\n\t\t\t\t\t\tyCoord: 0,\n\t\t\t\t\t\theight: this._height(),\n\t\t\t\t\t\twidth: this._width(),\n\t\t\t\t\t\tlabelX: \"\",\n\t\t\t\t\t\tlabelY: \"\",\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\treturn focusG;\n\t\t};\n\t},\n\n\t/**\n\t * Generate \"legend\".\n\t */\n\t_appendLegend: function() {\n\t\treturn g => {\n\t\t\t// if (!this.options.legend) return;\n\n\t\t\tlet legend = g.append('g')\n\t\t\t\t.attr(\"class\", \"legend\");\n\n\t\t\t// this.fire(\"legend\");\n\n\t\t\t// let items = legend.selectAll('.legend-item')\n\t\t\t// \t.on('click', (d, i) => {\n\t\t\t// \t\tlet target = items.nodes()[i];\n\t\t\t// \t\tlet name = target.getAttribute('data-name');\n\t\t\t// \t\tlet path = this._area.select('path[data-name=\"' + name + '\"]').node();\n\t\t\t// \t\t// this._fireEvt(\"elepath_toggle\", { path: path, name: name, legend: target });\n\t\t\t// \t});\n\n\t\t\treturn legend;\n\t\t};\n\t},\n\n\t/**\n\t * Calculates chart width.\n\t */\n\t_width: function() {\n\t\tlet opts = this.options;\n\t\treturn opts.width - opts.margins.left - opts.margins.right;\n\t},\n\n\t/**\n\t * Calculates chart height.\n\t */\n\t_height: function() {\n\t\tlet opts = this.options;\n\t\treturn opts.height - opts.margins.top - opts.margins.bottom;\n\t},\n\n\t/*\n\t * Handle drag operations.\n\t */\n\t_dragHandler: function() {\n\t\t//we don't want map events to occur here\n\t\td3.event.preventDefault();\n\t\td3.event.stopPropagation();\n\n\t\tthis._gotDragged = true;\n\t\tthis._drawDragRectangle();\n\t},\n\n\t/*\n\t * Handles start of drag operations.\n\t */\n\t_dragStartHandler: function() {\n\t\td3.event.preventDefault();\n\t\td3.event.stopPropagation();\n\n\t\tthis._gotDragged = false;\n\t\tthis._dragStartCoords = d3.mouse(this._focusRect.node());\n\t},\n\n\t/*\n\t * Draws the currently dragged rectangle over the chart.\n\t */\n\t_drawDragRectangle: function() {\n\t\tif (!this._dragStartCoords || !this._draggingEnabled) return;\n\t\tif (!this._dragRectangle) {\n\t\t\tthis._dragRectangle = this._focus.insert(\"rect\", \".mouse-focus-group\")\n\t\t\t\t.attr('class', 'mouse-drag')\n\t\t\t\t.style(\"pointer-events\", \"none\");\n\t\t}\n\t\tthis._dragRectangle.call(\n\t\t\tD3.DragRectangle({\n\t\t\t\tdragStartCoords: this._dragStartCoords,\n\t\t\t\tdragEndCoords: this._dragCurrentCoords = d3.mouse(this._focusRect.node()),\n\t\t\t\theight: this._height(),\n\t\t\t})\n\t\t);\n\t},\n\n\t/*\n\t * Handles end of drag operations. Zooms the map to the selected items extent.\n\t */\n\t_dragEndHandler: function() {\n\t\tif (!this._dragStartCoords || !this._dragCurrentCoords || !this._gotDragged) {\n\t\t\tthis._dragStartCoords = null;\n\t\t\tthis._gotDragged = false;\n\t\t\tif (this._draggingEnabled) this._resetDrag();\n\t\t\treturn;\n\t\t}\n\n\t\tlet start = this._findItemForX(this._dragStartCoords[0]);\n\t\tlet end = this._findItemForX(this._dragCurrentCoords[0]);\n\n\t\tif (start == end) return;\n\n\t\tthis._dragStartCoords = null;\n\t\tthis._gotDragged = false;\n\n\t\tthis.fire('dragged', { dragstart: this._data[start], dragend: this._data[end] });\n\t},\n\n\t/*\n\t * Handles the moueseenter over the chart.\n\t */\n\t_mouseenterHandler: function() {\n\t\tthis.fire(\"mouse_enter\");\n\t},\n\n\t/*\n\t * Handles the moueseover the chart and displays distance and altitude level.\n\t */\n\t_mousemoveHandler: function(d, i, ctx) {\n\t\tlet coords = d3.mouse(this._focusRect.node());\n\t\tlet xCoord = coords[0];\n\t\tlet item = this._data[this._findItemForX(xCoord)];\n\n\t\tthis.fire(\"mouse_move\", { item: item, xCoord: xCoord });\n\t},\n\n\t/*\n\t * Handles the moueseout over the chart.\n\t */\n\t_mouseoutHandler: function() {\n\t\tthis.fire(\"mouse_out\");\n\t},\n\n\t/*\n\t * Finds a data entry for a given x-coordinate of the diagram\n\t */\n\t_findItemForX: function(x) {\n\t\treturn d3\n\t\t\t.bisector(d => d[this.options.xAttr])\n\t\t\t.left(this._data || [0, 1], this._x.invert(x));\n\t},\n\n\t/*\n\t * Removes the drag rectangle and zoms back to the total extent of the data.\n\t */\n\t_resetDrag: function() {\n\t\tif (this._dragRectangle) {\n\t\t\tthis._dragRectangle.remove();\n\t\t\tthis._dragRectangle = null;\n\t\t\tthis._hideDiagramIndicator();\n\t\t\tthis.fire('reset_drag');\n\t\t}\n\t},\n\n\t/**\n\t * Display distance and altitude level (\"focus-rect\").\n\t */\n\t_showDiagramIndicator: function(item, xCoordinate) {\n\t\t// if (!this._chartEnabled) return;\n\n\t\tthis._focusG.classed(\"hidden\", false);\n\n\t\tlet opts = this.options;\n\t\tlet formatter = opts.hoverNumber.formatter;\n\t\tlet [fx, fy] = [opts.hoverNumber.decimalsX, opts.hoverNumber.decimalsY];\n\t\tlet yCoordinate = this._y(item[opts.yAttr]);\n\n\t\tthis._focusline.call(\n\t\t\tD3.MouseFocusLine({\n\t\t\t\txCoord: xCoordinate,\n\t\t\t\theight: this._height()\n\t\t\t})\n\t\t);\n\t\tthis._focuslabel.call(\n\t\t\tD3.MouseFocusLabel({\n\t\t\t\txCoord: xCoordinate,\n\t\t\t\tyCoord: yCoordinate,\n\t\t\t\theight: this._height(),\n\t\t\t\twidth: this._width(),\n\t\t\t\tlabelX: formatter(item[opts.xAttr], fx) + \" \" + this._xLabel,\n\t\t\t\tlabelY: formatter(item[opts.yAttr], fy) + \" \" + this._yLabel,\n\t\t\t})\n\t\t);\n\t},\n\n\t_hideDiagramIndicator: function() {\n\t\tthis._focusG.classed(\"hidden\", true);\n\t},\n});\n\nChart.addInitHook(function() {\n\tthis.on('mouse_move', function(e) {\n\t\tif (e.item) this._showDiagramIndicator(e.item, e.xCoord);\n\t});\n\n});\n","import 'leaflet-i18n';\nimport * as _ from './utils';\nimport * as D3 from './components';\n\nexport var Marker = L.Class.extend({\n\n\tinitialize: function(options) {\n\t\tthis.options = options;\n\n\t\tif (this.options.imperial) {\n\t\t\t// this._distanceFactor = this.__mileFactor;\n\t\t\t// this._heightFactor = this.__footFactor;\n\t\t\tthis._xLabel = \"mi\";\n\t\t\tthis._yLabel = \"ft\";\n\t\t} else {\n\t\t\t// this._distanceFactor = this.options.distanceFactor;\n\t\t\t// this._heightFactor = this.options.heightFactor;\n\t\t\tthis._xLabel = this.options.xLabel;\n\t\t\tthis._yLabel = this.options.yLabel;\n\t\t}\n\n\t\tif (this.options.marker == 'elevation-line') {\n\t\t\tlet g = this._heightG = d3.create(\"g\").attr(\"class\", \"height-focus-group\");\n\t\t\tthis._mouseHeightFocus = d3.create('svg:line');\n\t\t\tthis._pointG = d3.create(\"svg:circle\");\n\t\t\tthis._mouseHeightFocusLabel = d3.create(\"svg:text\");\n\t\t} else if (this.options.marker == 'position-marker') {\n\t\t\tthis._marker = L.marker([0, 0], { icon: this.options.markerIcon, zIndexOffset: 1000000, interactive: false });\n\t\t}\n\t},\n\n\taddTo: function(map) {\n\t\tthis._map = map;\n\t\tlet pane, renderer;\n\t\tif (!map.getPane('elevationPane')) {\n\t\t\tpane = this._pane = map.createPane('elevationPane');\n\t\t\tpane.style.zIndex = 625; // This pane is above markers but below popups.\n\t\t\tpane.style.pointerEvents = 'none';\n\t\t}\n\t\tif (this.options.marker == 'elevation-line') {\n\t\t\trenderer = L.svg({ pane: \"elevationPane\" }).addTo(this._map); // default leaflet svg renderer\n\t\t\tlet g = this._heightG = d3.select(renderer.getPane()).select(\"svg > g\").attr(\"class\", \"height-focus-group\");\n\t\t\tg.append(() => this._mouseHeightFocus.node());\n\t\t\tg.append(() => this._pointG.node());\n\t\t\tg.append(() => this._mouseHeightFocusLabel.node());\n\t\t} else if (this.options.marker == 'position-marker') {\n\t\t\tthis._marker.addTo(map, { pane: 'elevationPane' });\n\t\t}\n\t},\n\n\t/**\n\t * Update position marker (\"leaflet-marker\").\n\t */\n\tupdate: function(props) {\n\t\tif (props.options) this.options = props.options;\n\n\t\tlet opts = this.options;\n\n\t\tif (!this._map) this.addTo(props.map);\n\n\t\tthis._latlng = props.item.latlng;\n\n\t\tlet point = L.extend({}, props.item, this._map.latLngToLayerPoint(this._latlng));\n\n\t\tif (this.options.marker == 'elevation-line') {\n\n\t\t\tlet formatter = opts.hoverNumber.formatter;\n\t\t\tlet fy = opts.hoverNumber.decimalsY;\n\n\t\t\tlet normalizedAlt = this._height() / props.maxElevation * point.z;\n\t\t\tlet normalizedY = point.y - normalizedAlt;\n\n\t\t\tthis._heightG.classed(\"hidden\", false);\n\t\t\tthis._pointG.classed(\"hidden\", false);\n\n\t\t\tthis._pointG\n\t\t\t\t.call(\n\t\t\t\t\tD3.HeightFocusPoint({\n\t\t\t\t\t\ttheme: this.options.theme,\n\t\t\t\t\t\txCoord: point.x,\n\t\t\t\t\t\tyCoord: point.y,\n\t\t\t\t\t}));\n\n\t\t\tthis._mouseHeightFocus\n\t\t\t\t.call(\n\t\t\t\t\tD3.HeightFocusLine({\n\t\t\t\t\t\ttheme: this.options.theme,\n\t\t\t\t\t\txCoord: point.x,\n\t\t\t\t\t\tyCoord: point.y,\n\t\t\t\t\t\tlength: normalizedY\n\t\t\t\t\t})\n\t\t\t\t);\n\n\t\t\tthis._mouseHeightFocusLabel\n\t\t\t\t.call(\n\t\t\t\t\tD3.HeightFocusLabel({\n\t\t\t\t\t\ttheme: this.options.theme,\n\t\t\t\t\t\txCoord: point.x,\n\t\t\t\t\t\tyCoord: normalizedY,\n\t\t\t\t\t\tlabel: formatter(point[opts.yAttr], fy) + \" \" + this._yLabel\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t} else if (this.options.marker == 'position-marker') {\n\t\t\t_.removeClass(this._marker.getElement(), 'hidden');\n\t\t\tthis._marker.setLatLng(this._latlng);\n\t\t}\n\t},\n\n\t/*\n\t * Hides the position/height indicator marker drawn onto the map\n\t */\n\tremove: function() {\n\t\tif (this.options.marker == 'elevation-line') {\n\t\t\tif (this._heightG) this._heightG.classed(\"hidden\", true);\n\t\t\tif (this._pointG) this._pointG.classed(\"hidden\", true);\n\t\t} else if (this.options.marker == 'position-marker') {\n\t\t\t_.addClass(this._marker.getElement(), 'hidden');\n\t\t}\n\t},\n\n\tgetLatLng: function() {\n\t\treturn this._latlng;\n\t},\n\n\t/**\n\t * Calculates chart height.\n\t */\n\t_height: function() {\n\t\tlet opts = this.options;\n\t\treturn opts.height - opts.margins.top - opts.margins.bottom;\n\t},\n\n});","import * as _ from './utils';\n\nexport var Options = {\n\tautohide: !L.Browser.mobile,\n\tautohideMarker: true,\n\tcollapsed: false,\n\tdetached: true,\n\tdistanceFactor: 1,\n\tdragging: !L.Browser.mobile,\n\tdownloadLink: 'link',\n\televationDiv: \"#elevation-div\",\n\tfollowMarker: true,\n\tforceAxisBounds: false,\n\tgpxOptions: {\n\t\tasync: true,\n\t\tmarker_options: {\n\t\t\tstartIconUrl: null,\n\t\t\tendIconUrl: null,\n\t\t\tshadowUrl: null,\n\t\t\twptIcons: {\n\t\t\t\t'': L.divIcon({\n\t\t\t\t\tclassName: 'elevation-waypoint-marker',\n\t\t\t\t\thtml: '<i class=\"elevation-waypoint-icon\"></i>',\n\t\t\t\t\ticonSize: [30, 30],\n\t\t\t\t\ticonAnchor: [8, 30],\n\t\t\t\t})\n\t\t\t},\n\t\t},\n\t},\n\theight: 200,\n\theightFactor: 1,\n\thoverNumber: {\n\t\tdecimalsX: 2,\n\t\tdecimalsY: 0,\n\t\tformatter: _.formatter,\n\t},\n\timperial: false,\n\tinterpolation: \"curveLinear\",\n\tlazyLoadJS: true,\n\tlegend: true,\n\tloadData: {\n\t\tdefer: false,\n\t\tlazy: false,\n\t},\n\tmarker: 'elevation-line',\n\tmarkerIcon: L.divIcon({\n\t\tclassName: 'elevation-position-marker',\n\t\thtml: '<i class=\"elevation-position-icon\"></i>',\n\t\ticonSize: [32, 32],\n\t\ticonAnchor: [16, 16],\n\t}),\n\tplaceholder: false,\n\tposition: \"topright\",\n\tpolyline: {\n\t\tclassName: 'elevation-polyline',\n\t\tcolor: '#000',\n\t\topacity: 0.75,\n\t\tweight: 5,\n\t\tlineCap: 'round'\n\t},\n\treverseCoords: false,\n\tskipNullZCoords: false,\n\ttheme: \"lightblue-theme\",\n\tmargins: {\n\t\ttop: 10,\n\t\tright: 20,\n\t\tbottom: 30,\n\t\tleft: 50\n\t},\n\tresponsive: true,\n\tsummary: 'inline',\n\tslope: false,\n\twidth: 600,\n\txAttr: \"dist\",\n\txLabel: \"km\",\n\txTicks: undefined,\n\tyAttr: \"z\",\n\tyAxisMax: undefined,\n\tyAxisMin: undefined,\n\tyLabel: \"m\",\n\tyTicks: undefined,\n\tzFollow: 13,\n};\n","export var Summary = L.Class.extend({\n\n});\n","import 'leaflet-i18n';\nimport * as _ from './utils';\nimport * as D3 from './components';\nimport { Chart } from './chart';\nimport { Marker } from './marker';\nimport { Summary } from './summary';\nimport { Options } from './options';\n\nexport const Elevation = L.Control.Elevation = L.Control.extend({\n\n\tincludes: L.Evented ? L.Evented.prototype : L.Mixin.Events,\n\n\toptions: Options,\n\t__mileFactor: 0.621371,\n\t__footFactor: 3.28084,\n\t__D3: 'https://unpkg.com/d3@5.15.0/dist/d3.min.js',\n\t__LGPX: 'https://unpkg.com/leaflet-gpx@1.5.0/gpx.js',\n\n\t/*\n\t * Add data to the diagram either from GPX or GeoJSON and update the axis domain and data\n\t */\n\taddData: function(d, layer) {\n\t\tif ((typeof layer === \"undefined\" || layer === null) && d.on) {\n\t\t\tlayer = d;\n\t\t}\n\t\tElevation._d3LazyLoader = _.lazyLoader(\n\t\t\tthis.__D3,\n\t\t\ttypeof d3 !== 'object' || !this.options.lazyLoadJS,\n\t\t\tElevation._d3LazyLoader\n\t\t).then(() => {\n\t\t\tthis._addData(d);\n\t\t\tthis._addLayer(layer);\n\t\t\tthis._fireEvt(\"eledata_added\", { data: d, layer: layer, track_info: this.track_info });\n\t\t});\n\t},\n\n\t/**\n\t * Adds the control to the given map.\n\t */\n\taddTo: function(map) {\n\t\tif (this.options.detached) {\n\t\t\tlet eleDiv = this._initElevationDiv();\n\t\t\tif (!eleDiv.isConnected) _.insert(map._container, eleDiv, 'afterend');\n\t\t\t_.append(eleDiv, this.onAdd(map));\n\t\t} else {\n\t\t\tL.Control.prototype.addTo.call(this, map);\n\t\t}\n\t\treturn this;\n\t},\n\n\t/*\n\t * Reset data and display\n\t */\n\tclear: function() {\n\t\tthis._clearPath();\n\t\tthis._clearChart();\n\t\tthis._clearData();\n\n\t\tthis._fireEvt(\"eledata_clear\");\n\t},\n\n\t/**\n\t * Disable dragging chart on touch events.\n\t */\n\tdisableDragging: function() {\n\t\tthis._chart._draggingEnabled = false;\n\t\tthis._resetDrag();\n\t},\n\n\t/**\n\t * Enable dragging chart on touch events.\n\t */\n\tenableDragging: function() {\n\t\tthis._chart._draggingEnabled = true;\n\t},\n\n\t/**\n\t * Sets a map view that contains the given geographical bounds.\n\t */\n\tfitBounds: function(bounds) {\n\t\tbounds = bounds || this.getBounds();\n\t\tif (this._map && bounds.isValid()) this._map.fitBounds(bounds);\n\t},\n\n\tgetBounds: function(data) {\n\t\tdata = data || this._data;\n\t\treturn L.latLngBounds(data.map((d) => d.latlng));\n\t},\n\n\t/**\n\t * Get default zoom level when \"followMarker\" is true.\n\t */\n\tgetZFollow: function() {\n\t\treturn this._zFollow;\n\t},\n\n\t/**\n\t * Hide current elevation chart profile.\n\t */\n\thide: function() {\n\t\t_.style(this._container, \"display\", \"none\");\n\t},\n\n\t/**\n\t * Initialize chart control \"options\" and \"container\".\n\t */\n\tinitialize: function(options) {\n\t\tthis.options = _.deepMerge({}, this.options, options);\n\n\t\tif (this.options.imperial) {\n\t\t\tthis._distanceFactor = this.__mileFactor;\n\t\t\tthis._heightFactor = this.__footFactor;\n\t\t\tthis._xLabel = \"mi\";\n\t\t\tthis._yLabel = \"ft\";\n\t\t} else {\n\t\t\tthis._distanceFactor = this.options.distanceFactor;\n\t\t\tthis._heightFactor = this.options.heightFactor;\n\t\t\tthis._xLabel = this.options.xLabel;\n\t\t\tthis._yLabel = this.options.yLabel;\n\t\t}\n\n\t\tthis._chartEnabled = true;\n\t\tthis._zFollow = this.options.zFollow;\n\n\t\tif (this.options.followMarker) this._setMapView = L.Util.throttle(this._setMapView, 300, this);\n\t\tif (this.options.placeholder) this.options.loadData.lazy = this.options.loadData.defer = true;\n\n\t\tif (this.options.legend) this.options.margins.bottom += 30;\n\t},\n\n\t/**\n\t * Alias for loadData\n\t */\n\tload: function(data, opts) {\n\t\tthis.loadData(data, opts);\n\t},\n\n\t/**\n\t * Alias for addTo\n\t */\n\tloadChart: function(map) {\n\t\tthis.addTo(map);\n\t},\n\n\t/**\n\t * Load elevation data (GPX or GeoJSON).\n\t */\n\tloadData: function(data, opts) {\n\t\topts = L.extend({}, this.options.loadData, opts);\n\t\tif (opts.defer) {\n\t\t\tthis.loadDefer(data, opts);\n\t\t} else if (opts.lazy) {\n\t\t\tthis.loadLazy(data, opts);\n\t\t} else if (_.isXMLDoc(data)) {\n\t\t\tthis.loadGPX(data);\n\t\t} else if (_.isJSONDoc(data)) {\n\t\t\tthis.loadGeoJSON(data);\n\t\t} else {\n\t\t\tthis.loadFile(data);\n\t\t}\n\t},\n\n\t/**\n\t * Wait for document load before download data.\n\t */\n\tloadDefer: function(data, opts) {\n\t\topts = L.extend({}, this.options.loadData, opts);\n\t\topts.defer = false;\n\t\t_.deferFunc(L.bind(this.loadData, this, data, opts));\n\t},\n\n\t/**\n\t * Load data from a remote url.\n\t */\n\tloadFile: function(url) {\n\t\t_.loadFile(url)\n\t\t\t.then((data) => {\n\t\t\t\tthis._downloadURL = url; // TODO: handle multiple urls?\n\t\t\t\tthis.loadData(data, { lazy: false, defer: false });\n\t\t\t})\n\t\t\t.catch((err) => console.warn(err));\n\t},\n\n\t/**\n\t * Load raw GeoJSON data.\n\t */\n\tloadGeoJSON: function(data) {\n\t\t_.GeoJSONLoader(data, this);\n\t},\n\n\t/**\n\t * Load raw GPX data.\n\t */\n\tloadGPX: function(data) {\n\t\tElevation._gpxLazyLoader = _.lazyLoader(\n\t\t\tthis.__LGPX,\n\t\t\ttypeof L.GPX !== 'function' || !this.options.lazyLoadJS,\n\t\t\tElevation._gpxLazyLoader\n\t\t).then(() => _.GPXLoader(data, this));\n\t},\n\n\t/**\n\t * Wait for chart container visible before download data.\n\t */\n\tloadLazy: function(data, opts) {\n\t\topts = L.extend({}, this.options.loadData, opts);\n\t\tlet elem = opts.lazy.parentNode ? opts.lazy : this.placeholder;\n\t\t_.waitHolder(opts.lazy)\n\t\t\t.then(() => {\n\t\t\t\topts.lazy = false;\n\t\t\t\tthis.loadData(data, opts)\n\t\t\t\tthis.once('eledata_loaded', () => opts.lazy.parentNode.removeChild(elem));\n\t\t\t});\n\t},\n\n\t/**\n\t * Create container DOM element and related event listeners.\n\t * Called on control.addTo(map).\n\t */\n\tonAdd: function(map) {\n\t\tthis._map = map;\n\n\t\tlet container = this._container = _.create(\"div\", \"elevation-control elevation \" + this.options.theme);\n\n\t\tif (!this.options.detached) {\n\t\t\t_.addClass(container, 'leaflet-control');\n\t\t}\n\n\t\tif (this.options.placeholder && !this._data) {\n\t\t\tthis.placeholder = _.create('img', 'elevation-placeholder', typeof this.options.placeholder === 'string' ? { src: this.options.placeholder, alt: '' } : this.options.placeholder);\n\t\t\t_.insert(container, this.placeholder, 'beforebegin');\n\t\t}\n\n\t\tElevation._d3LazyLoader = _.lazyLoader(\n\t\t\tthis.__D3,\n\t\t\ttypeof d3 !== 'object' || !this.options.lazyLoadJS,\n\t\t\tElevation._d3LazyLoader\n\t\t).then(() => {\n\t\t\tthis._initToggle(container);\n\t\t\tthis._initChart(container);\n\t\t\tthis._initMarker(container);\n\n\t\t\tthis._map.on('zoom viewreset zoomanim', this._hidePositionMarker, this);\n\t\t\tthis._map.on('resize', this._resetView, this);\n\t\t\tthis._map.on('resize', this._resizeChart, this);\n\t\t\tthis._map.on('mousedown', this._resetDrag, this);\n\n\t\t\t_.on(this._map._container, 'mousewheel', this._resetDrag, this);\n\t\t\t_.on(this._map._container, 'touchstart', this._resetDrag, this);\n\n\t\t\tthis.on('eledata_added', this._updateChart, this);\n\t\t\tthis.on('eledata_added', this._updateSummary, this);\n\n\t\t\tthis._updateChart();\n\t\t\tthis._updateSummary();\n\t\t});\n\n\t\treturn container;\n\t},\n\n\t/**\n\t * Clean up control code and related event listeners.\n\t * Called on control.remove().\n\t */\n\tonRemove: function(map) {\n\t\tthis._container = null;\n\n\t\tthis._map.off('zoom viewreset zoomanim', this._hidePositionMarker, this);\n\t\tthis._map.off('resize', this._resetView, this);\n\t\tthis._map.off('resize', this._resizeChart, this);\n\t\tthis._map.off('mousedown', this._resetDrag, this);\n\n\t\t_.off(this._map._container, 'mousewheel', this._resetDrag, this);\n\t\t_.off(this._map._container, 'touchstart', this._resetDrag, this);\n\n\t\tthis.off('eledata_added', this._updateChart, this);\n\t\tthis.off('eledata_added', this._updateSummary, this);\n\t},\n\n\t/**\n\t * Redraws the chart control. Sometimes useful after screen resize.\n\t */\n\tredraw: function() {\n\t\tthis._resizeChart();\n\t},\n\n\t/**\n\t * Set default zoom level when \"followMarker\" is true.\n\t */\n\tsetZFollow: function(zoom) {\n\t\tthis._zFollow = zoom;\n\t},\n\n\t/**\n\t * Hide current elevation chart profile.\n\t */\n\tshow: function() {\n\t\t_.style(this._container, \"display\", \"block\");\n\t},\n\n\t/*\n\t * Parsing data either from GPX or GeoJSON and update the diagram data\n\t */\n\t_addData: function(d) {\n\t\tlet geom = d && d.geometry;\n\t\tlet feat = d && d.type === \"FeatureCollection\";\n\t\tlet gpx = d && d._latlngs;\n\n\t\tif (geom) {\n\t\t\tswitch (geom.type) {\n\t\t\t\tcase 'LineString':\n\t\t\t\t\tthis._addGeoJSONData(geom.coordinates);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'MultiLineString':\n\t\t\t\t\t_.each(geom.coordinates, coords => this._addGeoJSONData(coords));\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.warn('Unsopperted GeoJSON feature geometry type:' + geom.type);\n\t\t\t}\n\t\t}\n\n\t\tif (feat) {\n\t\t\t_.each(d.features, feature => this._addData(feature));\n\t\t}\n\n\t\tif (gpx) {\n\t\t\tthis._addGPXData(d._latlngs);\n\t\t}\n\t},\n\n\t/*\n\t * Parsing of GeoJSON data lines and their elevation in z-coordinate\n\t */\n\t_addGeoJSONData: function(coords) {\n\t\t_.each(coords, point => this._addPoint(point[1], point[0], point[2]));\n\t},\n\n\t/*\n\t * Parsing function for GPX data and their elevation in z-coordinate\n\t */\n\t_addGPXData: function(coords) {\n\t\t_.each(coords, point => this._addPoint(point.lat, point.lng, point.meta.ele));\n\t},\n\n\t/*\n\t * Parse and push a single (x, y, z) point to current elevation profile.\n\t */\n\t_addPoint: function(x, y, z) {\n\t\tif (this.options.reverseCoords) {\n\t\t\t[x, y] = [y, x];\n\t\t}\n\n\t\tlet data = this._data || [];\n\t\tlet eleMax = this._maxElevation || -Infinity;\n\t\tlet eleMin = this._minElevation || +Infinity;\n\t\tlet dist = this._distance || 0;\n\n\t\tlet curr = new L.LatLng(x, y);\n\t\tlet prev = data.length ? data[data.length - 1].latlng : curr;\n\n\t\tlet delta = curr.distanceTo(prev) * this._distanceFactor;\n\n\t\tdist = dist + Math.round(delta / 1000 * 100000) / 100000;\n\n\t\t// check and fix missing elevation data on last added point\n\t\tif (!this.options.skipNullZCoords && data.length > 0) {\n\t\t\tlet prevZ = data[data.length - 1].z;\n\t\t\tif (isNaN(prevZ)) {\n\t\t\t\tlet lastZ = this._lastValidZ;\n\t\t\t\tlet currZ = z * this._heightFactor;\n\t\t\t\tif (!isNaN(lastZ) && !isNaN(currZ)) {\n\t\t\t\t\tprevZ = (lastZ + currZ) / 2;\n\t\t\t\t} else if (!isNaN(lastZ)) {\n\t\t\t\t\tprevZ = lastZ;\n\t\t\t\t} else if (!isNaN(currZ)) {\n\t\t\t\t\tprevZ = currZ;\n\t\t\t\t}\n\t\t\t\tif (!isNaN(prevZ)) data[data.length - 1].z = prevZ;\n\t\t\t\telse data.splice(data.length - 1, 1);\n\t\t\t}\n\t\t}\n\n\t\tz = z * this._heightFactor;\n\n\t\t// skip point if it has not elevation\n\t\tif (!isNaN(z)) {\n\t\t\teleMax = eleMax < z ? z : eleMax;\n\t\t\teleMin = eleMin > z ? z : eleMin;\n\t\t\tthis._lastValidZ = z;\n\t\t}\n\n\t\tdata.push({\n\t\t\tdist: dist,\n\t\t\tx: x,\n\t\t\ty: y,\n\t\t\tz: z,\n\t\t\tlatlng: curr\n\t\t});\n\n\t\tthis._data = data;\n\t\tthis.track_info = this.track_info || {};\n\t\tthis.track_info.distance = this._distance = dist;\n\t\tthis.track_info.elevation_max = this._maxElevation = eleMax;\n\t\tthis.track_info.elevation_min = this._minElevation = eleMin;\n\n\t\tthis._fireEvt(\"eledata_updated\", { index: data.length - 1 });\n\t},\n\n\t_addLayer: function(layer) {\n\t\tif (layer) {\n\t\t\t_.addClass(layer._path, this.options.polyline.className + ' ' + this.options.theme);\n\n\t\t\tlayer\n\t\t\t\t.on(\"mousemove\", this._mousemoveLayerHandler, this)\n\t\t\t\t.on(\"mouseout\", this._mouseoutHandler, this);\n\n\t\t\tthis._layers = this._layers || {};\n\t\t\tthis._layers[L.Util.stamp(layer)] = layer;\n\t\t}\n\t},\n\n\t/**\n\t * Adds the control to the given \"detached\" div.\n\t */\n\t_initElevationDiv: function() {\n\t\tlet eleDiv = _.select(this.options.elevationDiv);\n\t\tif (!eleDiv) {\n\t\t\tthis.options.elevationDiv = '#elevation-div_' + _.randomId();\n\t\t\teleDiv = _.create('div', 'leaflet-control elevation elevation-div', { id: this.options.elevationDiv.substr(1) });\n\t\t}\n\t\tif (this.options.detached) {\n\t\t\t_.addClass(eleDiv, 'elevation-detached');\n\t\t\t_.removeClass(eleDiv, 'leaflet-control');\n\t\t}\n\t\tthis.eleDiv = eleDiv;\n\t\treturn this.eleDiv;\n\t},\n\n\t/**\n\t * Generate \"div\" summary container.\n\t */\n\t_appendSummary: function() {\n\t\treturn container => {\n\t\t\tlet summary = this.summaryDiv = container.append(\"div\")\n\t\t\t\t.attr(\"class\", \"elevation-summary \" + (this.options.summary ? this.options.summary + \"-summary\" : '')).node();\n\t\t\t// let summary = this.summaryDiv = _.create('div', \"elevation-summary \" + (this.options.summary ? this.options.summary + \"-summary\" : ''), container);\n\n\t\t\t_.style(this.summaryDiv, 'max-width', this.options.width + \"px\");\n\n\t\t\tthis._updateSummary();\n\t\t\treturn summary;\n\t\t};\n\t},\n\n\t/*\n\t * Reset chart.\n\t */\n\t_clearChart: function() {\n\t\tthis._resetDrag();\n\t},\n\n\t/*\n\t * Reset data.\n\t */\n\t_clearData: function() {\n\t\tthis._data = null;\n\t\tthis._distance = null;\n\t\tthis._maxElevation = null;\n\t\tthis._minElevation = null;\n\t\tthis.track_info = null;\n\t\tthis._layers = null;\n\t},\n\n\t/*\n\t * Reset path.\n\t */\n\t_clearPath: function() {\n\t\tthis._hidePositionMarker();\n\t\t_.each(this._layers, l => _.removeClass(l._path, this.options.polyline.className + ' ' + this.options.theme));\n\t},\n\n\t/*\n\t * Collapse current chart control.\n\t */\n\t_collapse: function() {\n\t\t_.removeClass(this._container, 'elevation-expanded');\n\t\t_.addClass(this._container, 'elevation-collapsed');\n\t},\n\n\t/*\n\t * Expand current chart control.\n\t */\n\t_expand: function() {\n\t\t_.removeClass(this._container, 'elevation-collapsed');\n\t\t_.addClass(this._container, 'elevation-expanded');\n\t},\n\n\t/*\n\t * Finds an item with the smallest delta in distance to the given latlng coords\n\t */\n\t_findItemForLatLng: function(latlng) {\n\t\tlet result = null;\n\t\tlet d = Infinity;\n\t\t_.each(this._data,\n\t\t\titem => {\n\t\t\t\tlet dist = latlng.distanceTo(item.latlng);\n\t\t\t\tif (dist < d) {\n\t\t\t\t\td = dist;\n\t\t\t\t\tresult = item;\n\t\t\t\t}\n\t\t\t});\n\t\treturn result;\n\t},\n\n\t/*\n\t * Finds a data entry for a given x-coordinate of the diagram\n\t */\n\t_findItemForX: function(x) {\n\t\treturn this._chart._findItemForX(x);\n\t},\n\n\t/**\n\t * Fires an event of the specified type.\n\t */\n\t_fireEvt: function(type, data, propagate) {\n\t\tif (this.fire) this.fire(type, data, propagate);\n\t\tif (this._map) this._map.fire(type, data, propagate);\n\t},\n\n\t/**\n\t * Calculates chart height.\n\t */\n\t_height: function() {\n\t\tlet opts = this.options;\n\t\treturn opts.height - opts.margins.top - opts.margins.bottom;\n\t},\n\n\t/*\n\t * Hides the position/height indicator marker drawn onto the map\n\t */\n\t_hidePositionMarker: function() {\n\t\tif (this.options.autohideMarker) {\n\t\t\tthis._marker.remove();\n\t\t}\n\t},\n\n\t/**\n\t * Generate \"svg\" chart DOM element.\n\t */\n\t_initChart: function() {\n\t\tlet opts = this.options;\n\t\topts.xTicks = opts.xTicks || Math.round(this._width() / 75);\n\t\topts.yTicks = opts.yTicks || Math.round(this._height() / 30);\n\n\t\tif (opts.responsive) {\n\t\t\tif (opts.detached) {\n\t\t\t\tlet offWi = this.eleDiv.offsetWidth;\n\t\t\t\tlet offHe = this.eleDiv.offsetHeight;\n\t\t\t\topts.width = offWi > 0 ? offWi : opts.width;\n\t\t\t\topts.height = (offHe - 20) > 0 ? offHe - 20 : opts.height; // 20 = horizontal scrollbar size.\n\t\t\t} else {\n\t\t\t\topts._maxWidth = opts._maxWidth > opts.width ? opts._maxWidth : opts.width;\n\t\t\t\tlet containerWidth = this._map._container.clientWidth;\n\t\t\t\topts.width = opts._maxWidth > containerWidth ? containerWidth - 30 : opts.width;\n\t\t\t}\n\t\t}\n\n\t\tlet chart = this._chart = new Chart(opts);\n\n\t\tlet container = d3.select(this._container)\n\t\t\t.call(this._chart.render())\n\t\t\t.call(this._appendSummary());\n\n\t\tthis._svg = chart._svg;\n\t\tthis._grid = chart._grid;\n\t\tthis._area = chart._area;\n\t\tthis._path = chart._path;\n\t\tthis._axis = chart._axis;\n\t\tthis._focus = chart._focus;\n\t\tthis._focusRect = chart._focusRect;\n\t\tthis._x = chart._x;\n\t\tthis._y = chart._y;\n\t\tthis._legend = chart._legend;\n\t\tthis._focuslabel = this._chart._focuslabel;\n\t\tthis._focusline = this._chart._focusline;\n\n\t\tchart.on('reset_drag', this._hidePositionMarker, this);\n\t\tchart.on('mouse_enter', this._fireEvt.bind('elechart_enter'), this);\n\t\tchart.on('dragged', this._fireEvt.bind(\"elechart_dragged\"), this);\n\t\tchart.on('mouse_move', this._mousemoveHandler, this);\n\t\tchart.on('mouse_out', this._mouseoutHandler, this);\n\t\t// chart.on('legend', this._fireEvt.bind('elechart_legend'), this);\n\n\t\tthis._fireEvt(\"elechart_init\");\n\t},\n\n\t_initMarker: function(container) {\n\t\tthis._marker = new Marker(this.options);\n\t},\n\n\t/**\n\t * Inspired by L.Control.Layers\n\t */\n\t_initToggle: function(container) {\n\t\t//Makes this work on IE10 Touch devices by stopping it from firing a mouseout event when the touch is released\n\t\tcontainer.setAttribute('aria-haspopup', true);\n\n\t\tif (!this.options.detached) {\n\t\t\tL.DomEvent\n\t\t\t\t.disableClickPropagation(container);\n\t\t\t//.disableScrollPropagation(container);\n\t\t}\n\n\t\tif (L.Browser.mobile) {\n\t\t\t_.on(container, 'click', L.DomEvent.stopPropagation);\n\t\t}\n\n\t\t_.on(container, 'mousewheel', this._mousewheelHandler, this);\n\n\t\tif (!this.options.detached) {\n\t\t\tlet link = this._button = _.create('a', \"elevation-toggle elevation-toggle-icon\" + (this.options.autohide ? \"\" : \" close-button\"), { href: '#', title: L._('Elevation') }, container);\n\n\t\t\tif (this.options.collapsed) {\n\t\t\t\tthis._collapse();\n\t\t\t\tif (this.options.autohide) {\n\t\t\t\t\t_.on(container, 'mouseover', this._expand, this);\n\t\t\t\t\t_.on(container, 'mouseout', this._collapse, this);\n\t\t\t\t} else {\n\t\t\t\t\t_.on(link, 'click', L.DomEvent.stop);\n\t\t\t\t\t_.on(link, 'click', this._toggle, this);\n\t\t\t\t}\n\n\t\t\t\t_.on(link, 'focus', this._toggle, this);\n\n\t\t\t\tthis._map.on('click', this._collapse, this);\n\t\t\t\t// TODO: keyboard accessibility\n\t\t\t}\n\t\t} else {\n\t\t\t// TODO: handle autohide when detached=true\n\t\t}\n\t},\n\n\t/*\n\t * Handles the moueseover the chart and displays distance and altitude level.\n\t */\n\t_mousemoveHandler: function(e) {\n\t\tif (!this._data || this._data.length === 0 || !this._chartEnabled) {\n\t\t\treturn;\n\t\t}\n\t\tlet xCoord = e.xCoord;\n\t\tlet item = this._data[this._findItemForX(xCoord)];\n\n\t\tthis._showPositionMarker(item);\n\t\tthis._setMapView(item);\n\n\t\tif (this._map) {\n\t\t\t_.addClass(this._map._container, 'elechart-hover');\n\t\t}\n\n\t\tthis._fireEvt(\"elechart_change\", { data: item, xCoord: xCoord });\n\t\tthis._fireEvt(\"elechart_hover\", { data: item, xCoord: xCoord });\n\t},\n\n\t/*\n\t * Handles mouseover events of the data layers on the map.\n\t */\n\t_mousemoveLayerHandler: function(e) {\n\t\tif (!this._data || this._data.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet item = this._findItemForLatLng(e.latlng);\n\t\tif (item) {\n\t\t\tlet xCoord = item.xDiagCoord;\n\n\t\t\tif (this._chartEnabled) this._chart._showDiagramIndicator(item, xCoord);\n\n\t\t\tthis._showPositionMarker(item);\n\n\t\t\tthis._fireEvt(\"elechart_change\", { data: item, xCoord: xCoord });\n\t\t}\n\t},\n\n\t/*\n\t * Handles the moueseout over the chart.\n\t */\n\t_mouseoutHandler: function() {\n\t\tif (!this.options.detached) {\n\t\t\tthis._hidePositionMarker();\n\t\t\tthis._chart._hideDiagramIndicator();\n\t\t}\n\n\t\tif (this._map) {\n\t\t\t_.removeClass(this._map._container, 'elechart-hover');\n\t\t}\n\n\t\tthis._fireEvt(\"elechart_leave\");\n\t},\n\n\t/*\n\t * Handles the mouesewheel over the chart.\n\t */\n\t_mousewheelHandler: function(e) {\n\t\tif (this._map.gestureHandling && this._map.gestureHandling._enabled) return;\n\t\tlet ll = this._marker.getLatLng() || this._map.getCenter();\n\t\tlet z = this._map.getZoom() + Math.sign(e.deltaY);\n\t\tthis._resetDrag();\n\t\tthis._map.flyTo(ll, z);\n\t},\n\n\t/*\n\t * Removes the drag rectangle and zoms back to the total extent of the data.\n\t */\n\t_resetDrag: function() {\n\t\tthis._chart._resetDrag();\n\t\tthis._hidePositionMarker();\n\t},\n\n\t/**\n\t * Resets drag, marker and bounds.\n\t */\n\t_resetView: function() {\n\t\tif (this._map && this._map._isFullscreen) return;\n\t\tthis._resetDrag();\n\t\tthis._hidePositionMarker();\n\t\tthis.fitBounds();\n\t},\n\n\t/**\n\t * Hacky way for handling chart resize. Deletes it and redraw chart.\n\t */\n\t_resizeChart: function() {\n\t\t// prevent displaying chart on resize if hidden\n\t\tif (_.style(this._container, \"display\") == \"none\") return;\n\n\t\tif (this.options.responsive) {\n\t\t\tif (this.options.detached) {\n\t\t\t\tlet newWidth = this.eleDiv.offsetWidth; // - 20;\n\t\t\t\tif (newWidth) {\n\t\t\t\t\tthis.options.width = newWidth;\n\t\t\t\t\tthis.eleDiv.innerHTML = \"\";\n\t\t\t\t\t_.append(this.eleDiv, this.onAdd(this._map));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis._map.removeControl(this._container);\n\t\t\t\tthis.addTo(this._map);\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * Collapse or Expand current chart control.\n\t */\n\t_toggle: function() {\n\t\tif (_.hasClass(this._container, \"elevation-expanded\"))\n\t\t\tthis._collapse();\n\t\telse\n\t\t\tthis._expand();\n\t},\n\n\t/**\n\t * Sets the view of the map (center and zoom). Useful when \"followMarker\" is true.\n\t */\n\t_setMapView: function(item) {\n\t\tif (!this.options.followMarker || !this._map) return;\n\t\tlet zoom = this._map.getZoom();\n\t\tzoom = zoom < this._zFollow ? this._zFollow : zoom;\n\t\tthis._map.setView(item.latlng, zoom, { animate: true, duration: 0.25 });\n\t},\n\n\t/*\n\t * Shows the position/height indicator marker drawn onto the map\n\t */\n\t_showPositionMarker: function(item) {\n\t\tif (this.options.marker) {\n\t\t\tthis._marker.update({ item: item, map: this._map, maxElevation: this._maxElevation, options: this.options });\n\t\t\tthis._mouseHeightFocusLabel = this._marker._mouseHeightFocusLabel;\n\t\t}\n\t},\n\n\t/**\n\t * Calculates [x, y] domain and then update chart.\n\t */\n\t_updateChart: function() {\n\t\tif (!this._data || !this._container) return;\n\n\t\tthis._chart = this._chart.update({ data: this._data });\n\n\t\tthis._x = this._chart._x;\n\t\tthis._y = this._chart._y;\n\n\t\tthis._fireEvt(\"elechart_axis\");\n\t\tif (this.options.legend) this._fireEvt(\"elechart_legend\");\n\n\t\tthis._fireEvt('elechart_updated');\n\t},\n\n\t/**\n\t * Update chart summary.\n\t */\n\t_updateSummary: function() {\n\t\tthis.summaryDiv.innerHTML = '';\n\t\tthis.track_info = this.track_info || {};\n\t\tthis.track_info.distance = this._distance || 0;\n\t\tthis.track_info.elevation_max = this._maxElevation || 0;\n\t\tthis.track_info.elevation_min = this._minElevation || 0;\n\n\t\tif (this.options.summary) {\n\t\t\tthis._fireEvt(\"elechart_summary\");\n\t\t}\n\t\tif (this.options.downloadLink && this._downloadURL) { // TODO: generate dynamically file content instead of using static file urls.\n\t\t\tthis.summaryDiv.innerHTML += '<span class=\"download\"><a href=\"#\">' + L._('Download') + '</a></span>'\n\t\t\t_.select('.download a', this.summaryDiv).onclick = (e) => {\n\t\t\t\te.preventDefault();\n\t\t\t\tthis._fireEvt('eletrack_download', { downloadLink: this.options.downloadLink, confirm: _.saveFile.bind(this, this._downloadURL) });\n\t\t\t};\n\t\t};\n\t},\n\n\n\t/**\n\t * Calculates chart width.\n\t */\n\t_width: function() {\n\t\tlet opts = this.options;\n\t\treturn opts.width - opts.margins.left - opts.margins.right;\n\t},\n\n});\n\n/**\n * Attach here some useful elevation hooks.\n */\nElevation.addInitHook(function() {\n\n\tthis.on('waypoint_added', function(e) {\n\t\tlet p = e.point,\n\t\t\tpop = p._popup;\n\t\tif (pop) {\n\t\t\tpop.options.className = 'elevation-popup';\n\t\t}\n\t\tif (pop._content) {\n\t\t\tpop._content = decodeURI(pop._content);\n\t\t\tp.bindTooltip(pop._content, { direction: 'top', sticky: true, opacity: 1, className: 'elevation-tooltip' }).openTooltip();\n\t\t}\n\t});\n\n\tthis.on('elepath_toggle', function(e) {\n\t\tlet path = e.path;\n\n\t\tlet enabled = _.hasClass(path, 'hidden');\n\t\tlet text = _.select('text', e.legend);\n\n\t\tif (enabled) {\n\t\t\t_.removeClass(path, 'hidden');\n\t\t\t_.style(text, \"text-decoration-line\", \"\")\n\t\t} else {\n\t\t\t_.addClass(path, 'hidden');\n\t\t\t_.style(text, \"text-decoration-line\", \"line-through\")\n\t\t}\n\n\t\tthis._chartEnabled = this._area.selectAll('path:not(.hidden)').nodes().length != 0;\n\n\t\t// autotoggle chart data on single click\n\t\tif (!this._chartEnabled) {;\n\t\t\tthis._resetDrag();\n\t\t\tthis._clearPath();\n\t\t} else {\n\t\t\t// this._resizeChart();\n\t\t\t_.each(this._layers, l => _.addClass(l._path, this.options.polyline.className + ' ' + this.options.theme));\n\t\t}\n\t});\n\n\tthis.on(\"elechart_dragged\", function(e) {\n\t\tthis._hidePositionMarker();\n\t\tthis.fitBounds(L.latLngBounds([e.dragstart.latlng, e.dragend.latlng]));\n\t});\n\n\tthis.on(\"elechart_legend\", function() {\n\t\tthis._altitudeLegend = this._legend.append('g')\n\t\t\t.call(\n\t\t\t\tD3.LegendItem({\n\t\t\t\t\tname: 'Altitude',\n\t\t\t\t\twidth: this._width(),\n\t\t\t\t\theight: this._height(),\n\t\t\t\t\tmargins: this.options.margins,\n\t\t\t\t})\n\t\t\t);\n\t});\n\n\tthis.on(\"elechart_updated\", function() {\n\t\t// TODO: maybe should i listen for this inside chart.js?\n\t\tthis._legend.selectAll('.legend-item')\n\t\t\t.on('click', (d, i, n) => {\n\t\t\t\tlet target = n[i];\n\t\t\t\tlet name = target.getAttribute('data-name');\n\t\t\t\tlet path = this._area.select('path[data-name=\"' + name + '\"]').node();\n\t\t\t\tthis._fireEvt(\"elepath_toggle\", { path: path, name: name, legend: target });\n\t\t\t});\n\t});\n\n\n\tthis.on(\"elechart_summary\", function() {\n\t\tthis.summaryDiv.innerHTML +=\n\t\t\t'<span class=\"totlen\"><span class=\"summarylabel\">' + L._(\"Total Length: \") + '</span><span class=\"summaryvalue\">' + this.track_info.distance.toFixed(2) + '&nbsp;' + this._xLabel + '</span></span>' +\n\t\t\t'<span class=\"maxele\"><span class=\"summarylabel\">' + L._(\"Max Elevation: \") + '</span><span class=\"summaryvalue\">' + this.track_info.elevation_max.toFixed(2) + '&nbsp;' + this._yLabel + '</span></span>' +\n\t\t\t'<span class=\"minele\"><span class=\"summarylabel\">' + L._(\"Min Elevation: \") + '</span><span class=\"summaryvalue\">' + this.track_info.elevation_min.toFixed(2) + '&nbsp;' + this._yLabel + '</span></span>';\n\t});\n\n\tthis.on(\"eletrack_download\", function(e) {\n\t\tif (e.downloadLink == 'modal' && typeof CustomEvent === \"function\") {\n\t\t\tdocument.dispatchEvent(new CustomEvent(\"eletrack_download\", { detail: e }));\n\t\t} else if (e.downloadLink == 'link' || e.downloadLink === true) {\n\t\t\te.confirm();\n\t\t}\n\t});\n\n\tthis.on('eledata_loaded', function(e) {\n\t\tlet layer = e.layer;\n\t\tif (this._map) {\n\t\t\tthis._map.once('layeradd', function(e) {\n\t\t\t\tthis.fitBounds(layer.getBounds());\n\t\t\t}, this);\n\t\t\tlayer.addTo(this._map);\n\t\t} else {\n\t\t\tconsole.warn(\"Undefined elevation map object\");\n\t\t}\n\t});\n\n\tthis.on('eledata_clear', function() {\n\t\tthis._area.selectAll('path')\n\t\t\t.attr(\"d\", \"M0 0\");\n\t\tif (this._path) {\n\t\t\t// this._x.domain([0, 1]);\n\t\t\t// this._y.domain([0, 1]);\n\t\t\t// this._updateAxis();\n\t\t}\n\t});\n});\n","import 'leaflet-i18n';\nimport * as _ from './utils';\nimport * as D3 from './components';\nimport { Elevation } from './control';\n\nElevation.addInitHook(function() {\n\n\tif (!this.options.slope) return;\n\n\tlet opts = this.options;\n\tlet slope = {};\n\topts.margins.right = 50;\n\n\tif (this.options.slope != \"summary\") {\n\n\t\tthis.on(\"elechart_init\", function() {\n\t\t\tslope.path = this._area.append('path')\n\t\t\t\t.style(\"pointer-events\", \"none\")\n\t\t\t\t// TODO: add a class here.\n\t\t\t\t.attr(\"fill\", \"#F00\")\n\t\t\t\t.attr(\"stroke\", \"#000\")\n\t\t\t\t.attr(\"stroke-opacity\", \"0.5\")\n\t\t\t\t.attr(\"fill-opacity\", \"0.25\");\n\t\t});\n\n\t\tthis.on(\"elechart_axis\", function() {\n\t\t\tslope.x = this._x;\n\n\t\t\t// slope.x = D3.Scale({\n\t\t\t// \tdata: this._data,\n\t\t\t// \trange: [0, this._width()],\n\t\t\t// \tattr: opts.xAttr,\n\t\t\t// \tmin: opts.xAxisMin,\n\t\t\t// \tmax: opts.xAxisMax,\n\t\t\t// \tforceBounds: opts.forceAxisBounds,\n\t\t\t// });\n\n\t\t\tslope.y = D3.Scale({\n\t\t\t\tdata: this._data,\n\t\t\t\trange: [this._height(), 0],\n\t\t\t\tattr: \"slope\",\n\t\t\t\tmin: -1,\n\t\t\t\tmax: +1,\n\t\t\t\tforceBounds: opts.forceAxisBounds,\n\t\t\t});\n\n\t\t\tslope.axis = D3.Axis({\n\t\t\t\taxis: \"y\",\n\t\t\t\tposition: \"right\",\n\t\t\t\twidth: this._width(),\n\t\t\t\theight: this._height(),\n\t\t\t\tscale: slope.y,\n\t\t\t\tticks: this.options.yTicks,\n\t\t\t\ttickPadding: 16,\n\t\t\t\tlabel: \"%\",\n\t\t\t\tlabelX: 25,\n\t\t\t\tlabelY: 3,\n\t\t\t});\n\n\t\t\tthis._axis.call(slope.axis);\n\t\t});\n\n\t\tthis.on(\"elechart_updated\", function() {\n\t\t\tslope.area = D3.Area({\n\t\t\t\tinterpolation: \"curveStepAfter\",\n\t\t\t\tdata: this._data,\n\t\t\t\tname: 'Slope',\n\t\t\t\txAttr: opts.xAttr,\n\t\t\t\tyAttr: \"slope\",\n\t\t\t\twidth: this._width(),\n\t\t\t\theight: this._height(),\n\t\t\t\tscaleX: slope.x,\n\t\t\t\tscaleY: slope.y,\n\t\t\t});\n\n\t\t\tslope.path.call(slope.area);\n\t\t});\n\n\t\tthis.on(\"elechart_legend\", function() {\n\t\t\tslope.legend = this._legend.append(\"g\")\n\t\t\t\t.call(\n\t\t\t\t\tD3.LegendItem({\n\t\t\t\t\t\tname: 'Slope',\n\t\t\t\t\t\twidth: this._width(),\n\t\t\t\t\t\theight: this._height(),\n\t\t\t\t\t\tmargins: this.options.margins,\n\t\t\t\t\t})\n\t\t\t\t);\n\n\t\t\tthis._altitudeLegend\n\t\t\t\t.attr(\"transform\", \"translate(-50, 0)\");\n\n\t\t\tslope.legend\n\t\t\t\t.attr(\"transform\", \"translate(50, 0)\");\n\n\t\t\tslope.legend.select(\"rect\")\n\t\t\t\t.classed(\"area\", false)\n\t\t\t\t// TODO: add a class here.\n\t\t\t\t.attr(\"fill\", \"#F00\")\n\t\t\t\t.attr(\"stroke\", \"#000\")\n\t\t\t\t.attr(\"stroke-opacity\", \"0.5\")\n\t\t\t\t.attr(\"fill-opacity\", \"0.25\");\n\n\t\t});\n\t}\n\n\tthis.on(\"eledata_updated\", function(e) {\n\t\tlet data = this._data;\n\t\tlet i = e.index;\n\t\tlet z = data[i].z;\n\n\t\tlet curr = data[i].latlng;\n\t\tlet prev = i > 0 ? data[i - 1].latlng : curr;\n\n\t\tlet delta = curr.distanceTo(prev) * this._distanceFactor;\n\n\t\t// Slope / Gain\n\t\tlet tAsc = this._tAsc || 0; // Total Ascent\n\t\tlet tDes = this._tDes || 0; // Total Descent\n\t\tlet sMax = this._sMax || 0; // Slope Max\n\t\tlet sMin = this._sMin || 0; // Slope Min\n\t\tlet diff = 0;\n\t\tlet slope = 0;\n\n\t\tif (!isNaN(z)) {\n\t\t\t// diff height between actual and previous point\n\t\t\tdiff = i > 0 ? z - data[i - 1].z : 0;\n\t\t\tif (diff > 0) tAsc += diff;\n\t\t\tif (diff < 0) tDes -= diff;\n\t\t\t// slope in % = ( height / length ) * 100\n\t\t\tslope = delta !== 0 ? Math.round((diff / delta) * 10000) / 100 : 0;\n\t\t\t// apply slope to the previous point because we will\n\t\t\t// ascent or desent, so the slope is in the fist point\n\t\t\tif (i > 0) data[i - 1].slope = slope;\n\t\t\tsMax = slope > sMax ? slope : sMax;\n\t\t\tsMin = slope < sMin ? slope : sMin;\n\t\t}\n\n\t\tdata[i].slope = slope;\n\n\t\tthis.track_info = this.track_info || {};\n\t\tthis.track_info.ascent = this._tAsc = tAsc;\n\t\tthis.track_info.descent = this._tDes = tDes;\n\t\tthis.track_info.slope_max = this._sMax = sMax;\n\t\tthis.track_info.slope_min = this._sMin = sMin;\n\t});\n\n\tthis.on(\"elechart_change\", function(e) {\n\t\tlet item = e.data;\n\t\tlet xCoordinate = e.xCoord;\n\n\t\tif (this._focuslabel) {\n\t\t\tif (!this._focuslabelSlope || !this._focuslabelSlope.property('isConnected')) {\n\t\t\t\tthis._focuslabelSlope = this._focuslabel.select('text').insert(\"svg:tspan\", \".mouse-focus-label-x\")\n\t\t\t\t\t.attr(\"class\", \"mouse-focus-label-slope\")\n\t\t\t\t\t.attr(\"dy\", \"1.5em\");\n\t\t\t}\n\n\t\t\tthis._focuslabelSlope.text(item.slope + \"%\");\n\n\t\t\tthis._focuslabel.select('.mouse-focus-label-x')\n\t\t\t\t.attr(\"dy\", \"1.5em\");\n\t\t}\n\n\t\tif (this._mouseHeightFocusLabel) {\n\t\t\tif (!this._mouseSlopeFocusLabel) {\n\t\t\t\tthis._mouseSlopeFocusLabel = this._mouseHeightFocusLabel.append(\"svg:tspan\")\n\t\t\t\t\t.attr(\"class\", \"height-focus-slope \");\n\t\t\t}\n\n\t\t\tthis._mouseSlopeFocusLabel\n\t\t\t\t.attr(\"dy\", \"1.5em\")\n\t\t\t\t.text(Math.round(item.slope) + \"%\");\n\n\t\t\tthis._mouseHeightFocusLabel.select('.height-focus-y')\n\t\t\t\t.attr(\"dy\", \"-1.5em\");\n\t\t}\n\t});\n\n\tthis.on(\"elechart_summary\", function() {\n\t\tthis.track_info.ascent = this._tAsc || 0;\n\t\tthis.track_info.descent = this._tDes || 0;\n\t\tthis.track_info.slope_max = this._sMax || 0;\n\t\tthis.track_info.slope_min = this._sMin || 0;\n\n\t\tthis.summaryDiv.querySelector('.minele').insertAdjacentHTML('afterend', '<span class=\"ascent\"><span class=\"summarylabel\">' + L._(\"Total Ascent: \") + '</span><span class=\"summaryvalue\">' + Math.round(this.track_info.ascent) + '&nbsp;' +\n\t\t\tthis._yLabel +\n\t\t\t'</span></span>' + '<span class=\"descent\"><span class=\"summarylabel\">' + L._(\"Total Descent: \") + '</span><span class=\"summaryvalue\">' + Math.round(this.track_info.descent) + '&nbsp;' + this._yLabel +\n\t\t\t'</span></span>' + '<span class=\"minslope\"><span class=\"summarylabel\">' + L._(\"Min Slope: \") + '</span><span class=\"summaryvalue\">' + this.track_info.slope_min + '&nbsp;' + '%' +\n\t\t\t'</span></span>' + '<span class=\"maxslope\"><span class=\"summarylabel\">' + L._(\"Max Slope: \") + '</span><span class=\"summaryvalue\">' + this.track_info.slope_max + '&nbsp;' + '%' +\n\t\t\t'</span></span>');\n\t});\n\n\tthis.on(\"eledata_clear\", function() {\n\t\tthis._sMax = null;\n\t\tthis._sMin = null;\n\t\tthis._tAsc = null;\n\t\tthis._tDes = null;\n\t});\n\n});\n","/*\n * Copyright (c) 2019, GPL-3.0+ Project, Raruto\n *\n *  This file is free software: you may copy, redistribute and/or modify it\n *  under the terms of the GNU General Public License as published by the\n *  Free Software Foundation, either version 2 of the License, or (at your\n *  option) any later version.\n *\n *  This file is distributed in the hope that it will be useful, but\n *  WITHOUT ANY WARRANTY; without even the implied warranty of\n *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n *  General Public License for more details.\n *\n *  You should have received a copy of the GNU General Public License\n *  along with this program.  If not, see .\n *\n * This file incorporates work covered by the following copyright and\n * permission notice:\n *\n *     Copyright (c) 2013-2016, MIT License, Felix “MrMufflon” Bache\n *\n *     Permission to use, copy, modify, and/or distribute this software\n *     for any purpose with or without fee is hereby granted, provided\n *     that the above copyright notice and this permission notice appear\n *     in all copies.\n *\n *     THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL\n *     WARRANTIES WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED\n *     WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE\n *     AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR\n *     CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS\n *     OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT,\n *     NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN\n *     CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.\n */\n\nimport 'leaflet-i18n';\nimport * as _ from './utils';\nimport * as D3 from './components';\nimport { Chart } from './chart';\nimport { Elevation } from './control';\nimport './slope';\n\nElevation.Utils = _;\nElevation.Components = D3;\nElevation.Chart = Chart;\n\nL.control.elevation = (options) => new Elevation(options);\n"],"names":["deepMerge","target","sources","length","source","shift","isObject","key","Object","assign","deferFunc","f","document","readyState","window","addEventListener","once","formatter","num","dec","sep","res","L","Util","formatNum","toString","numbers","split","d","join","GeoJSONLoader","data","control","JSON","parse","this","layer","geoJson","style","feature","extend","options","polyline","theme","className","pointToLayer","latlng","marker","icon","gpxOptions","marker_options","wptIcons","desc","properties","name","bindPopup","openPopup","fire","point","point_type","element","onEachFeature","geometry","type","addData","track_info","_fireEvt","GPXLoader","polyline_options","GPX","on","e","line","get_name","item","_typeof","Array","isArray","isVisible","elem","styles","getComputedStyle","visibility","display","isVisibleByStyles","boundingRect","getBoundingClientRect","left","right","top","above","bottom","pointerEvents","elementFromPoint","isAboveOtherElements","isJSONDoc","doc","lazy","trim","indexOf","console","warn","isXMLDoc","documentElement","ownerDocument","nodeName","lazyLoader","url","skip","loader","Promise","resolve","reject","tag","createElement","src","head","appendChild","loadFile","success","xhr","XMLHttpRequest","responseType","open","onload","response","onerror","status","send","saveFile","dataURI","fileName","a","create","href","download","b","body","click","removeChild","waitHolder","ticking","scrollFn","requestAnimFrame","removeEventListener","addClass","targetNode","each","s","DomUtil","removeClass","value","getStyle","setProperty","tagName","attributes","parent","setAttributes","append","child","insert","position","insertAdjacentElement","attrs","k","setAttribute","select","selector","context","querySelector","factory","define","amd","exports","module","require","locales","locale","registerLocale","code","setLocale","i18n","_","string","template","err","DomEvent","off","hasClass","randomId","Math","random","substr","obj","fn","i","offsetWidth","offsetHeight","getClientRects","Area","xAttr","yAttr","scaleX","scaleY","height","interpolation","path","d3","area","curve","x","xDiagCoord","y0","y1","datum","attr","Axis","tickSize","tickPadding","width","axis","scale","ticks","tickFormat","label","labelX","labelY","g","w","h","axisScale","replace","l","toUpperCase","axisGroup","call","text","DragRectangle","dragStartCoords","dragEndCoords","rect","x1","min","x2","max","FocusRect","Grid","props","HeightFocusLine","xCoord","yCoord","HeightFocusLabel","y","node","selectAll","HeightFocusPoint","circle","LegendItem","margins","toLowerCase","MouseFocusLine","MouseFocusLabel","xAlign","yAlign","bbox","getBBox","Browser","webkit","Infinity","Scale","forceBounds","range","domain","extent","scaleLinear","bisector","invert","Chart","Class","includes","Evented","prototype","Mixin","Events","initialize","opts","_data","_draggingEnabled","dragging","imperial","_xLabel","_yLabel","xLabel","yLabel","_xTicks","xTicks","_yTicks","yTicks","_updateScale","svg","_svg","_appendGrid","_appendAxis","_appendAreaPath","_appendFocusable","_appendLegend","_grid","_area","_path","_axis","_focus","_focusRect","_legend","_x","_y","update","_updateAxis","_updateAreaPath","render","container","_this","D3","_width","xAxisMin","xAxisMax","forceAxisBounds","_height","yAxisMin","yAxisMax","remove","_appendXGrid","_appendYGrid","_appendXaxis","_appendYaxis","_this2","_this3","_this4","_appendFocusRect","_appendMouseFocusG","focusRect","_this5","mobile","_dragStartHandler","bind","_dragHandler","_mousemoveHandler","_dragEndHandler","_mouseenterHandler","_mouseoutHandler","focusG","_this6","_focusG","_focusline","_focuslabel","event","preventDefault","stopPropagation","_gotDragged","_drawDragRectangle","_dragStartCoords","mouse","_dragRectangle","_dragCurrentCoords","_resetDrag","start","_findItemForX","end","dragstart","dragend","ctx","_this7","_hideDiagramIndicator","_showDiagramIndicator","xCoordinate","classed","hoverNumber","decimalsX","decimalsY","fx","fy","yCoordinate","addInitHook","Marker","_heightG","_mouseHeightFocus","_pointG","_mouseHeightFocusLabel","_marker","markerIcon","zIndexOffset","interactive","addTo","map","pane","renderer","_map","getPane","_pane","createPane","zIndex","_latlng","latLngToLayerPoint","normalizedAlt","maxElevation","z","normalizedY","getElement","setLatLng","getLatLng","Options","autohide","autohideMarker","collapsed","detached","distanceFactor","downloadLink","elevationDiv","followMarker","async","startIconUrl","endIconUrl","shadowUrl","divIcon","html","iconSize","iconAnchor","heightFactor","lazyLoadJS","legend","loadData","defer","placeholder","color","opacity","weight","lineCap","reverseCoords","skipNullZCoords","responsive","summary","slope","undefined","zFollow","Elevation","Control","__mileFactor","__footFactor","__D3","__LGPX","_d3LazyLoader","then","_addData","_addLayer","eleDiv","_initElevationDiv","isConnected","_container","onAdd","clear","_clearPath","_clearChart","_clearData","disableDragging","_chart","enableDragging","fitBounds","bounds","getBounds","isValid","latLngBounds","getZFollow","_zFollow","hide","_distanceFactor","_heightFactor","_chartEnabled","_setMapView","throttle","load","loadChart","loadDefer","loadLazy","loadGPX","loadGeoJSON","_downloadURL","catch","_gpxLazyLoader","parentNode","alt","_initToggle","_initChart","_initMarker","_hidePositionMarker","_resetView","_resizeChart","_updateChart","_updateSummary","onRemove","redraw","setZFollow","zoom","show","geom","feat","gpx","_latlngs","_addGeoJSONData","coordinates","coords","features","_addGPXData","_addPoint","_this8","lat","lng","meta","ele","eleMax","_maxElevation","eleMin","_minElevation","dist","_distance","curr","LatLng","prev","delta","distanceTo","round","prevZ","isNaN","lastZ","_lastValidZ","currZ","splice","push","distance","elevation_max","elevation_min","index","_mousemoveLayerHandler","_layers","stamp","id","_appendSummary","_this9","summaryDiv","_this10","_collapse","_expand","_findItemForLatLng","result","propagate","offWi","offHe","_maxWidth","containerWidth","clientWidth","chart","disableClickPropagation","_mousewheelHandler","link","_button","title","stop","_toggle","_showPositionMarker","gestureHandling","_enabled","ll","getCenter","getZoom","sign","deltaY","flyTo","_isFullscreen","newWidth","innerHTML","removeControl","setView","animate","duration","onclick","_this11","confirm","p","pop","_popup","_content","decodeURI","bindTooltip","direction","sticky","openTooltip","enabled","nodes","_this12","_altitudeLegend","n","getAttribute","_this13","toFixed","CustomEvent","dispatchEvent","detail","tAsc","_tAsc","tDes","_tDes","sMax","_sMax","sMin","_sMin","diff","ascent","descent","slope_max","slope_min","_focuslabelSlope","property","_mouseSlopeFocusLabel","insertAdjacentHTML","Utils","Components","elevation"],"mappings":"wbAIO,SAASA,EAAUC,8BAAWC,mCAAAA,wBAC/BA,EAAQC,OAAQ,OAAOF,MACtBG,EAASF,EAAQG,WACnBC,EAASL,IAAWK,EAASF,OAC3B,IAAMG,KAAOH,EACbE,EAASF,EAAOG,KACdN,EAAOM,IAAMC,OAAOC,OAAOR,OAC9BM,EAAM,KAERP,EAAUC,EAAOM,GAAMH,EAAOG,KAE9BC,OAAOC,OAAOR,OACZM,EAAMH,EAAOG,YAKXP,gBAAUC,UAAWC,IAMtB,SAASQ,EAAUC,GACG,aAAxBC,SAASC,WAA2BC,OAAOC,iBAAiB,OAAQJ,EAAG,CAAEK,MAAM,IAC9EL,IAMC,SAASM,EAAUC,EAAKC,EAAKC,OAC/BC,EAAMC,EAAEC,KAAKC,UAAUN,EAAKC,GAAKM,WACjCC,EAAUL,EAAIM,MAAM,QACpBD,EAAQ,GAAI,KACV,IAAIE,EAAIT,EAAMO,EAAQ,GAAGvB,OAAQyB,EAAI,EAAGA,IAC5CF,EAAQ,IAAM,IAEfL,EAAMK,EAAQG,KAAKT,GAAO,YAEpBC,EAMD,SAASS,EAAcC,EAAMC,GACf,iBAATD,IACVA,EAAOE,KAAKC,MAAMH,IAEnBC,EAAUA,GAAWG,SAEjBC,EAAQd,EAAEe,QAAQN,EAAM,CAC3BO,MAAO,SAACC,OACHD,EAAQhB,EAAEkB,OAAO,GAAIR,EAAQS,QAAQC,iBACrCV,EAAQS,QAAQE,QACnBL,EAAMM,WAAa,IAAMZ,EAAQS,QAAQE,OAEnCL,GAERO,aAAc,SAACN,EAASO,OACnBC,EAASzB,EAAEyB,OAAOD,EAAQ,CAAEE,KAAMhB,EAAQS,QAAQQ,WAAWC,eAAeC,SAAS,MACrFC,EAAOb,EAAQc,WAAWD,KAAOb,EAAQc,WAAWD,KAAO,GAC3DE,EAAOf,EAAQc,WAAWC,KAAOf,EAAQc,WAAWC,KAAO,UAC3DA,GAAQF,IACXL,EAAOQ,UAAU,MAAQD,EAAO,QAAUF,EAAKjD,OAAS,EAAI,OAASiD,EAAO,KAAKI,YAElFxB,EAAQyB,KAAK,iBAAkB,CAAEC,MAAOX,EAAQY,WAAY,WAAYC,QAASd,IAC1EC,GAERc,cAAe,SAACtB,EAASH,GACK,SAAzBG,EAAQuB,SAASC,OAErB/B,EAAQgC,QAAQzB,EAASH,GAEzBJ,EAAQiC,WAAa3C,EAAEkB,OAAO,GAAIR,EAAQiC,WAAY,CAAEF,KAAM,UAAWT,KAAMvB,EAAKuB,kBAItFtB,EAAQkC,SAAS,iBAAkB,CAAEnC,KAAMA,EAAMK,MAAOA,EAAOkB,KAAMtB,EAAQiC,WAAWX,KAAMW,WAAYjC,EAAQiC,aAAc,GAEzH7B,EAMD,SAAS+B,EAAUpC,EAAMC,IAC/BA,EAAUA,GAAWG,MAEbM,QAAQQ,WAAWmB,iBAAmB9C,EAAEkB,OAAO,GAAIR,EAAQS,QAAQC,SAAUV,EAAQS,QAAQQ,WAAWmB,kBAE5GpC,EAAQS,QAAQE,QACnBX,EAAQS,QAAQQ,WAAWmB,iBAAiBxB,WAAa,IAAMZ,EAAQS,QAAQE,WAG5EP,EAAQ,IAAId,EAAE+C,IAAItC,EAAMC,EAAQS,QAAQQ,mBAG5Cb,EAAMkC,GAAG,YAAY,SAACC,GACrBvC,EAAQyB,KAAK,iBAAkBc,GAAG,MAInCnC,EAAMpB,KAAK,WAAW,SAACuD,GACtBvC,EAAQgC,QAAQO,EAAEC,MAClBxC,EAAQiC,WAAa3C,EAAEkB,OAAO,GAAIR,EAAQiC,WAAY,CAAEF,KAAM,MAAOT,KAAMlB,EAAMqC,gBAIlFrC,EAAMpB,KAAK,UAAU,SAACuD,GACrBvC,EAAQkC,SAAS,iBAAkB,CAAEnC,KAAMA,EAAMK,MAAOA,EAAOkB,KAAMtB,EAAQiC,WAAWX,KAAMW,WAAYjC,EAAQiC,aAAc,MAG1H7B,EAaD,SAAS9B,EAASoE,UAChBA,GAAwB,WAAhBC,EAAOD,KAAsBE,MAAMC,QAAQH,GAMrD,SAASI,EAAUC,OACpBA,EAAM,OAAO,MAEdC,EAASlE,OAAOmE,iBAAiBF,oBAEVA,EAAMC,SACH,WAAtBA,EAAOE,YAA8C,SAAnBF,EAAOG,QA2B5CC,CAAkBL,EAAMC,eAxBCD,EAAMC,OAC/BK,EAAeN,EAAKO,wBACpBC,EAAOF,EAAaE,KAAO,EAC3BC,EAAQH,EAAaG,MAAQ,EAC7BC,EAAMJ,EAAaI,IAAM,EAEzBC,GADSL,EAAaM,QACd,GAERC,EAAgBb,EAAKzC,MAAMsD,oBAEC,QAA5BZ,EAAO,oBAA6BD,EAAKzC,MAAMsD,cAAgB,QAE/DhF,SAASiF,iBAAiBN,EAAME,KAASV,IAAMW,GAAQ,GACvD9E,SAASiF,iBAAiBL,EAAOC,KAASV,IAAMW,GAAQ,GAM5DX,EAAKzC,MAAMsD,cAAgBA,EAEpBF,EAIHI,CAAqBf,EAAMC,GAO1B,SAASe,EAAUC,EAAKC,MAC9BA,OAAuB,IAATA,GAA8BA,EACzB,iBAARD,GAAoBC,SAEH,IAD3BD,EAAMA,EAAIE,QACCC,QAAQ,MAAiC,GAApBH,EAAIG,QAAQ,SAG3ClE,KAAKC,MAAM8D,EAAIvE,YACd,MAAO8C,WACW,WAAfI,EAAOqB,KAAoBC,KAC/BG,QAAQC,KAAK9B,IACN,UAED,EAOF,SAAS+B,EAASN,EAAKC,MAC7BA,OAAuB,IAATA,GAA8BA,EACzB,iBAARD,GAAoBC,SAEH,IAD3BD,EAAMA,EAAIE,QACCC,QAAQ,SAEfI,GAAmBP,EAAMA,EAAIQ,eAAiBR,EAAM,GAAGO,wBACpDA,GAA+C,SAA7BA,EAAgBE,SAOpC,SAASC,EAAWC,EAAKC,EAAMC,UACxB,IAATD,EACIE,QAAQC,UAEZF,aAAkBC,QACdD,EAED,IAAIC,SAAQ,SAACC,EAASC,OACxBC,EAAMrG,SAASsG,cAAc,UACjCD,EAAIlG,iBAAiB,OAAQgG,EAAS,CAAE/F,MAAM,IAC9CiG,EAAIE,IAAMR,EACV/F,SAASwG,KAAKC,YAAYJ,MAOrB,SAASK,EAASX,EAAKY,UACtB,IAAIT,SAAQ,SAACC,EAASC,OACxBQ,EAAM,IAAIC,eACdD,EAAIE,aAAe,OACnBF,EAAIG,KAAK,MAAOhB,GAChBa,EAAII,OAAS,kBAAMb,EAAQS,EAAIK,WAC/BL,EAAIM,QAAU,kBAAMd,EAAO,SAAWQ,EAAIO,OAAS,gCAAkCpB,IACrFa,EAAIQ,UAOC,SAASC,EAASC,EAASC,OAC7BC,EAAIC,EAAO,IAAK,GAAI,CAAEC,KAAMJ,EAASjI,OAAQ,OAAQsI,SAAUJ,GAAY,GAAI7F,MAAO,kBACtFkG,EAAI5H,SAAS6H,KACjBD,EAAEnB,YAAYe,GACdA,EAAEM,QACFF,EAAEG,YAAYP,GAMR,SAASQ,EAAW7D,UACnB,IAAI+B,SAAQ,SAACC,EAASC,OACxB6B,GAAU,EACVC,EAAW,SAAXA,IACED,IACJvH,EAAEC,KAAKwH,kBAAiB,WACnBjE,EAAUC,KACbjE,OAAOkI,oBAAoB,SAAUF,GACrC/B,KAED8B,GAAU,KAEXA,GAAU,IAGZ/H,OAAOC,iBAAiB,SAAU+H,GAC9B/D,GAAMA,EAAKhE,iBAAiB,aAAc+H,EAAU,CAAE9H,MAAM,IAChE8H,OAOK,SAASG,EAASC,EAAYtG,GACpCuG,EAAKvG,EAAUjB,MAAM,MAAM,SAAAyH,GAAWF,GAActG,GAAWtB,EAAE+H,QAAQJ,SAASC,EAAYE,MAMxF,SAASE,EAAYJ,EAAYtG,GACvCuG,EAAKvG,EAAUjB,MAAM,MAAM,SAAAyH,GAAWF,GAActG,GAAWtB,EAAE+H,QAAQC,YAAYJ,EAAYE,MAG3F,SAAS9G,EAAM4G,EAAY5F,EAAMiG,eAClB,IAAVA,EAA8BjI,EAAE+H,QAAQG,SAASN,EAAY5F,GAC5D4F,EAAW5G,MAAMmH,YAAYnG,EAAMiG,GAMzC,SAASlB,EAAOqB,EAAS9G,EAAW+G,EAAYC,OAClD7E,EAAOzD,EAAE+H,QAAQhB,OAAOqB,EAAS9G,GAAa,WAC9C+G,GAAYE,EAAc9E,EAAM4E,GAChCC,GAAQE,EAAOF,EAAQ7E,GACpBA,EAMD,SAAS+E,EAAOF,EAAQG,UACvBH,EAAOvC,YAAY0C,GAMpB,SAASC,EAAOJ,EAAQG,EAAOE,UAC9BL,EAAOM,sBAAsBD,EAAUF,GAMxC,SAASF,EAAc9E,EAAMoF,OAC9B,IAAIC,KAAKD,EAASpF,EAAKsF,aAAaD,EAAGD,EAAMC,IAM5C,SAASE,EAAOC,EAAUC,UACxBA,GAAW5J,UAAU6J,cAAcF,IC1U3C,SAAUG,EAAS5J,GAGM,mBAAX6J,QAAyBA,OAAOC,IACvCD,OAAO,CAAC,WAAYD,GAGM,iBAAZG,UACdC,OAAOD,QAAUH,EAAQK,QAAQ,kBAIf,IAAXjK,GAA0BA,EAAOQ,GACxCoJ,EAAQ5J,EAAOQ,GAbtB,EAgBC,SAAUA,UACRA,EAAE0J,QAAU,GACZ1J,EAAE2J,OAAS,KACX3J,EAAE4J,eAAiB,SAAwBC,EAAMF,GAC7C3J,EAAE0J,QAAQG,GAAQ7J,EAAEC,KAAKiB,OAAO,GAAIlB,EAAE0J,QAAQG,GAAOF,IAEzD3J,EAAE8J,UAAY,SAAmBD,GAC7B7J,EAAE2J,OAASE,GAER7J,EAAE+J,KAAO/J,EAAEgK,EAAI,SAAmBC,EAAQxJ,GACzCT,EAAE2J,QAAU3J,EAAE0J,QAAQ1J,EAAE2J,SAAW3J,EAAE0J,QAAQ1J,EAAE2J,QAAQM,KACvDA,EAASjK,EAAE0J,QAAQ1J,EAAE2J,QAAQM,QAK7BA,EAASjK,EAAEC,KAAKiK,SAASD,EAAQxJ,GAErC,MAAO0J,WAGAF,KAEZzK,QDySI,IAAMwD,EAAKhD,EAAEoK,SAASpH,GAKhBqH,EAAMrK,EAAEoK,SAASC,IAKjBC,EAAWtK,EAAE+H,QAAQuC,SAG3B,SAASC,WACRC,KAAKC,SAAStK,SAAS,IAAIuK,OAAO,EAAG,GAGtC,SAAS7C,EAAK8C,EAAKC,OACpB,IAAIC,KAAKF,EAAKC,EAAGD,EAAIE,qHAvOpB,SAAsBpH,YAClBA,EAAKqH,aAAerH,EAAKsH,cAAgBtH,EAAKuH,iBAAiBnM,sOE7H7DoM,EAAO,gBACnBxK,IAAAA,KACAuB,IAAAA,KACAkJ,IAAAA,MACAC,IAAAA,MACAC,IAAAA,OACAC,IAAAA,OACAC,IAAAA,WACAC,cAAAA,aAAgB,uBAET,SAAAC,GACuB,iBAAlBD,IAA4BA,EAAgBE,GAAGF,QAEtDG,EAAOD,GAAGC,OAAOC,MAAMJ,GACzBK,GAAE,SAAAtL,UAAMA,EAAEuL,WAAaT,EAAO9K,EAAE4K,OAChCY,GAAGR,GACHS,IAAG,SAAAzL,UAAK+K,EAAO/K,EAAE6K,cAEf1K,GAAM+K,EAAKQ,MAAMvL,GAAMwL,KAAK,IAAKP,GACjC1J,GAAMwJ,EAAKS,KAAK,YAAajK,GAE1B0J,IAUIQ,EAAO,oBACnBzJ,KAAAA,aAAO,aACP0J,SAAAA,aAAW,QACXC,YAAAA,aAAc,IACdzD,IAAAA,SACA2C,IAAAA,OACAe,IAAAA,MACAC,IAAAA,KACAC,IAAAA,MACAC,IAAAA,MACAC,IAAAA,WACAC,IAAAA,MACAC,IAAAA,OACAC,IAAAA,cAEO,SAAAC,OACDC,EAAS,EAANC,EAAS,EACD,UAAZpE,IAAsBoE,EAAIzB,GACd,SAAZ3C,IAAqBmE,EAAIT,GAEjB,KAARC,GAAuB,QAAR7J,EAClB0J,GAAYb,EACM,KAARgB,GAAuB,QAAR7J,IACzB0J,GAAYE,OAGTW,EAAYvB,GAAG,OAAS9C,EAASsE,QAAQ,SAAS,SAAAC,UAAKA,EAAEC,oBAC3DZ,MAAMA,GACNC,MAAMA,GACNJ,YAAYA,GACZD,SAASA,GACTM,WAAWA,GAETW,EAAYP,EAAErE,OAAO,KACvByD,KAAK,QAAS,CAACK,EAAM7J,EAAMkG,GAAUpI,KAAK,MAC1C0L,KAAK,YAAa,aAAea,EAAI,IAAMC,EAAI,KAC/CM,KAAKL,UAEHN,GACHU,EAAU5E,OAAO,QACfyD,KAAK,IAAKU,GACVV,KAAK,IAAKW,GACVU,KAAKZ,GAGDU,IAIIG,EAAgB,gBAC5BC,IAAAA,gBACAC,IAAAA,cACAnC,IAAAA,cAEO,SAAAoC,OACFC,EAAKnD,KAAKoD,IAAIJ,EAAgB,GAAIC,EAAc,IAChDI,EAAKrD,KAAKsD,IAAIN,EAAgB,GAAIC,EAAc,WAE7CC,EACLzB,KAAK,QAAS4B,EAAKF,GACnB1B,KAAK,SAAUX,GACfW,KAAK,IAAK0B,KAIDI,EAAY,gBACxB1B,IAAAA,MACAf,IAAAA,cAEO,SAAAoC,UAAQA,EACbzB,KAAK,QAASI,GACdJ,KAAK,SAAUX,GACftK,MAAM,OAAQ,QACdA,MAAM,SAAU,QAChBA,MAAM,iBAAkB,SAGdgN,EAAO,SAACC,UACpBA,EAAMxL,KAAO,OACNyJ,EAAK+B,IAGAC,EAAkB,gBAC9B7M,IAAAA,UACA8M,OAAAA,aAAS,QACTC,OAAAA,aAAS,QACTvP,OAAAA,aAAS,WAEF,SAAAqE,UAAQA,EACb+I,KAAK,QAAS5K,EAAQ,sBACtB4K,KAAK,KAAMkC,GACXlC,KAAK,KAAMkC,GACXlC,KAAK,KAAMmC,GACXnC,KAAK,KAAMpN,KAGDwP,EAAmB,gBAC/BhN,IAAAA,UACA8M,OAAAA,aAAS,QACTC,OAAAA,aAAS,IACT1B,IAAAA,aAEO,SAAAY,GACNA,EACErB,KAAK,QAAS5K,EAAQ,uBACtBL,MAAM,iBAAkB,QACxBiL,KAAK,IAAKkC,EAAS,GACnBlC,KAAK,IAAKmC,OAERE,EAAIhB,EAAKtE,OAAO,0BACfsF,EAAEC,SAAQD,EAAIhB,EAAK9E,OAAO,cAE/B8F,EACErC,KAAK,QAAS,kBACdqB,KAAKZ,GAEPY,EAAKkB,UAAU,SAASvC,KAAK,IAAKkC,EAAS,GAEpCb,IAIImB,EAAmB,gBAC/BpN,IAAAA,UACA8M,OAAAA,aAAS,QACTC,OAAAA,aAAS,WAEF,SAAAM,UAAUA,EACfzC,KAAK,QAAS5K,EAAQ,8BACtB4K,KAAK,YAAa,aAAekC,EAAS,IAAMC,EAAS,KACzDnC,KAAK,IAAK,GACVA,KAAK,KAAM,GACXA,KAAK,KAAM,KAID0C,EAAa,gBACzB3M,IAAAA,KACAqK,IAAAA,MACAf,IAAAA,WACAsD,QAAAA,aAAU,YAEH,SAAA/B,UACNA,EACEZ,KAAK,QAAS,sBAAwBjK,EAAK6M,eAC3C5C,KAAK,YAAajK,GAEpB6K,EAAErE,OAAO,QACPyD,KAAK,QAAS,QACdA,KAAK,IAAMI,EAAQ,EAAK,IACxBJ,KAAK,IAAKX,EAASsD,EAAQvK,OAAS,GACpC4H,KAAK,QAAS,IACdA,KAAK,SAAU,IACfA,KAAK,UAAW,KAElBY,EAAErE,OAAO,QACP8E,KAAKtN,EAAEgK,EAAEhI,IACTiK,KAAK,IAAMI,EAAQ,EAAK,GACxBJ,KAAK,YAAa,IAClBjL,MAAM,4BAA6B,OACnCA,MAAM,cAAe,OACrBiL,KAAK,IAAKX,EAASsD,EAAQvK,OAAS,GACpC4H,KAAK,KAAM,UAENY,IAIIiC,EAAiB,oBAC7BX,OAAAA,aAAS,IACT7C,IAAAA,cAEO,SAAApI,UAAQA,EACb+I,KAAK,QAAS,oBACdA,KAAK,KAAMkC,GACXlC,KAAK,KAAM,GACXA,KAAK,KAAMkC,GACXlC,KAAK,KAAMX,KAGDyD,EAAkB,gBAC9BZ,IAAAA,OACAC,IAAAA,WACAzB,OAAAA,aAAS,SACTC,OAAAA,aAAS,KACTP,IAAAA,aAEO,SAAAQ,GAENA,EAAEZ,KAAK,QAAS,yBAEZyB,EAAOb,EAAE7D,OAAO,2BAChBsE,EAAOT,EAAE7D,OAAO,2BAChBsF,EAAIhB,EAAKtE,OAAO,wBAChB4C,EAAI0B,EAAKtE,OAAO,wBAEf0E,EAAKa,SAAQb,EAAOb,EAAErE,OAAO,SAC7B8E,EAAKiB,SAAQjB,EAAOT,EAAErE,OAAO,aAC7B8F,EAAEC,SAAQD,EAAIhB,EAAK9E,OAAO,cAC1BoD,EAAE2C,SAAQ3C,EAAI0B,EAAK9E,OAAO,cAE/B8F,EAAEhB,KAAKV,GACPhB,EAAE0B,KAAKX,OAGHqC,EAAS,EACTC,EAAS,EACTC,EAAO,CAAE7C,MAAO,EAAGf,OAAQ,OACzB4D,EAAO5B,EAAKiB,OAAOY,UAAa,MAAOlM,UAAY4J,SAErDsB,IAAQa,EAASb,GAAUA,EAAS9B,EAAQ,EAAI,IAAM6C,EAAK7C,MAAQ,KACnE+B,IAAQa,EAASzE,KAAKsD,IAAIM,EAASc,EAAK5D,OAAQtL,EAAEoP,QAAQC,OAAS,GAAKC,EAAAA,IAE5E5B,EACEzB,KAAK,QAAS,0BACdA,KAAK,IAAK+C,EAAS,GACnB/C,KAAK,IAAKgD,EAAS,GACnBhD,KAAK,QAASiD,EAAK7C,MAAQ,IAC3BJ,KAAK,SAAUiD,EAAK5D,OAAS,IAC7BW,KAAK,KAAM,GACXA,KAAK,KAAM,GACbqB,EACErB,KAAK,QAAS,0BACdjL,MAAM,cAAe,OACrBiL,KAAK,IAAKgD,GACZX,EACErC,KAAK,QAAS,uBACdA,KAAK,KAAM,OACbL,EACEK,KAAK,QAAS,uBACdA,KAAK,KAAM,OAEbqB,EAAKkB,UAAU,SAASvC,KAAK,IAAK+C,GAE3BnC,IAII0C,EAAQ,gBACpB9O,IAAAA,KACAwL,IAAAA,KACA2B,IAAAA,IACA4B,IAAAA,YACAC,IAAAA,MAEIC,EAASjP,EAAOgL,GAAGkE,OAAOlP,GAAM,SAAAH,UAAKA,EAAE2L,MAAS,CAAC,EAAG,eACrC,IAAR2B,IAAwBA,EAAM8B,EAAO,IAAMF,KACrDE,EAAO,GAAK9B,GAEM,oBAARE,MAAwBA,IAAM4B,EAAO,IAAMF,KACrDE,EAAO,GAAK5B,KAENrC,GAAGmE,cACRH,MAAMA,GACNC,OAAOA,oDApQc,SAACzB,UACjBxC,GAAG1E,OAAO,YACfkF,KAAK,QAAS,QACdoB,KAAKpC,EAAKgD,sKAoQS,oBACrBxN,KAAAA,aAAO,CAAC,EAAG,KACX8L,IAAAA,MACAX,IAAAA,EACAK,IAAAA,YAEOR,GACLoE,UAAS,SAAAvP,UAAKA,EAAE2L,MAChBhI,KAAKxD,EAAM8L,EAAMuD,OAAOlE,OCpShBmE,EAAQ/P,EAAEgQ,MAAM9O,OAAO,CAEjC+O,SAAUjQ,EAAEkQ,QAAUlQ,EAAEkQ,QAAQC,UAAYnQ,EAAEoQ,MAAMC,OAEpDC,WAAY,SAASnP,OAChBoP,EAAO1P,KAAKM,QAAUA,OAErBqP,MAAQ,QACRC,iBAAmBF,EAAKG,SAEzB7P,KAAKM,QAAQwP,eAGXC,QAAU,UACVC,QAAU,YAIVD,QAAU/P,KAAKM,QAAQ2P,YACvBD,QAAUhQ,KAAKM,QAAQ4P,aAGxBC,QAAUT,EAAKU,YACfC,QAAUX,EAAKY,WAEhB5E,EAAQ1L,KAAKuQ,eAEbC,EAAMxQ,KAAKyQ,KAAO7F,GAAG1E,OAAO,OAC9BkF,KAAK,QAAS,cACdA,KAAK,QAASsE,EAAKlE,OACnBJ,KAAK,SAAUsE,EAAKjF,QAEd+F,EACN7I,OAAO,KACPyD,KAAK,YAAa,aAAesE,EAAK3B,QAAQ3K,KAAO,IAAMsM,EAAK3B,QAAQzK,IAAM,KAC9EkJ,KAAKxM,KAAK0Q,eACVlE,KAAKxM,KAAK2Q,eACVnE,KAAKxM,KAAK4Q,mBACVpE,KAAKxM,KAAK6Q,oBACVrE,KAAKxM,KAAK8Q,sBAEPC,MAAQP,EAAIrI,OAAO,cACnB6I,MAAQR,EAAIrI,OAAO,cACnB8I,MAAQT,EAAIrI,OAAO,mBACnB+I,MAAQV,EAAIrI,OAAO,cACnBgJ,OAASX,EAAIrI,OAAO,eACpBiJ,WAAapR,KAAKmR,OAAOhJ,OAAO,aAChCkJ,QAAUb,EAAIrI,OAAO,gBACrBmJ,GAAK5F,EAAMX,OACXwG,GAAK7F,EAAM+B,GAIjB+D,OAAQ,SAASpE,UACZA,EAAMxN,OAAMI,KAAK2P,MAAQvC,EAAMxN,MAC/BwN,EAAM9M,UAASN,KAAKM,QAAU8M,EAAM9M,cAEnCiQ,oBACAkB,mBACAC,kBAEE1R,MAGR2R,OAAQ,6BACA,SAAAC,UAAaA,EAAUjK,QAAO,kBAAMkK,EAAKpB,KAAK/C,YAGtD6C,aAAc,eACTb,EAAO1P,KAAKM,oBAEXgR,GAAKQ,EAAS,CAClBlS,KAAMI,KAAK2P,MACXf,MAAO,CAAC,EAAG5O,KAAK+R,UAChB3G,KAAMsE,EAAKrF,MACX0C,IAAK2C,EAAKsC,SACV/E,IAAKyC,EAAKuC,SACVtD,YAAae,EAAKwC,uBAGdX,GAAKO,EAAS,CAClBlS,KAAMI,KAAK2P,MACXf,MAAO,CAAC5O,KAAKmS,UAAW,GACxB/G,KAAMsE,EAAKpF,MACXyC,IAAK2C,EAAK0C,SACVnF,IAAKyC,EAAK2C,SACV1D,YAAae,EAAKwC,kBAGZ,CAAEnH,EAAG/K,KAAKsR,GAAI7D,EAAGzN,KAAKuR,KAM9BE,YAAa,gBACPV,MAAMpD,UAAU,KAAK2E,cACrBpB,MAAMvD,UAAU,KAAK2E,cACrBvB,MACHvE,KAAKxM,KAAKuS,gBACV/F,KAAKxM,KAAKwS,qBACPtB,MACH1E,KAAKxM,KAAKyS,gBACVjG,KAAKxM,KAAK0S,iBAKbhB,gBAAiB,eACZhC,EAAO1P,KAAKM,aACX2Q,MACHzE,KACAsF,EAAQ,CACPpH,cAAegF,EAAKhF,cACpB9K,KAAMI,KAAK2P,MACXxO,KAAM,WACNkJ,MAAOqF,EAAKrF,MACZC,MAAOoF,EAAKpF,MACZkB,MAAOxL,KAAK+R,SACZtH,OAAQzK,KAAKmS,UACb5H,OAAQvK,KAAKsR,GACb9G,OAAQxK,KAAKuR,OAQjBb,YAAa,6BACL,SAAA1E,UACNA,EAAErE,OAAO,KACRyD,KAAK,QAAS,QACdoB,KAAKmG,EAAKJ,gBACV/F,KAAKmG,EAAKH,kBAMbD,aAAc,kBACNT,EAAQ,CACdrG,KAAM,IACN3D,SAAU,SACV0D,MAAOxL,KAAK+R,SACZtH,OAAQzK,KAAKmS,UACbzG,MAAO1L,KAAKsR,GACZ3F,MAAO3L,KAAKmQ,QACZvE,WAAY,MAOd4G,aAAc,kBACNV,EAAQ,CACdrG,KAAM,IACN3D,SAAU,OACV0D,MAAOxL,KAAK+R,SACZtH,OAAQzK,KAAKmS,UACbzG,MAAO1L,KAAKuR,GACZ5F,MAAO3L,KAAKM,QAAQgQ,OACpB1E,WAAY,MAOd+E,YAAa,6BACL,SAAA3E,UACNA,EAAErE,OAAO,KACRyD,KAAK,QAAS,QACdoB,KAAKoG,EAAKH,gBACVjG,KAAKoG,EAAKF,kBAMbD,aAAc,kBACNX,EAAQ,CACdrG,KAAM,IACN3D,SAAU,SACV0D,MAAOxL,KAAK+R,SACZtH,OAAQzK,KAAKmS,UACbzG,MAAO1L,KAAKsR,GACZ3F,MAAO3L,KAAKmQ,QACZtE,MAAO7L,KAAK+P,QACZhE,OAAQ,GACRD,OAAQ9L,KAAK+R,SAAW,KAO1BW,aAAc,kBACNZ,EAAQ,CACdrG,KAAM,IACN3D,SAAU,OACV0D,MAAOxL,KAAK+R,SACZtH,OAAQzK,KAAKmS,UACbzG,MAAO1L,KAAKuR,GACZ5F,MAAO3L,KAAKM,QAAQgQ,OACpBzE,MAAO7L,KAAKgQ,QACZlE,QAAS,GACTC,OAAQ,KAOV6E,gBAAiB,kBACT,SAAA5E,UAAKA,EAAErE,OAAO,KACnByD,KAAK,QAAS,QACdzD,OAAO,UAGVkJ,iBAAkB,6BACV,SAAA7E,UACCA,EAAErE,OAAO,KACdyD,KAAK,QAAS,SACdoB,KAAKqG,EAAKC,oBACVtG,KAAKqG,EAAKE,wBAOdD,iBAAkB,6BACV,SAAA9G,OACFgH,EAAYhH,EAAErE,OAAO,QACvB6E,KACAsF,EAAa,CACZtG,MAAOyH,EAAKlB,SACZtH,OAAQwI,EAAKd,oBAIZhT,EAAEoP,QAAQ2E,SACbF,EACE7Q,GAAG,kBAAmB8Q,EAAKE,kBAAkBC,KAAKH,IAClD9Q,GAAG,iBAAkB8Q,EAAKI,aAAaD,KAAKH,IAC5C9Q,GAAG,mBAAoB8Q,EAAKK,kBAAkBF,KAAKH,IACnD9Q,GAAG,kBAAmB8Q,EAAKK,kBAAkBF,KAAKH,IACpD9T,EAAEoK,SAASpH,GAAG8Q,EAAKxC,KAAK/C,OAAQ,WAAYuF,EAAKM,gBAAiBN,IAGnED,EACE7Q,GAAG,iBAAkB8Q,EAAKE,kBAAkBC,KAAKH,IACjD9Q,GAAG,iBAAkB8Q,EAAKI,aAAaD,KAAKH,IAC5C9Q,GAAG,mBAAoB8Q,EAAKO,mBAAmBJ,KAAKH,IACpD9Q,GAAG,kBAAmB8Q,EAAKK,kBAAkBF,KAAKH,IAClD9Q,GAAG,iBAAkB8Q,EAAKQ,iBAAiBL,KAAKH,IAClD9T,EAAEoK,SAASpH,GAAG8Q,EAAKxC,KAAK/C,OAAQ,UAAWuF,EAAKM,gBAAiBN,GAE1DD,IAOTD,mBAAoB,6BACZ,SAAA/G,OACF0H,EAASC,EAAKC,QAAU5H,EAAErE,OAAO,KACnCyD,KAAK,QAAS,mCAEhBuI,EAAKE,WAAaH,EAAO/L,OAAO,YAC9B6E,KACAsF,EAAkB,CACjBxE,OAAQ,EACR7C,OAAQkJ,EAAKxB,aAGhBwB,EAAKG,YAAcJ,EAAO/L,OAAO,KAC/B6E,KACAsF,EAAmB,CAClBxE,OAAQ,EACRC,OAAQ,EACR9C,OAAQkJ,EAAKxB,UACb3G,MAAOmI,EAAK5B,SACZjG,OAAQ,GACRC,OAAQ,MAGJ2H,IAOT5C,cAAe,kBACP,SAAA9E,UAGOA,EAAErE,OAAO,KACpByD,KAAK,QAAS,YAmBlB2G,OAAQ,eACHrC,EAAO1P,KAAKM,eACToP,EAAKlE,MAAQkE,EAAK3B,QAAQ3K,KAAOsM,EAAK3B,QAAQ1K,OAMtD8O,QAAS,eACJzC,EAAO1P,KAAKM,eACToP,EAAKjF,OAASiF,EAAK3B,QAAQzK,IAAMoM,EAAK3B,QAAQvK,QAMtD6P,aAAc,WAEbzI,GAAGmJ,MAAMC,iBACTpJ,GAAGmJ,MAAME,uBAEJC,aAAc,OACdC,sBAMNhB,kBAAmB,WAClBvI,GAAGmJ,MAAMC,iBACTpJ,GAAGmJ,MAAME,uBAEJC,aAAc,OACdE,iBAAmBxJ,GAAGyJ,MAAMrU,KAAKoR,WAAW1D,SAMlDyG,mBAAoB,WACdnU,KAAKoU,kBAAqBpU,KAAK4P,mBAC/B5P,KAAKsU,sBACJA,eAAiBtU,KAAKmR,OAAOtJ,OAAO,OAAQ,sBAC/CuD,KAAK,QAAS,cACdjL,MAAM,iBAAkB,cAEtBmU,eAAe9H,KACnBsF,EAAiB,CAChBnF,gBAAiB3M,KAAKoU,iBACtBxH,cAAe5M,KAAKuU,mBAAqB3J,GAAGyJ,MAAMrU,KAAKoR,WAAW1D,QAClEjD,OAAQzK,KAAKmS,eAQhBoB,gBAAiB,eACXvT,KAAKoU,mBAAqBpU,KAAKuU,qBAAuBvU,KAAKkU,wBAC1DE,iBAAmB,UACnBF,aAAc,OACflU,KAAK4P,kBAAkB5P,KAAKwU,kBAI7BC,EAAQzU,KAAK0U,cAAc1U,KAAKoU,iBAAiB,IACjDO,EAAM3U,KAAK0U,cAAc1U,KAAKuU,mBAAmB,IAEjDE,GAASE,SAERP,iBAAmB,UACnBF,aAAc,OAEd5S,KAAK,UAAW,CAAEsT,UAAW5U,KAAK2P,MAAM8E,GAAQI,QAAS7U,KAAK2P,MAAMgF,OAM1EnB,mBAAoB,gBACdlS,KAAK,gBAMXgS,kBAAmB,SAAS7T,EAAGuK,EAAG8K,OAE7BxH,EADS1C,GAAGyJ,MAAMrU,KAAKoR,WAAW1D,QAClB,GAChBnL,EAAOvC,KAAK2P,MAAM3P,KAAK0U,cAAcpH,SAEpChM,KAAK,aAAc,CAAEiB,KAAMA,EAAM+K,OAAQA,KAM/CmG,iBAAkB,gBACZnS,KAAK,cAMXoT,cAAe,SAAS3J,qBAChBH,GACLoE,UAAS,SAAAvP,UAAKA,EAAEsV,EAAKzU,QAAQ+J,UAC7BjH,KAAKpD,KAAK2P,OAAS,CAAC,EAAG,GAAI3P,KAAKsR,GAAGrC,OAAOlE,KAM7CyJ,WAAY,WACPxU,KAAKsU,sBACHA,eAAehC,cACfgC,eAAiB,UACjBU,6BACA1T,KAAK,gBAOZ2T,sBAAuB,SAAS1S,EAAM2S,QAGhCtB,QAAQuB,QAAQ,UAAU,OAE3BzF,EAAO1P,KAAKM,QACZxB,EAAY4Q,EAAK0F,YAAYtW,YAClB,CAAC4Q,EAAK0F,YAAYC,UAAW3F,EAAK0F,YAAYE,WAAxDC,OAAIC,OACLC,EAAczV,KAAKuR,GAAGhP,EAAKmN,EAAKpF,aAE/BuJ,WAAWrH,KACfsF,EAAkB,CACjBxE,OAAQ4H,EACRzK,OAAQzK,KAAKmS,kBAGV2B,YAAYtH,KAChBsF,EAAmB,CAClBxE,OAAQ4H,EACR3H,OAAQkI,EACRhL,OAAQzK,KAAKmS,UACb3G,MAAOxL,KAAK+R,SACZjG,OAAQhN,EAAUyD,EAAKmN,EAAKrF,OAAQkL,GAAM,IAAMvV,KAAK+P,QACrDhE,OAAQjN,EAAUyD,EAAKmN,EAAKpF,OAAQkL,GAAM,IAAMxV,KAAKgQ,YAKxDgF,sBAAuB,gBACjBpB,QAAQuB,QAAQ,UAAU,MAIjCjG,EAAMwG,aAAY,gBACZvT,GAAG,cAAc,SAASC,GAC1BA,EAAEG,MAAMvC,KAAKiV,sBAAsB7S,EAAEG,KAAMH,EAAEkL,cCle5C,IAAIqI,EAASxW,EAAEgQ,MAAM9O,OAAO,CAElCoP,WAAY,SAASnP,WACfA,QAAUA,EAEXN,KAAKM,QAAQwP,eAGXC,QAAU,UACVC,QAAU,YAIVD,QAAU/P,KAAKM,QAAQ2P,YACvBD,QAAUhQ,KAAKM,QAAQ4P,QAGF,kBAAvBlQ,KAAKM,QAAQM,OAA4B,CACpCZ,KAAK4V,SAAWhL,GAAG1E,OAAO,KAAKkF,KAAK,QAAS,2BAChDyK,kBAAoBjL,GAAG1E,OAAO,iBAC9B4P,QAAUlL,GAAG1E,OAAO,mBACpB6P,uBAAyBnL,GAAG1E,OAAO,gBACP,mBAAvBlG,KAAKM,QAAQM,cAClBoV,QAAU7W,EAAEyB,OAAO,CAAC,EAAG,GAAI,CAAEC,KAAMb,KAAKM,QAAQ2V,WAAYC,aAAc,IAASC,aAAa,MAIvGC,MAAO,SAASC,OAEXC,EAAMC,iBADLC,KAAOH,EAEPA,EAAII,QAAQ,oBAChBH,EAAOtW,KAAK0W,MAAQL,EAAIM,WAAW,kBAC9BxW,MAAMyW,OAAS,IACpBN,EAAKnW,MAAMsD,cAAgB,QAED,kBAAvBzD,KAAKM,QAAQM,OAA4B,CAC5C2V,EAAWpX,EAAEqR,IAAI,CAAE8F,KAAM,kBAAmBF,MAAMpW,KAAKwW,UACnDxK,EAAIhM,KAAK4V,SAAWhL,GAAGzC,OAAOoO,EAASE,WAAWtO,OAAO,WAAWiD,KAAK,QAAS,sBACtFY,EAAErE,QAAO,kBAAMkK,EAAKgE,kBAAkBnI,UACtC1B,EAAErE,QAAO,kBAAMkK,EAAKiE,QAAQpI,UAC5B1B,EAAErE,QAAO,kBAAMkK,EAAKkE,uBAAuBrI,cACV,mBAAvB1N,KAAKM,QAAQM,aAClBoV,QAAQI,MAAMC,EAAK,CAAEC,KAAM,mBAOlC9E,OAAQ,SAASpE,GACZA,EAAM9M,UAASN,KAAKM,QAAU8M,EAAM9M,aAEpCoP,EAAO1P,KAAKM,QAEXN,KAAKwW,MAAMxW,KAAKoW,MAAMhJ,EAAMiJ,UAE5BQ,QAAUzJ,EAAM7K,KAAK5B,WAEtBY,EAAQpC,EAAEkB,OAAO,GAAI+M,EAAM7K,KAAMvC,KAAKwW,KAAKM,mBAAmB9W,KAAK6W,aAE5C,kBAAvB7W,KAAKM,QAAQM,OAA4B,KAExC9B,EAAY4Q,EAAK0F,YAAYtW,UAC7B0W,EAAK9F,EAAK0F,YAAYE,UAEtByB,EAAgB/W,KAAKmS,UAAY/E,EAAM4J,aAAezV,EAAM0V,EAC5DC,EAAc3V,EAAMkM,EAAIsJ,OAEvBnB,SAAST,QAAQ,UAAU,QAC3BW,QAAQX,QAAQ,UAAU,QAE1BW,QACHtJ,KACAsF,EAAoB,CACnBtR,MAAOR,KAAKM,QAAQE,MACpB8M,OAAQ/L,EAAMwJ,EACdwC,OAAQhM,EAAMkM,UAGZoI,kBACHrJ,KACAsF,EAAmB,CAClBtR,MAAOR,KAAKM,QAAQE,MACpB8M,OAAQ/L,EAAMwJ,EACdwC,OAAQhM,EAAMkM,EACdzP,OAAQkZ,UAINnB,uBACHvJ,KACAsF,EAAoB,CACnBtR,MAAOR,KAAKM,QAAQE,MACpB8M,OAAQ/L,EAAMwJ,EACdwC,OAAQ2J,EACRrL,MAAO/M,EAAUyC,EAAMmO,EAAKpF,OAAQkL,GAAM,IAAMxV,KAAKgQ,eAGvB,mBAAvBhQ,KAAKM,QAAQM,SACvBuI,EAAcnJ,KAAKgW,QAAQmB,aAAc,eACpCnB,QAAQoB,UAAUpX,KAAK6W,WAO9BvE,OAAQ,WACoB,kBAAvBtS,KAAKM,QAAQM,QACZZ,KAAK4V,UAAU5V,KAAK4V,SAAST,QAAQ,UAAU,GAC/CnV,KAAK8V,SAAS9V,KAAK8V,QAAQX,QAAQ,UAAU,IAChB,mBAAvBnV,KAAKM,QAAQM,QACvBuI,EAAWnJ,KAAKgW,QAAQmB,aAAc,WAIxCE,UAAW,kBACHrX,KAAK6W,SAMb1E,QAAS,eACJzC,EAAO1P,KAAKM,eACToP,EAAKjF,OAASiF,EAAK3B,QAAQzK,IAAMoM,EAAK3B,QAAQvK,UC/H5C8T,GCFUnY,EAAEgQ,MAAM9O,OAAO,IDEf,CACpBkX,UAAWpY,EAAEoP,QAAQ2E,OACrBsE,gBAAgB,EAChBC,WAAW,EACXC,UAAU,EACVC,eAAgB,EAChB9H,UAAW1Q,EAAEoP,QAAQ2E,OACrB0E,aAAc,OACdC,aAAc,iBACdC,cAAc,EACd5F,iBAAiB,EACjBpR,WAAY,CACXiX,OAAO,EACPhX,eAAgB,CACfiX,aAAc,KACdC,WAAY,KACZC,UAAW,KACXlX,SAAU,IACL7B,EAAEgZ,QAAQ,CACb1X,UAAW,4BACX2X,KAAM,0CACNC,SAAU,CAAC,GAAI,IACfC,WAAY,CAAC,EAAG,SAKpB7N,OAAQ,IACR8N,aAAc,EACdnD,YAAa,CACZC,UAAW,EACXC,UAAW,EACXxW,UAAWqK,GAEZ2G,UAAU,EACVpF,cAAe,cACf8N,YAAY,EACZC,QAAQ,EACRC,SAAU,CACTC,OAAO,EACP7U,MAAM,GAEPlD,OAAQ,iBACRqV,WAAY9W,EAAEgZ,QAAQ,CACrB1X,UAAW,4BACX2X,KAAM,0CACNC,SAAU,CAAC,GAAI,IACfC,WAAY,CAAC,GAAI,MAElBM,aAAa,EACb9Q,SAAU,WACVvH,SAAU,CACTE,UAAW,qBACXoY,MAAO,OACPC,QAAS,IACTC,OAAQ,EACRC,QAAS,SAEVC,eAAe,EACfC,iBAAiB,EACjB1Y,MAAO,kBACPuN,QAAS,CACRzK,IAAK,GACLD,MAAO,GACPG,OAAQ,GACRJ,KAAM,IAEP+V,YAAY,EACZC,QAAS,SACTC,OAAO,EACP7N,MAAO,IACPnB,MAAO,OACP4F,OAAQ,KACRG,YAAQkJ,EACRhP,MAAO,IACP+H,cAAUiH,EACVlH,cAAUkH,EACVpJ,OAAQ,IACRI,YAAQgJ,EACRC,QAAS,KEzEGC,EAAYra,EAAEsa,QAAQD,UAAYra,EAAEsa,QAAQpZ,OAAO,CAE/D+O,SAAUjQ,EAAEkQ,QAAUlQ,EAAEkQ,QAAQC,UAAYnQ,EAAEoQ,MAAMC,OAEpDlP,QAASgX,EACToC,aAAc,QACdC,aAAc,QACdC,KAAM,6CACNC,OAAQ,6CAKRhY,QAAS,SAASpC,EAAGQ,cAChB,MAAQA,GAA4CR,EAAE0C,KACzDlC,EAAQR,GAET+Z,EAAUM,cAAgB3Q,EACzBnJ,KAAK4Z,KACS,gCAAPhP,iBAAAA,OAAoB5K,KAAKM,QAAQkY,WACxCgB,EAAUM,eACTC,MAAK,WACNlI,EAAKmI,SAASva,GACdoS,EAAKoI,UAAUha,GACf4R,EAAK9P,SAAS,gBAAiB,CAAEnC,KAAMH,EAAGQ,MAAOA,EAAO6B,WAAY+P,EAAK/P,iBAO3EsU,MAAO,SAASC,MACXrW,KAAKM,QAAQoX,SAAU,KACtBwC,EAASla,KAAKma,oBACbD,EAAOE,aAAajR,EAASkN,EAAIgE,WAAYH,EAAQ,YAC1D/Q,EAAS+Q,EAAQla,KAAKsa,MAAMjE,SAE5BlX,EAAEsa,QAAQnK,UAAU8G,MAAM5J,KAAKxM,KAAMqW,UAE/BrW,MAMRua,MAAO,gBACDC,kBACAC,mBACAC,kBAEA3Y,SAAS,kBAMf4Y,gBAAiB,gBACXC,OAAOhL,kBAAmB,OAC1B4E,cAMNqG,eAAgB,gBACVD,OAAOhL,kBAAmB,GAMhCkL,UAAW,SAASC,GACnBA,EAASA,GAAU/a,KAAKgb,YACpBhb,KAAKwW,MAAQuE,EAAOE,WAAWjb,KAAKwW,KAAKsE,UAAUC,IAGxDC,UAAW,SAASpb,UACnBA,EAAOA,GAAQI,KAAK2P,MACbxQ,EAAE+b,aAAatb,EAAKyW,KAAI,SAAC5W,UAAMA,EAAEkB,YAMzCwa,WAAY,kBACJnb,KAAKob,UAMbC,KAAM,WACLlS,EAAQnJ,KAAKqa,WAAY,UAAW,SAMrC5K,WAAY,SAASnP,QACfA,QAAU6I,EAAY,GAAInJ,KAAKM,QAASA,GAEzCN,KAAKM,QAAQwP,eACXwL,gBAAkBtb,KAAK0Z,kBACvB6B,cAAgBvb,KAAK2Z,kBACrB5J,QAAU,UACVC,QAAU,YAEVsL,gBAAkBtb,KAAKM,QAAQqX,oBAC/B4D,cAAgBvb,KAAKM,QAAQiY,kBAC7BxI,QAAU/P,KAAKM,QAAQ2P,YACvBD,QAAUhQ,KAAKM,QAAQ4P,aAGxBsL,eAAgB,OAChBJ,SAAWpb,KAAKM,QAAQiZ,QAEzBvZ,KAAKM,QAAQwX,eAAc9X,KAAKyb,YAActc,EAAEC,KAAKsc,SAAS1b,KAAKyb,YAAa,IAAKzb,OACrFA,KAAKM,QAAQsY,cAAa5Y,KAAKM,QAAQoY,SAAS5U,KAAO9D,KAAKM,QAAQoY,SAASC,OAAQ,GAErF3Y,KAAKM,QAAQmY,SAAQzY,KAAKM,QAAQyN,QAAQvK,QAAU,KAMzDmY,KAAM,SAAS/b,EAAM8P,QACfgJ,SAAS9Y,EAAM8P,IAMrBkM,UAAW,SAASvF,QACdD,MAAMC,IAMZqC,SAAU,SAAS9Y,EAAM8P,IACxBA,EAAOvQ,EAAEkB,OAAO,GAAIL,KAAKM,QAAQoY,SAAUhJ,IAClCiJ,WACHkD,UAAUjc,EAAM8P,GACXA,EAAK5L,UACVgY,SAASlc,EAAM8P,GACVvG,EAAWvJ,QAChBmc,QAAQnc,GACHuJ,EAAYvJ,QACjBoc,YAAYpc,QAEZuF,SAASvF,IAOhBic,UAAW,SAASjc,EAAM8P,IACzBA,EAAOvQ,EAAEkB,OAAO,GAAIL,KAAKM,QAAQoY,SAAUhJ,IACtCiJ,OAAQ,EACbxP,EAAYhK,EAAEiU,KAAKpT,KAAK0Y,SAAU1Y,KAAMJ,EAAM8P,KAM/CvK,SAAU,SAASX,cAClB2E,EAAW3E,GACTuV,MAAK,SAACna,GACN+S,EAAKsJ,aAAezX,EACpBmO,EAAK+F,SAAS9Y,EAAM,CAAEkE,MAAM,EAAO6U,OAAO,OAE1CuD,OAAM,SAAC5S,UAAQrF,QAAQC,KAAKoF,OAM/B0S,YAAa,SAASpc,GACrBuJ,EAAgBvJ,EAAMI,OAMvB+b,QAAS,SAASnc,cACjB4Z,EAAU2C,eAAiBhT,EAC1BnJ,KAAK6Z,OACY,mBAAV1a,EAAE+C,MAAuBlC,KAAKM,QAAQkY,WAC7CgB,EAAU2C,gBACTpC,MAAK,kBAAM5Q,EAAYvJ,EAAMgT,OAMhCkJ,SAAU,SAASlc,EAAM8P,cAEpB9M,GADJ8M,EAAOvQ,EAAEkB,OAAO,GAAIL,KAAKM,QAAQoY,SAAUhJ,IAC3B5L,KAAKsY,WAAa1M,EAAK5L,KAAO9D,KAAK4Y,YACnDzP,EAAauG,EAAK5L,MAChBiW,MAAK,WACLrK,EAAK5L,MAAO,EACZ+O,EAAK6F,SAAS9Y,EAAM8P,GACpBmD,EAAKhU,KAAK,kBAAkB,kBAAM6Q,EAAK5L,KAAKsY,WAAW5V,YAAY5D,UAQtE0X,MAAO,SAASjE,mBACVG,KAAOH,MAERzE,EAAY5R,KAAKqa,WAAalR,EAAS,MAAO,+BAAiCnJ,KAAKM,QAAQE,cAE3FR,KAAKM,QAAQoX,UACjBvO,EAAWyI,EAAW,mBAGnB5R,KAAKM,QAAQsY,cAAgB5Y,KAAK2P,aAChCiJ,YAAczP,EAAS,MAAO,wBAA6D,iBAA7BnJ,KAAKM,QAAQsY,YAA2B,CAAE5T,IAAKhF,KAAKM,QAAQsY,YAAayD,IAAK,IAAOrc,KAAKM,QAAQsY,aACrKzP,EAASyI,EAAW5R,KAAK4Y,YAAa,gBAGvCY,EAAUM,cAAgB3Q,EACzBnJ,KAAK4Z,KACS,gCAAPhP,iBAAAA,OAAoB5K,KAAKM,QAAQkY,WACxCgB,EAAUM,eACTC,MAAK,WACN9G,EAAKqJ,YAAY1K,GACjBqB,EAAKsJ,WAAW3K,GAChBqB,EAAKuJ,YAAY5K,GAEjBqB,EAAKuD,KAAKrU,GAAG,0BAA2B8Q,EAAKwJ,oBAAqBxJ,GAClEA,EAAKuD,KAAKrU,GAAG,SAAU8Q,EAAKyJ,WAAYzJ,GACxCA,EAAKuD,KAAKrU,GAAG,SAAU8Q,EAAK0J,aAAc1J,GAC1CA,EAAKuD,KAAKrU,GAAG,YAAa8Q,EAAKuB,WAAYvB,GAE3C9J,EAAK8J,EAAKuD,KAAK6D,WAAY,aAAcpH,EAAKuB,WAAYvB,GAC1D9J,EAAK8J,EAAKuD,KAAK6D,WAAY,aAAcpH,EAAKuB,WAAYvB,GAE1DA,EAAK9Q,GAAG,gBAAiB8Q,EAAK2J,aAAc3J,GAC5CA,EAAK9Q,GAAG,gBAAiB8Q,EAAK4J,eAAgB5J,GAE9CA,EAAK2J,eACL3J,EAAK4J,oBAGCjL,GAORkL,SAAU,SAASzG,QACbgE,WAAa,UAEb7D,KAAKhN,IAAI,0BAA2BxJ,KAAKyc,oBAAqBzc,WAC9DwW,KAAKhN,IAAI,SAAUxJ,KAAK0c,WAAY1c,WACpCwW,KAAKhN,IAAI,SAAUxJ,KAAK2c,aAAc3c,WACtCwW,KAAKhN,IAAI,YAAaxJ,KAAKwU,WAAYxU,MAE5CmJ,EAAMnJ,KAAKwW,KAAK6D,WAAY,aAAcra,KAAKwU,WAAYxU,MAC3DmJ,EAAMnJ,KAAKwW,KAAK6D,WAAY,aAAcra,KAAKwU,WAAYxU,WAEtDwJ,IAAI,gBAAiBxJ,KAAK4c,aAAc5c,WACxCwJ,IAAI,gBAAiBxJ,KAAK6c,eAAgB7c,OAMhD+c,OAAQ,gBACFJ,gBAMNK,WAAY,SAASC,QACf7B,SAAW6B,GAMjBC,KAAM,WACL/T,EAAQnJ,KAAKqa,WAAY,UAAW,UAMrCL,SAAU,SAASva,cACd0d,EAAO1d,GAAKA,EAAEkC,SACdyb,EAAO3d,GAAgB,sBAAXA,EAAEmC,KACdyb,EAAM5d,GAAKA,EAAE6d,YAEbH,SACKA,EAAKvb,UACP,kBACC2b,gBAAgBJ,EAAKK,uBAGtB,kBACJrU,EAAOgU,EAAKK,aAAa,SAAAC,UAAU9J,EAAK4J,gBAAgBE,oBAIxDxZ,QAAQC,KAAK,6CAA+CiZ,EAAKvb,MAIhEwb,GACHjU,EAAO1J,EAAEie,UAAU,SAAAtd,UAAWuT,EAAKqG,SAAS5Z,MAGzCid,QACEM,YAAYle,EAAE6d,WAOrBC,gBAAiB,SAASE,cACzBtU,EAAOsU,GAAQ,SAAAlc,UAASwT,EAAK6I,UAAUrc,EAAM,GAAIA,EAAM,GAAIA,EAAM,QAMlEoc,YAAa,SAASF,cACrBtU,EAAOsU,GAAQ,SAAAlc,UAASsc,EAAKD,UAAUrc,EAAMuc,IAAKvc,EAAMwc,IAAKxc,EAAMyc,KAAKC,SAMzEL,UAAW,SAAS7S,EAAG0C,EAAGwJ,MACrBjX,KAAKM,QAAQ2Y,cAAe,OACtB,CAACxL,EAAG1C,GAAZA,OAAG0C,WAGD7N,EAAOI,KAAK2P,OAAS,GACrBuO,EAASle,KAAKme,gBAAkB1P,EAAAA,EAChC2P,EAASpe,KAAKqe,eAAkB5P,EAAAA,EAChC6P,EAAOte,KAAKue,WAAa,EAEzBC,EAAO,IAAIrf,EAAEsf,OAAO1T,EAAG0C,GACvBiR,EAAO9e,EAAK5B,OAAS4B,EAAKA,EAAK5B,OAAS,GAAG2C,OAAS6d,EAEpDG,EAAQH,EAAKI,WAAWF,GAAQ1e,KAAKsb,mBAEzCgD,GAAc3U,KAAKkV,MAAMF,EAAQ,IAAO,KAAU,KAG7C3e,KAAKM,QAAQ4Y,iBAAmBtZ,EAAK5B,OAAS,EAAG,KACjD8gB,EAAQlf,EAAKA,EAAK5B,OAAS,GAAGiZ,KAC9B8H,MAAMD,GAAQ,KACbE,EAAQhf,KAAKif,YACbC,EAAQjI,EAAIjX,KAAKub,cAChBwD,MAAMC,IAAWD,MAAMG,GAEhBH,MAAMC,GAEND,MAAMG,KACjBJ,EAAQI,GAFRJ,EAAQE,EAFRF,GAASE,EAAQE,GAAS,EAMtBH,MAAMD,GACNlf,EAAKuf,OAAOvf,EAAK5B,OAAS,EAAG,GADf4B,EAAKA,EAAK5B,OAAS,GAAGiZ,EAAI6H,GAK/C7H,GAAQjX,KAAKub,cAGRwD,MAAM9H,KACViH,EAASA,EAASjH,EAAIA,EAAIiH,EAC1BE,EAASA,EAASnH,EAAIA,EAAImH,OACrBa,YAAchI,GAGpBrX,EAAKwf,KAAK,CACTd,KAAMA,EACNvT,EAAGA,EACH0C,EAAGA,EACHwJ,EAAGA,EACHtW,OAAQ6d,SAGJ7O,MAAQ/P,OACRkC,WAAa9B,KAAK8B,YAAc,QAChCA,WAAWud,SAAWrf,KAAKue,UAAYD,OACvCxc,WAAWwd,cAAgBtf,KAAKme,cAAgBD,OAChDpc,WAAWyd,cAAgBvf,KAAKqe,cAAgBD,OAEhDrc,SAAS,kBAAmB,CAAEyd,MAAO5f,EAAK5B,OAAS,KAGzDic,UAAW,SAASha,GACfA,IACHkJ,EAAWlJ,EAAMgR,MAAOjR,KAAKM,QAAQC,SAASE,UAAY,IAAMT,KAAKM,QAAQE,OAE7EP,EACEkC,GAAG,YAAanC,KAAKyf,uBAAwBzf,MAC7CmC,GAAG,WAAYnC,KAAKyT,iBAAkBzT,WAEnC0f,QAAU1f,KAAK0f,SAAW,QAC1BA,QAAQvgB,EAAEC,KAAKugB,MAAM1f,IAAUA,IAOtCka,kBAAmB,eACdD,EAAS/Q,EAASnJ,KAAKM,QAAQuX,qBAC9BqC,SACC5Z,QAAQuX,aAAe,kBAAoB1O,IAChD+Q,EAAS/Q,EAAS,MAAO,0CAA2C,CAAEyW,GAAI5f,KAAKM,QAAQuX,aAAahO,OAAO,MAExG7J,KAAKM,QAAQoX,WAChBvO,EAAW+Q,EAAQ,sBACnB/Q,EAAc+Q,EAAQ,yBAElBA,OAASA,EACPla,KAAKka,QAMb2F,eAAgB,6BACR,SAAAjO,OACFwH,EAAU0G,EAAKC,WAAanO,EAAUjK,OAAO,OAC/CyD,KAAK,QAAS,sBAAwB0U,EAAKxf,QAAQ8Y,QAAU0G,EAAKxf,QAAQ8Y,QAAU,WAAa,KAAK1L,cAGxGvE,EAAQ2W,EAAKC,WAAY,YAAaD,EAAKxf,QAAQkL,MAAQ,MAE3DsU,EAAKjD,iBACEzD,IAOTqB,YAAa,gBACPjG,cAMNkG,WAAY,gBACN/K,MAAQ,UACR4O,UAAY,UACZJ,cAAgB,UAChBE,cAAgB,UAChBvc,WAAa,UACb4d,QAAU,MAMhBlF,WAAY,2BACNiC,sBACLtT,EAAOnJ,KAAK0f,SAAS,SAAArT,UAAKlD,EAAckD,EAAE4E,MAAO+O,EAAK1f,QAAQC,SAASE,UAAY,IAAMuf,EAAK1f,QAAQE,WAMvGyf,UAAW,WACV9W,EAAcnJ,KAAKqa,WAAY,sBAC/BlR,EAAWnJ,KAAKqa,WAAY,wBAM7B6F,QAAS,WACR/W,EAAcnJ,KAAKqa,WAAY,uBAC/BlR,EAAWnJ,KAAKqa,WAAY,uBAM7B8F,mBAAoB,SAASxf,OACxByf,EAAS,KACT3gB,EAAIgP,EAAAA,SACRtF,EAAOnJ,KAAK2P,OACX,SAAApN,OACK+b,EAAO3d,EAAOie,WAAWrc,EAAK5B,QAC9B2d,EAAO7e,IACVA,EAAI6e,EACJ8B,EAAS7d,MAGL6d,GAMR1L,cAAe,SAAS3J,UAChB/K,KAAK4a,OAAOlG,cAAc3J,IAMlChJ,SAAU,SAASH,EAAMhC,EAAMygB,GAC1BrgB,KAAKsB,MAAMtB,KAAKsB,KAAKM,EAAMhC,EAAMygB,GACjCrgB,KAAKwW,MAAMxW,KAAKwW,KAAKlV,KAAKM,EAAMhC,EAAMygB,IAM3ClO,QAAS,eACJzC,EAAO1P,KAAKM,eACToP,EAAKjF,OAASiF,EAAK3B,QAAQzK,IAAMoM,EAAK3B,QAAQvK,QAMtDiZ,oBAAqB,WAChBzc,KAAKM,QAAQkX,qBACXxB,QAAQ1D,UAOfiK,WAAY,eACP7M,EAAO1P,KAAKM,WAChBoP,EAAKU,OAASV,EAAKU,QAAUzG,KAAKkV,MAAM7e,KAAK+R,SAAW,IACxDrC,EAAKY,OAASZ,EAAKY,QAAU3G,KAAKkV,MAAM7e,KAAKmS,UAAY,IAErDzC,EAAKyJ,cACJzJ,EAAKgI,SAAU,KACd4I,EAAQtgB,KAAKka,OAAOjQ,YACpBsW,EAAQvgB,KAAKka,OAAOhQ,aACxBwF,EAAKlE,MAAQ8U,EAAQ,EAAIA,EAAQ5Q,EAAKlE,MACtCkE,EAAKjF,OAAU8V,EAAQ,GAAM,EAAIA,EAAQ,GAAK7Q,EAAKjF,WAC7C,CACNiF,EAAK8Q,UAAY9Q,EAAK8Q,UAAY9Q,EAAKlE,MAAQkE,EAAK8Q,UAAY9Q,EAAKlE,UACjEiV,EAAiBzgB,KAAKwW,KAAK6D,WAAWqG,YAC1ChR,EAAKlE,MAAQkE,EAAK8Q,UAAYC,EAAiBA,EAAiB,GAAK/Q,EAAKlE,UAIxEmV,EAAQ3gB,KAAK4a,OAAS,IAAI1L,EAAMQ,GAEpB9E,GAAGzC,OAAOnI,KAAKqa,YAC7B7N,KAAKxM,KAAK4a,OAAOjJ,UACjBnF,KAAKxM,KAAK6f,uBAEPpP,KAAOkQ,EAAMlQ,UACbM,MAAQ4P,EAAM5P,WACdC,MAAQ2P,EAAM3P,WACdC,MAAQ0P,EAAM1P,WACdC,MAAQyP,EAAMzP,WACdC,OAASwP,EAAMxP,YACfC,WAAauP,EAAMvP,gBACnBE,GAAKqP,EAAMrP,QACXC,GAAKoP,EAAMpP,QACXF,QAAUsP,EAAMtP,aAChByC,YAAc9T,KAAK4a,OAAO9G,iBAC1BD,WAAa7T,KAAK4a,OAAO/G,WAE9B8M,EAAMxe,GAAG,aAAcnC,KAAKyc,oBAAqBzc,MACjD2gB,EAAMxe,GAAG,cAAenC,KAAK+B,SAASqR,KAAK,kBAAmBpT,MAC9D2gB,EAAMxe,GAAG,UAAWnC,KAAK+B,SAASqR,KAAK,oBAAqBpT,MAC5D2gB,EAAMxe,GAAG,aAAcnC,KAAKsT,kBAAmBtT,MAC/C2gB,EAAMxe,GAAG,YAAanC,KAAKyT,iBAAkBzT,WAGxC+B,SAAS,kBAGfya,YAAa,SAAS5K,QAChBoE,QAAU,IAAIL,EAAO3V,KAAKM,UAMhCgc,YAAa,SAAS1K,MAErBA,EAAU1J,aAAa,iBAAiB,GAEnClI,KAAKM,QAAQoX,UACjBvY,EAAEoK,SACAqX,wBAAwBhP,GAIvBzS,EAAEoP,QAAQ2E,QACb/J,EAAKyI,EAAW,QAASzS,EAAEoK,SAAS0K,iBAGrC9K,EAAKyI,EAAW,aAAc5R,KAAK6gB,mBAAoB7gB,OAElDA,KAAKM,QAAQoX,SAAU,KACvBoJ,EAAO9gB,KAAK+gB,QAAU5X,EAAS,IAAK,0CAA4CnJ,KAAKM,QAAQiX,SAAW,GAAK,iBAAkB,CAAEpR,KAAM,IAAK6a,MAAO7hB,EAAEgK,EAAE,cAAgByI,GAEvK5R,KAAKM,QAAQmX,iBACXwI,YACDjgB,KAAKM,QAAQiX,UAChBpO,EAAKyI,EAAW,YAAa5R,KAAKkgB,QAASlgB,MAC3CmJ,EAAKyI,EAAW,WAAY5R,KAAKigB,UAAWjgB,QAE5CmJ,EAAK2X,EAAM,QAAS3hB,EAAEoK,SAAS0X,MAC/B9X,EAAK2X,EAAM,QAAS9gB,KAAKkhB,QAASlhB,OAGnCmJ,EAAK2X,EAAM,QAAS9gB,KAAKkhB,QAASlhB,WAE7BwW,KAAKrU,GAAG,QAASnC,KAAKigB,UAAWjgB,SAWzCsT,kBAAmB,SAASlR,MACtBpC,KAAK2P,OAA+B,IAAtB3P,KAAK2P,MAAM3R,QAAiBgC,KAAKwb,mBAGhDlO,EAASlL,EAAEkL,OACX/K,EAAOvC,KAAK2P,MAAM3P,KAAK0U,cAAcpH,SAEpC6T,oBAAoB5e,QACpBkZ,YAAYlZ,GAEbvC,KAAKwW,MACRrN,EAAWnJ,KAAKwW,KAAK6D,WAAY,uBAG7BtY,SAAS,kBAAmB,CAAEnC,KAAM2C,EAAM+K,OAAQA,SAClDvL,SAAS,iBAAkB,CAAEnC,KAAM2C,EAAM+K,OAAQA,MAMvDmS,uBAAwB,SAASrd,MAC3BpC,KAAK2P,OAA+B,IAAtB3P,KAAK2P,MAAM3R,YAI1BuE,EAAOvC,KAAKmgB,mBAAmB/d,EAAEzB,WACjC4B,EAAM,KACL+K,EAAS/K,EAAKyI,WAEdhL,KAAKwb,eAAexb,KAAK4a,OAAO3F,sBAAsB1S,EAAM+K,QAE3D6T,oBAAoB5e,QAEpBR,SAAS,kBAAmB,CAAEnC,KAAM2C,EAAM+K,OAAQA,OAOzDmG,iBAAkB,WACZzT,KAAKM,QAAQoX,gBACZ+E,2BACA7B,OAAO5F,yBAGThV,KAAKwW,MACRrN,EAAcnJ,KAAKwW,KAAK6D,WAAY,uBAGhCtY,SAAS,mBAMf8e,mBAAoB,SAASze,OACxBpC,KAAKwW,KAAK4K,kBAAmBphB,KAAKwW,KAAK4K,gBAAgBC,cACvDC,EAAKthB,KAAKgW,QAAQqB,aAAerX,KAAKwW,KAAK+K,YAC3CtK,EAAIjX,KAAKwW,KAAKgL,UAAY7X,KAAK8X,KAAKrf,EAAEsf,aACrClN,kBACAgC,KAAKmL,MAAML,EAAIrK,KAMrBzC,WAAY,gBACNoG,OAAOpG,kBACPiI,uBAMNC,WAAY,WACP1c,KAAKwW,MAAQxW,KAAKwW,KAAKoL,qBACtBpN,kBACAiI,2BACA3B,cAMN6B,aAAc,cAE8B,QAAvCxT,EAAQnJ,KAAKqa,WAAY,YAEzBra,KAAKM,QAAQ6Y,cACZnZ,KAAKM,QAAQoX,SAAU,KACtBmK,EAAW7hB,KAAKka,OAAOjQ,YACvB4X,SACEvhB,QAAQkL,MAAQqW,OAChB3H,OAAO4H,UAAY,GACxB3Y,EAASnJ,KAAKka,OAAQla,KAAKsa,MAAMta,KAAKwW,kBAGlCA,KAAKuL,cAAc/hB,KAAKqa,iBACxBjE,MAAMpW,KAAKwW,OAQnB0K,QAAS,WACJ/X,EAAWnJ,KAAKqa,WAAY,sBAC/Bra,KAAKigB,YAELjgB,KAAKkgB,WAMPzE,YAAa,SAASlZ,MAChBvC,KAAKM,QAAQwX,cAAiB9X,KAAKwW,UACpCyG,EAAOjd,KAAKwW,KAAKgL,UACrBvE,EAAOA,EAAOjd,KAAKob,SAAWpb,KAAKob,SAAW6B,OACzCzG,KAAKwL,QAAQzf,EAAK5B,OAAQsc,EAAM,CAAEgF,SAAS,EAAMC,SAAU,QAMjEf,oBAAqB,SAAS5e,GACzBvC,KAAKM,QAAQM,cACXoV,QAAQxE,OAAO,CAAEjP,KAAMA,EAAM8T,IAAKrW,KAAKwW,KAAMQ,aAAchX,KAAKme,cAAe7d,QAASN,KAAKM,eAC7FyV,uBAAyB/V,KAAKgW,QAAQD,yBAO7C6G,aAAc,WACR5c,KAAK2P,OAAU3P,KAAKqa,kBAEpBO,OAAS5a,KAAK4a,OAAOpJ,OAAO,CAAE5R,KAAMI,KAAK2P,aAEzC2B,GAAKtR,KAAK4a,OAAOtJ,QACjBC,GAAKvR,KAAK4a,OAAOrJ,QAEjBxP,SAAS,iBACV/B,KAAKM,QAAQmY,QAAQzY,KAAK+B,SAAS,wBAElCA,SAAS,sBAMf8a,eAAgB,2BACVkD,WAAW+B,UAAY,QACvBhgB,WAAa9B,KAAK8B,YAAc,QAChCA,WAAWud,SAAWrf,KAAKue,WAAa,OACxCzc,WAAWwd,cAAgBtf,KAAKme,eAAiB,OACjDrc,WAAWyd,cAAgBvf,KAAKqe,eAAiB,EAElDre,KAAKM,QAAQ8Y,cACXrX,SAAS,oBAEX/B,KAAKM,QAAQsX,cAAgB5X,KAAKic,oBAChC8D,WAAW+B,WAAa,sCAAwC3iB,EAAEgK,EAAE,YAAc,cACvFA,EAAS,cAAenJ,KAAK+f,YAAYoC,QAAU,SAAC/f,GACnDA,EAAE4R,iBACFoO,EAAKrgB,SAAS,oBAAqB,CAAE6V,aAAcwK,EAAK9hB,QAAQsX,aAAcyK,QAASlZ,EAAWiK,KAAKgP,EAAMA,EAAKnG,mBASrHlK,OAAQ,eACHrC,EAAO1P,KAAKM,eACToP,EAAKlE,MAAQkE,EAAK3B,QAAQ3K,KAAOsM,EAAK3B,QAAQ1K,SAQvDmW,EAAU9D,aAAY,gBAEhBvT,GAAG,kBAAkB,SAASC,OAC9BkgB,EAAIlgB,EAAEb,MACTghB,EAAMD,EAAEE,OACLD,IACHA,EAAIjiB,QAAQG,UAAY,mBAErB8hB,EAAIE,WACPF,EAAIE,SAAWC,UAAUH,EAAIE,UAC7BH,EAAEK,YAAYJ,EAAIE,SAAU,CAAEG,UAAW,MAAOC,QAAQ,EAAM/J,QAAS,EAAGrY,UAAW,sBAAuBqiB,uBAIzG3gB,GAAG,kBAAkB,SAASC,cAC9BuI,EAAOvI,EAAEuI,KAEToY,EAAU5Z,EAAWwB,EAAM,UAC3B8B,EAAOtD,EAAS,OAAQ/G,EAAEqW,QAE1BsK,GACH5Z,EAAcwB,EAAM,UACpBxB,EAAQsD,EAAM,uBAAwB,MAEtCtD,EAAWwB,EAAM,UACjBxB,EAAQsD,EAAM,uBAAwB,sBAGlC+O,cAA4E,GAA5Dxb,KAAKgR,MAAMrD,UAAU,qBAAqBqV,QAAQhlB,OAGlEgC,KAAKwb,cAKTrS,EAAOnJ,KAAK0f,SAAS,SAAArT,UAAKlD,EAAWkD,EAAE4E,MAAOgS,EAAK3iB,QAAQC,SAASE,UAAY,IAAMwiB,EAAK3iB,QAAQE,gBAJ9FgU,kBACAgG,sBAOFrY,GAAG,oBAAoB,SAASC,QAC/Bqa,2BACA3B,UAAU3b,EAAE+b,aAAa,CAAC9Y,EAAEwS,UAAUjU,OAAQyB,EAAEyS,QAAQlU,kBAGzDwB,GAAG,mBAAmB,gBACrB+gB,gBAAkBljB,KAAKqR,QAAQ1J,OAAO,KACzC6E,KACAsF,EAAc,CACb3Q,KAAM,WACNqK,MAAOxL,KAAK+R,SACZtH,OAAQzK,KAAKmS,UACbpE,QAAS/N,KAAKM,QAAQyN,mBAKrB5L,GAAG,oBAAoB,2BAEtBkP,QAAQ1D,UAAU,gBACrBxL,GAAG,SAAS,SAAC1C,EAAGuK,EAAGmZ,OACfrlB,EAASqlB,EAAEnZ,GACX7I,EAAOrD,EAAOslB,aAAa,aAC3BzY,EAAO0Y,EAAKrS,MAAM7I,OAAO,mBAAqBhH,EAAO,MAAMuM,OAC/D2V,EAAKthB,SAAS,iBAAkB,CAAE4I,KAAMA,EAAMxJ,KAAMA,EAAMsX,OAAQ3a,eAKhEqE,GAAG,oBAAoB,gBACtB4d,WAAW+B,WACf,mDAAqD3iB,EAAEgK,EAAE,kBAAoB,qCAAuCnJ,KAAK8B,WAAWud,SAASiE,QAAQ,GAAK,SAAWtjB,KAAK+P,QAAU,iEAC/H5Q,EAAEgK,EAAE,mBAAqB,qCAAuCnJ,KAAK8B,WAAWwd,cAAcgE,QAAQ,GAAK,SAAWtjB,KAAKgQ,QAAU,iEACrI7Q,EAAEgK,EAAE,mBAAqB,qCAAuCnJ,KAAK8B,WAAWyd,cAAc+D,QAAQ,GAAK,SAAWtjB,KAAKgQ,QAAU,yBAGvL7N,GAAG,qBAAqB,SAASC,GACf,SAAlBA,EAAEwV,cAAkD,mBAAhB2L,YACvC9kB,SAAS+kB,cAAc,IAAID,YAAY,oBAAqB,CAAEE,OAAQrhB,KAC1C,QAAlBA,EAAEwV,eAA6C,IAAnBxV,EAAEwV,cACxCxV,EAAEigB,kBAIClgB,GAAG,kBAAkB,SAASC,OAC9BnC,EAAQmC,EAAEnC,MACVD,KAAKwW,WACHA,KAAK3X,KAAK,YAAY,SAASuD,QAC9B0Y,UAAU7a,EAAM+a,eACnBhb,MACHC,EAAMmW,MAAMpW,KAAKwW,OAEjBvS,QAAQC,KAAK,0CAIV/B,GAAG,iBAAiB,gBACnB6O,MAAMrD,UAAU,QACnBvC,KAAK,IAAK,QACRpL,KAAKiR,YCj6BXuI,EAAU9D,aAAY,cAEhB1V,KAAKM,QAAQ+Y,WAEd3J,EAAO1P,KAAKM,QACZ+Y,EAAQ,GACZ3J,EAAK3B,QAAQ1K,MAAQ,GAEK,WAAtBrD,KAAKM,QAAQ+Y,aAEXlX,GAAG,iBAAiB,WACxBkX,EAAM1O,KAAO3K,KAAKgR,MAAMrJ,OAAO,QAC7BxH,MAAM,iBAAkB,QAExBiL,KAAK,OAAQ,QACbA,KAAK,SAAU,QACfA,KAAK,iBAAkB,OACvBA,KAAK,eAAgB,gBAGnBjJ,GAAG,iBAAiB,WACxBkX,EAAMtO,EAAI/K,KAAKsR,GAWf+H,EAAM5L,EAAIqE,EAAS,CAClBlS,KAAMI,KAAK2P,MACXf,MAAO,CAAC5O,KAAKmS,UAAW,GACxB/G,KAAM,QACN2B,KAAM,EACNE,IAAK,EACL0B,YAAae,EAAKwC,kBAGnBmH,EAAM5N,KAAOqG,EAAQ,CACpBrG,KAAM,IACN3D,SAAU,QACV0D,MAAOxL,KAAK+R,SACZtH,OAAQzK,KAAKmS,UACbzG,MAAO2N,EAAM5L,EACb9B,MAAO3L,KAAKM,QAAQgQ,OACpB/E,YAAa,GACbM,MAAO,IACPC,OAAQ,GACRC,OAAQ,SAGJmF,MAAM1E,KAAK6M,EAAM5N,cAGlBtJ,GAAG,oBAAoB,WAC3BkX,EAAMxO,KAAOiH,EAAQ,CACpBpH,cAAe,iBACf9K,KAAMI,KAAK2P,MACXxO,KAAM,QACNkJ,MAAOqF,EAAKrF,MACZC,MAAO,QACPkB,MAAOxL,KAAK+R,SACZtH,OAAQzK,KAAKmS,UACb5H,OAAQ8O,EAAMtO,EACdP,OAAQ6O,EAAM5L,IAGf4L,EAAM1O,KAAK6B,KAAK6M,EAAMxO,cAGlB1I,GAAG,mBAAmB,WAC1BkX,EAAMZ,OAASzY,KAAKqR,QAAQ1J,OAAO,KACjC6E,KACAsF,EAAc,CACb3Q,KAAM,QACNqK,MAAOxL,KAAK+R,SACZtH,OAAQzK,KAAKmS,UACbpE,QAAS/N,KAAKM,QAAQyN,gBAIpBmV,gBACH9X,KAAK,YAAa,qBAEpBiO,EAAMZ,OACJrN,KAAK,YAAa,oBAEpBiO,EAAMZ,OAAOtQ,OAAO,QAClBgN,QAAQ,QAAQ,GAEhB/J,KAAK,OAAQ,QACbA,KAAK,SAAU,QACfA,KAAK,iBAAkB,OACvBA,KAAK,eAAgB,iBAKpBjJ,GAAG,mBAAmB,SAASC,OAC/BxC,EAAOI,KAAK2P,MACZ3F,EAAI5H,EAAEod,MACNvI,EAAIrX,EAAKoK,GAAGiN,EAEZuH,EAAO5e,EAAKoK,GAAGrJ,OACf+d,EAAO1U,EAAI,EAAIpK,EAAKoK,EAAI,GAAGrJ,OAAS6d,EAEpCG,EAAQH,EAAKI,WAAWF,GAAQ1e,KAAKsb,gBAGrCoI,EAAO1jB,KAAK2jB,OAAS,EACrBC,EAAO5jB,KAAK6jB,OAAS,EACrBC,EAAO9jB,KAAK+jB,OAAS,EACrBC,EAAOhkB,KAAKikB,OAAS,EACrBC,EAAO,EACP7K,EAAQ,EAEP0F,MAAM9H,MAEViN,EAAOla,EAAI,EAAIiN,EAAIrX,EAAKoK,EAAI,GAAGiN,EAAI,GACxB,IAAGyM,GAAQQ,GAClBA,EAAO,IAAGN,GAAQM,GAEtB7K,EAAkB,IAAVsF,EAAchV,KAAKkV,MAAOqF,EAAOvF,EAAS,KAAS,IAAM,EAG7D3U,EAAI,IAAGpK,EAAKoK,EAAI,GAAGqP,MAAQA,GAC/ByK,EAAOzK,EAAQyK,EAAOzK,EAAQyK,EAC9BE,EAAO3K,EAAQ2K,EAAO3K,EAAQ2K,GAG/BpkB,EAAKoK,GAAGqP,MAAQA,OAEXvX,WAAa9B,KAAK8B,YAAc,QAChCA,WAAWqiB,OAASnkB,KAAK2jB,MAAQD,OACjC5hB,WAAWsiB,QAAUpkB,KAAK6jB,MAAQD,OAClC9hB,WAAWuiB,UAAYrkB,KAAK+jB,MAAQD,OACpChiB,WAAWwiB,UAAYtkB,KAAKikB,MAAQD,UAGrC7hB,GAAG,mBAAmB,SAASC,OAC/BG,EAAOH,EAAExC,KACKwC,EAAEkL,OAEhBtN,KAAK8T,cACH9T,KAAKukB,kBAAqBvkB,KAAKukB,iBAAiBC,SAAS,sBACxDD,iBAAmBvkB,KAAK8T,YAAY3L,OAAO,QAAQN,OAAO,YAAa,wBAC1EuD,KAAK,QAAS,2BACdA,KAAK,KAAM,eAGTmZ,iBAAiB9X,KAAKlK,EAAK8W,MAAQ,UAEnCvF,YAAY3L,OAAO,wBACtBiD,KAAK,KAAM,UAGVpL,KAAK+V,yBACH/V,KAAKykB,6BACJA,sBAAwBzkB,KAAK+V,uBAAuBpO,OAAO,aAC9DyD,KAAK,QAAS,6BAGZqZ,sBACHrZ,KAAK,KAAM,SACXqB,KAAK9C,KAAKkV,MAAMtc,EAAK8W,OAAS,UAE3BtD,uBAAuB5N,OAAO,mBACjCiD,KAAK,KAAM,mBAIVjJ,GAAG,oBAAoB,gBACtBL,WAAWqiB,OAASnkB,KAAK2jB,OAAS,OAClC7hB,WAAWsiB,QAAUpkB,KAAK6jB,OAAS,OACnC/hB,WAAWuiB,UAAYrkB,KAAK+jB,OAAS,OACrCjiB,WAAWwiB,UAAYtkB,KAAKikB,OAAS,OAErClE,WAAWzX,cAAc,WAAWoc,mBAAmB,WAAY,mDAAqDvlB,EAAEgK,EAAE,kBAAoB,qCAAuCQ,KAAKkV,MAAM7e,KAAK8B,WAAWqiB,QAAU,SAChOnkB,KAAKgQ,QACL,kEAAyE7Q,EAAEgK,EAAE,mBAAqB,qCAAuCQ,KAAKkV,MAAM7e,KAAK8B,WAAWsiB,SAAW,SAAWpkB,KAAKgQ,QAC/L,mEAA0E7Q,EAAEgK,EAAE,eAAiB,qCAAuCnJ,KAAK8B,WAAWwiB,UAAY,0EACxFnlB,EAAEgK,EAAE,eAAiB,qCAAuCnJ,KAAK8B,WAAWuiB,UAAY,iCAI/JliB,GAAG,iBAAiB,gBACnB4hB,MAAQ,UACRE,MAAQ,UACRN,MAAQ,UACRE,MAAQ,YC1JfrK,EAAUmL,MAAQxb,EAClBqQ,EAAUoL,WAAa9S,EACvB0H,EAAUtK,MAAQA,EAElB/P,EAAEU,QAAQglB,UAAY,SAACvkB,UAAY,IAAIkZ,EAAUlZ"}