{"version":3,"file":"leaflet-elevation.js","sources":["../node_modules/leaflet-i18n/Leaflet.i18n.js","../src/utils.js","../src/components.js","../src/chart.js","../src/marker.js","../src/summary.js","../src/options.js","../src/control.js","../src/altitude.js","../src/slope.js","../src/index.js"],"sourcesContent":["// Following https://github.com/Leaflet/Leaflet/blob/master/PLUGIN-GUIDE.md\n(function (factory, window) {\n\n    // define an AMD module that relies on 'leaflet'\n    if (typeof define === 'function' && define.amd) {\n        define(['leaflet'], factory);\n\n        // define a Common JS module that relies on 'leaflet'\n    } else if (typeof exports === 'object') {\n        module.exports = factory(require('leaflet'));\n    }\n\n    // attach your plugin to the global 'L' variable\n    if (typeof window !== 'undefined' && window.L) {\n        factory(window.L);\n\n    }\n}(function (L) {\n    L.locales = {};\n    L.locale = null;\n    L.registerLocale = function registerLocale(code, locale) {\n        L.locales[code] = L.Util.extend({}, L.locales[code], locale);\n    };\n    L.setLocale = function setLocale(code) {\n        L.locale = code;\n    };\n    return L.i18n = L._ = function translate(string, data) {\n        if (L.locale && L.locales[L.locale] && L.locales[L.locale][string]) {\n            string = L.locales[L.locale][string];\n        }\n        try {\n            // Do not fail if some data is missing\n            // a bad translation should not break the app\n            string = L.Util.template(string, data);\n        }\n        catch (err) {/*pass*/\n        }\n\n        return string;\n    };\n}, window));\n","/**\r\n * Recursive deep merge objects.\r\n * Alternative to L.Util.setOptions(this, options).\r\n */\r\nexport function deepMerge(target, ...sources) {\r\n\tif (!sources.length) return target;\r\n\tconst source = sources.shift();\r\n\tif (isObject(target) && isObject(source)) {\r\n\t\tfor (const key in source) {\r\n\t\t\tif (isObject(source[key])) {\r\n\t\t\t\tif (!target[key]) Object.assign(target, {\r\n\t\t\t\t\t[key]: {}\r\n\t\t\t\t});\r\n\t\t\t\tdeepMerge(target[key], source[key]);\r\n\t\t\t} else {\r\n\t\t\t\tObject.assign(target, {\r\n\t\t\t\t\t[key]: source[key]\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn deepMerge(target, ...sources);\r\n}\r\n\r\n/**\r\n * Wait for document load before execute function.\r\n */\r\nexport function deferFunc(f) {\r\n\tif (document.readyState !== 'complete') window.addEventListener(\"load\", f, { once: true });\r\n\telse f();\r\n}\r\n\r\n/*\r\n * Similar to L.Util.formatNum\r\n */\r\nexport function formatNum(num, dec, sep) {\r\n\treturn num.toFixed(dec).toString().split(\".\").join(sep || \".\");\r\n}\r\n\r\n/**\r\n * Simple GeoJSON data loader.\r\n */\r\nexport function GeoJSONLoader(data, control) {\r\n\tif (typeof data === \"string\") {\r\n\t\tdata = JSON.parse(data);\r\n\t}\r\n\tcontrol = control || this;\r\n\r\n\tlet layer = L.geoJson(data, {\r\n\t\tstyle: (feature) => {\r\n\t\t\tlet style = L.extend({}, control.options.polyline);\r\n\t\t\tif (control.options.theme) {\r\n\t\t\t\tstyle.className += ' ' + control.options.theme;\r\n\t\t\t}\r\n\t\t\treturn style;\r\n\t\t},\r\n\t\tpointToLayer: (feature, latlng) => {\r\n\t\t\tlet marker = L.marker(latlng, { icon: control.options.gpxOptions.marker_options.wptIcons[''] });\r\n\t\t\tlet desc = feature.properties.desc ? feature.properties.desc : '';\r\n\t\t\tlet name = feature.properties.name ? feature.properties.name : '';\r\n\t\t\tif (name || desc) {\r\n\t\t\t\tmarker.bindPopup(\"<b>\" + name + \"</b>\" + (desc.length > 0 ? '<br>' + desc : '')).openPopup();\r\n\t\t\t}\r\n\t\t\tcontrol.fire('waypoint_added', { point: marker, point_type: 'waypoint', element: latlng });\r\n\t\t\treturn marker;\r\n\t\t},\r\n\t\tonEachFeature: (feature, layer) => {\r\n\t\t\tif (feature.geometry.type == 'Point') return;\r\n\r\n\t\t\tcontrol.addData(feature, layer);\r\n\r\n\t\t\tcontrol.track_info = L.extend({}, control.track_info, { type: \"geojson\", name: data.name });\r\n\t\t},\r\n\t});\r\n\r\n\tL.Control.Elevation._d3LazyLoader.then(() => {\r\n\t\tcontrol._fireEvt(\"eledata_loaded\", { data: data, layer: layer, name: control.track_info.name, track_info: control.track_info })\r\n\t});\r\n\r\n\treturn layer;\r\n}\r\n\r\n/**\r\n * Simple GPX data loader.\r\n */\r\nexport function GPXLoader(data, control) {\r\n\tcontrol = control || this;\r\n\r\n\tcontrol.options.gpxOptions.polyline_options = L.extend({}, control.options.polyline, control.options.gpxOptions.polyline_options);\r\n\r\n\tif (control.options.theme) {\r\n\t\tcontrol.options.gpxOptions.polyline_options.className += ' ' + control.options.theme;\r\n\t}\r\n\r\n\tlet layer = new L.GPX(data, control.options.gpxOptions);\r\n\r\n\t// similar to L.GeoJSON.pointToLayer\r\n\tlayer.on('addpoint', (e) => {\r\n\t\tcontrol.fire(\"waypoint_added\", e);\r\n\t});\r\n\r\n\t// similar to L.GeoJSON.onEachFeature\r\n\tlayer.on(\"addline\", (e) => {\r\n\t\tcontrol.addData(e.line /*, layer*/ );\r\n\t\tcontrol.track_info = L.extend({}, control.track_info, { type: \"gpx\", name: layer.get_name() });\r\n\t});\r\n\r\n\t// unlike the L.GeoJSON, L.GPX parsing is async\r\n\tlayer.once('loaded', (e) => {\r\n\t\tL.Control.Elevation._d3LazyLoader.then(() => {\r\n\t\t\tcontrol._fireEvt(\"eledata_loaded\", { data: data, layer: layer, name: control.track_info.name, track_info: control.track_info });\r\n\t\t});\r\n\t});\r\n\r\n\treturn layer;\r\n}\r\n\r\n/**\r\n * Check DOM element visibility.\r\n */\r\nexport function isDomVisible(elem) {\r\n\treturn !!(elem.offsetWidth || elem.offsetHeight || elem.getClientRects().length);\r\n}\r\n\r\n/**\r\n * Check object type.\r\n */\r\nexport function isObject(item) {\r\n\treturn (item && typeof item === 'object' && !Array.isArray(item));\r\n}\r\n\r\n/**\r\n * Check DOM element viewport visibility.\r\n */\r\nexport function isVisible(elem) {\r\n\tif (!elem) return false;\r\n\r\n\tlet styles = window.getComputedStyle(elem);\r\n\r\n\tfunction isVisibleByStyles(elem, styles) {\r\n\t\treturn styles.visibility !== 'hidden' && styles.display !== 'none';\r\n\t}\r\n\r\n\tfunction isAboveOtherElements(elem, styles) {\r\n\t\tlet boundingRect = elem.getBoundingClientRect();\r\n\t\tlet left = boundingRect.left + 1;\r\n\t\tlet right = boundingRect.right - 1;\r\n\t\tlet top = boundingRect.top + 1;\r\n\t\tlet bottom = boundingRect.bottom - 1;\r\n\t\tlet above = true;\r\n\r\n\t\tlet pointerEvents = elem.style.pointerEvents;\r\n\r\n\t\tif (styles['pointer-events'] == 'none') elem.style.pointerEvents = 'auto';\r\n\r\n\t\tif (document.elementFromPoint(left, top) !== elem) above = false;\r\n\t\tif (document.elementFromPoint(right, top) !== elem) above = false;\r\n\r\n\t\t// Only for completely visible elements\r\n\t\t// if (document.elementFromPoint(left, bottom) !== elem) above = false;\r\n\t\t// if (document.elementFromPoint(right, bottom) !== elem) above = false;\r\n\r\n\t\telem.style.pointerEvents = pointerEvents;\r\n\r\n\t\treturn above;\r\n\t}\r\n\r\n\tif (!isVisibleByStyles(elem, styles)) return false;\r\n\tif (!isAboveOtherElements(elem, styles)) return false;\r\n\treturn true;\r\n}\r\n\r\n/**\r\n * Check JSON object type.\r\n */\r\nexport function isJSONDoc(doc, lazy) {\r\n\tlazy = typeof lazy === \"undefined\" ? true : lazy;\r\n\tif (typeof doc === \"string\" && lazy) {\r\n\t\tdoc = doc.trim();\r\n\t\treturn doc.indexOf(\"{\") == 0 || doc.indexOf(\"[\") == 0;\r\n\t} else {\r\n\t\ttry {\r\n\t\t\tJSON.parse(doc.toString());\r\n\t\t} catch (e) {\r\n\t\t\tif (typeof doc === \"object\" && lazy) return true;\r\n\t\t\tconsole.warn(e);\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n}\r\n\r\n/**\r\n * Check XML object type.\r\n */\r\nexport function isXMLDoc(doc, lazy) {\r\n\tlazy = typeof lazy === \"undefined\" ? true : lazy;\r\n\tif (typeof doc === \"string\" && lazy) {\r\n\t\tdoc = doc.trim();\r\n\t\treturn doc.indexOf(\"<\") == 0;\r\n\t} else {\r\n\t\tlet documentElement = (doc ? doc.ownerDocument || doc : 0).documentElement;\r\n\t\treturn documentElement ? documentElement.nodeName !== \"HTML\" : false;\r\n\t}\r\n}\r\n\r\n/**\r\n * Async JS script download.\r\n */\r\nexport function lazyLoader(url, skip, loader) {\r\n\tif (skip === false) {\r\n\t\treturn Promise.resolve();\r\n\t}\r\n\tif (loader instanceof Promise) {\r\n\t\treturn loader;\r\n\t}\r\n\treturn new Promise((resolve, reject) => {\r\n\t\tlet tag = document.createElement(\"script\");\r\n\t\ttag.addEventListener('load', resolve, { once: true });\r\n\t\ttag.src = url;\r\n\t\tdocument.head.appendChild(tag);\r\n\t});\r\n}\r\n\r\n/**\r\n * Download data from a remote url.\r\n */\r\nexport function loadFile(url, success) {\r\n\treturn new Promise((resolve, reject) => {\r\n\t\tlet xhr = new XMLHttpRequest();\r\n\t\txhr.responseType = \"text\";\r\n\t\txhr.open('GET', url);\r\n\t\txhr.onload = () => resolve(xhr.response);\r\n\t\txhr.onerror = () => reject(\"Error \" + xhr.status + \" while fetching remote file: \" + url);\r\n\t\txhr.send();\r\n\t});\r\n}\r\n\r\n/**\r\n * Generate download data event.\r\n */\r\nexport function saveFile(dataURI, fileName) {\r\n\tlet a = create('a', '', { href: dataURI, target: '_new', download: fileName || \"\", style: \"display:none;\" });\r\n\tlet b = document.body;\r\n\tb.appendChild(a);\r\n\ta.click();\r\n\tb.removeChild(a);\r\n}\r\n\r\n/**\r\n * Wait for element visible before execute function.\r\n */\r\nexport function waitHolder(elem) {\r\n\treturn new Promise((resolve, reject) => {\r\n\t\tlet ticking = false;\r\n\t\tlet scrollFn = () => {\r\n\t\t\tif (!ticking) {\r\n\t\t\t\tL.Util.requestAnimFrame(() => {\r\n\t\t\t\t\tif (isVisible(elem)) {\r\n\t\t\t\t\t\twindow.removeEventListener('scroll', scrollFn);\r\n\t\t\t\t\t\tresolve();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tticking = false;\r\n\t\t\t\t});\r\n\t\t\t\tticking = true;\r\n\t\t\t}\r\n\t\t};\r\n\t\twindow.addEventListener('scroll', scrollFn);\r\n\t\tif (elem) elem.addEventListener('mouseenter', scrollFn, { once: true });\r\n\t\tscrollFn();\r\n\t});\r\n}\r\n\r\n/**\r\n * A little bit safier than L.DomUtil.addClass\r\n */\r\nexport function addClass(targetNode, className) {\r\n\teach(className.split(\" \"), s => { if (targetNode && className) L.DomUtil.addClass(targetNode, s); });\r\n}\r\n\r\n/**\r\n * A little bit safier than L.DomUtil.removeClass()\r\n */\r\nexport function removeClass(targetNode, className) {\r\n\teach(className.split(\" \"), s => { if (targetNode && className) L.DomUtil.removeClass(targetNode, s); });\r\n}\r\n\r\nexport function toggleClass(targetNode, className, conditional) {\r\n\treturn (conditional ? addClass : removeClass).call(null, targetNode, className)\r\n}\r\n\r\nexport function style(targetNode, name, value) {\r\n\tif (typeof value === \"undefined\") return L.DomUtil.getStyle(targetNode, name);\r\n\telse return targetNode.style.setProperty(name, value);\r\n}\r\n\r\n/**\r\n * A little bit shorter than L.DomUtil.create()\r\n */\r\nexport function create(tagName, className, attributes, parent) {\r\n\tlet elem = L.DomUtil.create(tagName, className || \"\");\r\n\tif (attributes) setAttributes(elem, attributes);\r\n\tif (parent) append(parent, elem);\r\n\treturn elem;\r\n}\r\n\r\n/**\r\n * Same as node.appendChild()\r\n */\r\nexport function append(parent, child) {\r\n\treturn parent.appendChild(child);\r\n}\r\n\r\n/**\r\n * Same as node.insertAdjacentElement()\r\n */\r\nexport function insert(parent, child, position) {\r\n\treturn parent.insertAdjacentElement(position, child);\r\n}\r\n\r\n/**\r\n * Loop for node.setAttribute()\r\n */\r\nexport function setAttributes(elem, attrs) {\r\n\tfor (let k in attrs) { elem.setAttribute(k, attrs[k]); }\r\n}\r\n\r\n/**\r\n * Same as node.querySelector().\r\n */\r\nexport function select(selector, context) {\r\n\treturn (context || document).querySelector(selector);\r\n}\r\n\r\n/**\r\n * Alias for L.DomEvent.on.\r\n */\r\nexport const on = L.DomEvent.on;\r\n\r\n/**\r\n * Alias for L.DomEvent.off.\r\n */\r\nexport const off = L.DomEvent.off;\r\n\r\n/**\r\n * Alias for L.DomUtil.hasClass.\r\n */\r\nexport const hasClass = L.DomUtil.hasClass;\r\n\r\n\r\nexport function randomId() {\r\n\treturn Math.random().toString(36).substr(2, 9);\r\n}\r\n\r\nexport function each(obj, fn) {\r\n\tfor (let i in obj) fn(obj[i], i);\r\n}\r\n","export const Area = ({\r\n\tdata,\r\n\tname,\r\n\txAttr,\r\n\tyAttr,\r\n\tscaleX,\r\n\tscaleY,\r\n\theight,\r\n\tinterpolation = \"curveLinear\",\r\n}) => {\r\n\treturn path => {\r\n\t\tif (typeof interpolation === 'string') interpolation = d3[interpolation];\r\n\r\n\t\tlet area = d3.area().curve(interpolation)\r\n\t\t\t.x(d => (d.xDiagCoord = scaleX(d[xAttr])))\r\n\t\t\t.y0(height)\r\n\t\t\t.y1(d => scaleY(d[yAttr]));\r\n\r\n\t\tif (data) path.datum(data).attr(\"d\", area);\r\n\t\tif (name) path.attr('data-name', name);\r\n\r\n\t\treturn area;\r\n\t};\r\n};\r\n\r\nexport const AreaPath = (props) => {\r\n\treturn d3.create('svg:path')\r\n\t\t.attr(\"class\", \"area\")\r\n\t\t.call(Area(props));\r\n};\r\n\r\nexport const Axis = ({\r\n\ttype = \"axis\",\r\n\ttickSize = 6,\r\n\ttickPadding = 3,\r\n\tposition,\r\n\theight,\r\n\twidth,\r\n\taxis,\r\n\tscale,\r\n\tticks,\r\n\ttickFormat,\r\n\tlabel,\r\n\tlabelX,\r\n\tlabelY\r\n}) => {\r\n\treturn g => {\r\n\t\tlet [w, h] = [0, 0];\r\n\t\tif (position == \"bottom\") h = height;\r\n\t\tif (position == \"right\") w = width;\r\n\r\n\t\tif (axis == \"x\" && type == \"grid\") {\r\n\t\t\ttickSize = -height;\r\n\t\t} else if (axis == \"y\" && type == \"grid\") {\r\n\t\t\ttickSize = -width;\r\n\t\t}\r\n\r\n\t\tlet axisScale = d3[\"axis\" + position.replace(/\\b\\w/g, l => l.toUpperCase())]()\r\n\t\t\t.scale(scale)\r\n\t\t\t.ticks(ticks)\r\n\t\t\t.tickPadding(tickPadding)\r\n\t\t\t.tickSize(tickSize)\r\n\t\t\t.tickFormat(tickFormat);\r\n\r\n\t\tlet axisGroup = g.append(\"g\")\r\n\t\t\t.attr(\"class\", [axis, type, position].join(\" \"))\r\n\t\t\t.attr(\"transform\", \"translate(\" + w + \",\" + h + \")\")\r\n\t\t\t.call(axisScale);\r\n\r\n\t\tif (label) {\r\n\t\t\taxisGroup.append(\"text\")\r\n\t\t\t\t.attr(\"x\", labelX)\r\n\t\t\t\t.attr(\"y\", labelY)\r\n\t\t\t\t.text(label);\r\n\t\t}\r\n\r\n\t\treturn axisGroup;\r\n\t};\r\n};\r\n\r\nexport const DragRectangle = ({\r\n\tdragStartCoords,\r\n\tdragEndCoords,\r\n\theight,\r\n}) => {\r\n\treturn rect => {\r\n\t\tlet x1 = Math.min(dragStartCoords[0], dragEndCoords[0]);\r\n\t\tlet x2 = Math.max(dragStartCoords[0], dragEndCoords[0]);\r\n\r\n\t\treturn rect\r\n\t\t\t.attr(\"width\", x2 - x1)\r\n\t\t\t.attr(\"height\", height)\r\n\t\t\t.attr(\"x\", x1);\r\n\t};\r\n};\r\n\r\nexport const FocusRect = ({\r\n\twidth,\r\n\theight,\r\n}) => {\r\n\treturn rect => rect\r\n\t\t.attr(\"width\", width)\r\n\t\t.attr(\"height\", height)\r\n\t\t.style(\"fill\", \"none\")\r\n\t\t.style(\"stroke\", \"none\")\r\n\t\t.style(\"pointer-events\", \"all\");\r\n};\r\n\r\nexport const Grid = (props) => {\r\n\tprops.type = \"grid\";\r\n\treturn Axis(props);\r\n};\r\n\r\nexport const HeightFocusLine = ({\r\n\ttheme,\r\n\txCoord = 0,\r\n\tyCoord = 0,\r\n\tlength = 0,\r\n}) => {\r\n\treturn line => line\r\n\t\t.attr(\"class\", theme + \" height-focus line\")\r\n\t\t.attr(\"x1\", xCoord)\r\n\t\t.attr(\"x2\", xCoord)\r\n\t\t.attr(\"y1\", yCoord)\r\n\t\t.attr(\"y2\", length);\r\n};\r\n\r\nexport const HeightFocusLabel = ({\r\n\ttheme,\r\n\txCoord = 0,\r\n\tyCoord = 0,\r\n\tlabel,\r\n}) => {\r\n\treturn text => {\r\n\t\ttext\r\n\t\t\t.attr(\"class\", theme + \" height-focus-label\")\r\n\t\t\t.style(\"pointer-events\", \"none\")\r\n\t\t\t.attr(\"x\", xCoord + 5)\r\n\t\t\t.attr(\"y\", yCoord);\r\n\r\n\t\tlet y = text.select(\".height-focus-y\");\r\n\t\tif (!y.node()) y = text.append(\"svg:tspan\");\r\n\r\n\t\ty\r\n\t\t\t.attr(\"class\", \"height-focus-y\")\r\n\t\t\t.text(label);\r\n\r\n\t\ttext.selectAll('tspan').attr(\"x\", xCoord + 5);\r\n\r\n\t\treturn text;\r\n\t};\r\n};\r\n\r\nexport const HeightFocusMarker = ({\r\n\ttheme,\r\n\txCoord = 0,\r\n\tyCoord = 0,\r\n}) => {\r\n\treturn circle => circle\r\n\t\t.attr(\"class\", theme + \" height-focus circle-lower\")\r\n\t\t.attr(\"transform\", \"translate(\" + xCoord + \",\" + yCoord + \")\")\r\n\t\t.attr(\"r\", 6)\r\n\t\t.attr(\"cx\", 0)\r\n\t\t.attr(\"cy\", 0);\r\n};\r\n\r\n\r\nexport const LegendItem = ({\r\n\tname,\r\n\twidth,\r\n\theight,\r\n\tmargins = {},\r\n}) => {\r\n\treturn g => {\r\n\t\tg\r\n\t\t\t.attr(\"class\", \"legend-item legend-\" + name.toLowerCase())\r\n\t\t\t.attr(\"data-name\", name);\r\n\r\n\t\tg.append(\"rect\")\r\n\t\t\t.attr(\"class\", \"area\")\r\n\t\t\t.attr(\"x\", (width / 2) - 50)\r\n\t\t\t.attr(\"y\", height + margins.bottom / 2)\r\n\t\t\t.attr(\"width\", 50)\r\n\t\t\t.attr(\"height\", 10)\r\n\t\t\t.attr(\"opacity\", 0.75);\r\n\r\n\t\tg.append('text')\r\n\t\t\t.text(L._(name))\r\n\t\t\t.attr(\"x\", (width / 2) + 5)\r\n\t\t\t.attr(\"font-size\", 10)\r\n\t\t\t.style(\"text-decoration-thickness\", \"2px\")\r\n\t\t\t.style(\"font-weight\", \"700\")\r\n\t\t\t.attr('y', height + margins.bottom / 2)\r\n\t\t\t.attr('dy', \"0.75em\");\r\n\r\n\t\treturn g;\r\n\t}\r\n};\r\n\r\nexport const MouseFocusLine = ({\r\n\txCoord = 0,\r\n\theight,\r\n}) => {\r\n\treturn line => line\r\n\t\t.attr('class', 'mouse-focus-line')\r\n\t\t.attr('x2', xCoord)\r\n\t\t.attr('y2', 0)\r\n\t\t.attr('x1', xCoord)\r\n\t\t.attr('y1', height);\r\n};\r\n\r\nexport const MouseFocusLabel = ({\r\n\txCoord,\r\n\tyCoord,\r\n\tlabelX = \"\",\r\n\tlabelY = \"\",\r\n\twidth,\r\n}) => {\r\n\treturn g => {\r\n\r\n\t\tg.attr('class', 'mouse-focus-label');\r\n\r\n\t\tlet rect = g.select(\".mouse-focus-label-rect\");\r\n\t\tlet text = g.select(\".mouse-focus-label-text\");\r\n\t\tlet y = text.select(\".mouse-focus-label-y\");\r\n\t\tlet x = text.select(\".mouse-focus-label-x\");\r\n\r\n\t\tif (!rect.node()) rect = g.append(\"rect\");\r\n\t\tif (!text.node()) text = g.append(\"svg:text\");\r\n\t\tif (!y.node()) y = text.append(\"svg:tspan\");\r\n\t\tif (!x.node()) x = text.append(\"svg:tspan\");\r\n\r\n\t\ty.text(labelY);\r\n\t\tx.text(labelX);\r\n\r\n\t\t// Sets focus-label-text position to the left / right of the mouse-focus-line\r\n\t\tlet xAlign = 0;\r\n\t\tlet yAlign = 0;\r\n\t\tlet bbox = { width: 0, height: 0 };\r\n\t\ttry { bbox = text.node().getBBox(); } catch (e) { return g; }\r\n\r\n\t\tif (xCoord) xAlign = xCoord + (xCoord < width / 2 ? 10 : -bbox.width - 10);\r\n\t\tif (yCoord) yAlign = Math.max(yCoord - bbox.height, L.Browser.webkit ? 0 : -Infinity);\r\n\r\n\t\trect\r\n\t\t\t.attr(\"class\", \"mouse-focus-label-rect\")\r\n\t\t\t.attr(\"x\", xAlign - 5)\r\n\t\t\t.attr(\"y\", yAlign - 5)\r\n\t\t\t.attr(\"width\", bbox.width + 10)\r\n\t\t\t.attr(\"height\", bbox.height + 10)\r\n\t\t\t.attr(\"rx\", 3)\r\n\t\t\t.attr(\"ry\", 3);\r\n\t\ttext\r\n\t\t\t.attr(\"class\", \"mouse-focus-label-text\")\r\n\t\t\t.style(\"font-weight\", \"700\")\r\n\t\t\t.attr(\"y\", yAlign);\r\n\t\ty\r\n\t\t\t.attr(\"class\", \"mouse-focus-label-y\")\r\n\t\t\t.attr(\"dy\", \"1em\");\r\n\t\tx\r\n\t\t\t.attr(\"class\", \"mouse-focus-label-x\")\r\n\t\t\t.attr(\"dy\", \"2em\");\r\n\r\n\t\ttext.selectAll('tspan').attr(\"x\", xAlign);\r\n\r\n\t\treturn g;\r\n\t};\r\n};\r\n\r\nexport const Scale = ({\r\n\tdata,\r\n\tattr,\r\n\tmin,\r\n\tforceBounds,\r\n\trange,\r\n}) => {\r\n\tlet domain = data ? d3.extent(data, d => d[attr]) : [0, 1];\r\n\tif (typeof min !== \"undefined\" && (min < domain[0] || forceBounds)) {\r\n\t\tdomain[0] = min;\r\n\t}\r\n\tif (typeof max !== \"undefined\" && (max > domain[1] || forceBounds)) {\r\n\t\tdomain[1] = max;\r\n\t}\r\n\treturn d3.scaleLinear()\r\n\t\t.range(range)\r\n\t\t.domain(domain);\r\n};\r\n\r\nexport const Bisect = ({\r\n\tdata = [0, 1],\r\n\tscale,\r\n\tx,\r\n\tattr\r\n}) => {\r\n\treturn d3\r\n\t\t.bisector(d => d[attr])\r\n\t\t.left(data, scale.invert(x));\r\n};\r\n","import 'leaflet-i18n';\r\nimport * as _ from './utils';\r\nimport * as D3 from './components';\r\n\r\nexport var Chart = L.Class.extend({\r\n\r\n\tincludes: L.Evented ? L.Evented.prototype : L.Mixin.Events,\r\n\r\n\tinitialize: function(opts) {\r\n\t\tthis.options = opts;\r\n\r\n\t\tthis._data = [];\r\n\t\tthis._draggingEnabled = opts.dragging;\r\n\r\n\t\tif (opts.imperial) {\r\n\t\t\tthis._xLabel = \"mi\";\r\n\t\t\tthis._yLabel = \"ft\";\r\n\t\t} else {\r\n\t\t\tthis._xLabel = opts.xLabel;\r\n\t\t\tthis._yLabel = opts.yLabel;\r\n\t\t}\r\n\r\n\t\tthis._xTicks = opts.xTicks;\r\n\t\tthis._yTicks = opts.yTicks;\r\n\r\n\t\tlet scale = this._updateScale();\r\n\r\n\t\tlet svg = this._container = d3.create(\"svg\")\r\n\t\t\t.attr(\"class\", \"background\")\r\n\t\t\t.attr(\"width\", opts.width)\r\n\t\t\t.attr(\"height\", opts.height);\r\n\r\n\t\tlet g = svg\r\n\t\t\t.append(\"g\")\r\n\t\t\t.attr(\"transform\", \"translate(\" + opts.margins.left + \",\" + opts.margins.top + \")\")\r\n\t\t\t.call(this._appendGrid())\r\n\t\t\t.call(this._appendAxis())\r\n\t\t\t.call(this._appendAreaPath())\r\n\t\t\t.call(this._appendFocusable())\r\n\t\t\t.call(this._appendLegend());\r\n\r\n\t\tthis._grid = svg.select('.grid');\r\n\t\tthis._area = svg.select('.area');\r\n\t\tthis._path = svg.select('.area path');\r\n\t\tthis._axis = svg.select('.axis');\r\n\t\tthis._focus = svg.select('.focus');\r\n\t\tthis._focusRect = this._focus.select('rect');\r\n\t\tthis._legend = svg.select('.legend');\r\n\t\tthis._x = scale.x;\r\n\t\tthis._y = scale.y;\r\n\r\n\t},\r\n\r\n\tupdate: function(props) {\r\n\t\tif (props.data) this._data = props.data;\r\n\t\tif (props.options) this.options = props.options;\r\n\r\n\t\tthis._updateScale();\r\n\t\tthis._updateAxis();\r\n\t\tthis._updateAreaPath();\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\trender: function() {\r\n\t\treturn container => container.append(() => this._container.node());\r\n\t},\r\n\r\n\tclear: function() {\r\n\t\tthis._resetDrag();\r\n\t\tthis._area.selectAll('path').attr(\"d\", \"M0 0\");\r\n\t\tif (this._path) {\r\n\t\t\t// this._x.domain([0, 1]);\r\n\t\t\t// this._y.domain([0, 1]);\r\n\t\t\t// this._updateAxis();\r\n\t\t}\r\n\t},\r\n\r\n\t_updateScale: function() {\r\n\t\tlet opts = this.options;\r\n\r\n\t\tthis._x = D3.Scale({\r\n\t\t\tdata: this._data,\r\n\t\t\trange: [0, this._width()],\r\n\t\t\tattr: opts.xAttr,\r\n\t\t\tmin: opts.xAxisMin,\r\n\t\t\tmax: opts.xAxisMax,\r\n\t\t\tforceBounds: opts.forceAxisBounds,\r\n\t\t});\r\n\r\n\t\tthis._y = D3.Scale({\r\n\t\t\tdata: this._data,\r\n\t\t\trange: [this._height(), 0],\r\n\t\t\tattr: opts.yAttr,\r\n\t\t\tmin: opts.yAxisMin,\r\n\t\t\tmax: opts.yAxisMax,\r\n\t\t\tforceBounds: opts.forceAxisBounds,\r\n\t\t});\r\n\r\n\t\treturn { x: this._x, y: this._y };\r\n\t},\r\n\r\n\t/**\r\n\t * Update chart axis.\r\n\t */\r\n\t_updateAxis: function() {\r\n\t\tthis._grid.selectAll('g').remove();\r\n\t\tthis._axis.selectAll('g').remove();\r\n\t\tthis._grid\r\n\t\t\t.call(this._appendXGrid())\r\n\t\t\t.call(this._appendYGrid());\r\n\t\tthis._axis\r\n\t\t\t.call(this._appendXaxis())\r\n\t\t\t.call(this._appendYaxis());\r\n\r\n\t\t// this.fire('axis_updated');\r\n\t},\r\n\r\n\t_updateAreaPath: function() {\r\n\t\tlet opts = this.options;\r\n\t\tthis._path\r\n\t\t\t.call(\r\n\t\t\t\tD3.Area({\r\n\t\t\t\t\tinterpolation: opts.interpolation,\r\n\t\t\t\t\tdata: this._data,\r\n\t\t\t\t\tname: 'Altitude',\r\n\t\t\t\t\txAttr: opts.xAttr,\r\n\t\t\t\t\tyAttr: opts.yAttr,\r\n\t\t\t\t\twidth: this._width(),\r\n\t\t\t\t\theight: this._height(),\r\n\t\t\t\t\tscaleX: this._x,\r\n\t\t\t\t\tscaleY: this._y,\r\n\t\t\t\t})\r\n\t\t\t);\r\n\t},\r\n\r\n\t/**\r\n\t * Generate \"grid\".\r\n\t */\r\n\t_appendGrid: function() {\r\n\t\treturn g =>\r\n\t\t\tg.append(\"g\")\r\n\t\t\t.attr(\"class\", \"grid\")\r\n\t\t\t.call(this._appendXGrid())\r\n\t\t\t.call(this._appendYGrid());\r\n\t},\r\n\r\n\t/**\r\n\t * Generate \"x-grid\".\r\n\t */\r\n\t_appendXGrid: function() {\r\n\t\treturn D3.Grid({\r\n\t\t\taxis: \"x\",\r\n\t\t\tposition: \"bottom\",\r\n\t\t\twidth: this._width(),\r\n\t\t\theight: this._height(),\r\n\t\t\tscale: this._x,\r\n\t\t\tticks: this._xTicks,\r\n\t\t\ttickFormat: \"\",\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Generate \"y-grid\".\r\n\t */\r\n\t_appendYGrid: function() {\r\n\t\treturn D3.Grid({\r\n\t\t\taxis: \"y\",\r\n\t\t\tposition: \"left\",\r\n\t\t\twidth: this._width(),\r\n\t\t\theight: this._height(),\r\n\t\t\tscale: this._y,\r\n\t\t\tticks: this.options.yTicks,\r\n\t\t\ttickFormat: \"\",\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Generate \"axis\".\r\n\t */\r\n\t_appendAxis: function() {\r\n\t\treturn g =>\r\n\t\t\tg.append(\"g\")\r\n\t\t\t.attr(\"class\", \"axis\")\r\n\t\t\t.call(this._appendXaxis())\r\n\t\t\t.call(this._appendYaxis());\r\n\t},\r\n\r\n\t/**\r\n\t * Generate \"x-axis\".\r\n\t */\r\n\t_appendXaxis: function() {\r\n\t\treturn D3.Axis({\r\n\t\t\taxis: \"x\",\r\n\t\t\tposition: \"bottom\",\r\n\t\t\twidth: this._width(),\r\n\t\t\theight: this._height(),\r\n\t\t\tscale: this._x,\r\n\t\t\tticks: this._xTicks,\r\n\t\t\tlabel: this._xLabel,\r\n\t\t\tlabelY: 25,\r\n\t\t\tlabelX: this._width() + 6,\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Generate \"y-axis\".\r\n\t */\r\n\t_appendYaxis: function() {\r\n\t\treturn D3.Axis({\r\n\t\t\taxis: \"y\",\r\n\t\t\tposition: \"left\",\r\n\t\t\twidth: this._width(),\r\n\t\t\theight: this._height(),\r\n\t\t\tscale: this._y,\r\n\t\t\tticks: this.options.yTicks,\r\n\t\t\tlabel: this._yLabel,\r\n\t\t\tlabelX: -25,\r\n\t\t\tlabelY: 3,\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Generate \"path\".\r\n\t */\r\n\t_appendAreaPath: function() {\r\n\t\treturn g => g.append('g')\r\n\t\t\t.attr(\"class\", \"area\")\r\n\t\t\t.append('path');\r\n\t},\r\n\r\n\t_appendFocusable: function() {\r\n\t\treturn g => {\r\n\t\t\treturn g.append('g')\r\n\t\t\t\t.attr(\"class\", 'focus')\r\n\t\t\t\t.call(this._appendFocusRect())\r\n\t\t\t\t.call(this._appendMouseFocusG());\r\n\t\t};\r\n\t},\r\n\r\n\t/**\r\n\t * Generate \"mouse-focus\" and \"drag-rect\".\r\n\t */\r\n\t_appendFocusRect: function() {\r\n\t\treturn g => {\r\n\t\t\tlet focusRect = g.append(\"rect\")\r\n\t\t\t\t.call(\r\n\t\t\t\t\tD3.FocusRect({\r\n\t\t\t\t\t\twidth: this._width(),\r\n\t\t\t\t\t\theight: this._height()\r\n\t\t\t\t\t})\r\n\t\t\t\t);\r\n\r\n\t\t\tif (L.Browser.mobile) {\r\n\t\t\t\tfocusRect\r\n\t\t\t\t\t.on(\"touchstart.drag\", this._dragStartHandler.bind(this))\r\n\t\t\t\t\t.on(\"touchmove.drag\", this._dragHandler.bind(this))\r\n\t\t\t\t\t.on(\"touchstart.focus\", this._mousemoveHandler.bind(this))\r\n\t\t\t\t\t.on(\"touchmove.focus\", this._mousemoveHandler.bind(this));\r\n\t\t\t\tL.DomEvent.on(this._container.node(), 'touchend', this._dragEndHandler, this);\r\n\t\t\t}\r\n\r\n\t\t\tfocusRect\r\n\t\t\t\t.on(\"mousedown.drag\", this._dragStartHandler.bind(this))\r\n\t\t\t\t.on(\"mousemove.drag\", this._dragHandler.bind(this))\r\n\t\t\t\t.on(\"mouseenter.focus\", this._mouseenterHandler.bind(this))\r\n\t\t\t\t.on(\"mousemove.focus\", this._mousemoveHandler.bind(this))\r\n\t\t\t\t.on(\"mouseout.focus\", this._mouseoutHandler.bind(this));\r\n\t\t\tL.DomEvent.on(this._container.node(), 'mouseup', this._dragEndHandler, this);\r\n\r\n\t\t\treturn focusRect;\r\n\t\t};\r\n\t},\r\n\r\n\t/**\r\n\t * Generate \"mouse-focus\".\r\n\t */\r\n\t_appendMouseFocusG: function() {\r\n\t\treturn g => {\r\n\t\t\tlet focusG = this._focusG = g.append(\"g\")\r\n\t\t\t\t.attr(\"class\", \"mouse-focus-group hidden\");\r\n\r\n\t\t\tthis._focusline = focusG.append('svg:line')\r\n\t\t\t\t.call(\r\n\t\t\t\t\tD3.MouseFocusLine({\r\n\t\t\t\t\t\txCoord: 0,\r\n\t\t\t\t\t\theight: this._height()\r\n\t\t\t\t\t})\r\n\t\t\t\t);;\r\n\t\t\tthis._focuslabel = focusG.append(\"g\")\r\n\t\t\t\t.call(\r\n\t\t\t\t\tD3.MouseFocusLabel({\r\n\t\t\t\t\t\txCoord: 0,\r\n\t\t\t\t\t\tyCoord: 0,\r\n\t\t\t\t\t\theight: this._height(),\r\n\t\t\t\t\t\twidth: this._width(),\r\n\t\t\t\t\t\tlabelX: \"\",\r\n\t\t\t\t\t\tlabelY: \"\",\r\n\t\t\t\t\t})\r\n\t\t\t\t);\r\n\t\t\treturn focusG;\r\n\t\t};\r\n\t},\r\n\r\n\t/**\r\n\t * Generate \"legend\".\r\n\t */\r\n\t_appendLegend: function() {\r\n\t\treturn g => {\r\n\t\t\t// if (!this.options.legend) return;\r\n\r\n\t\t\tlet legend = g.append('g')\r\n\t\t\t\t.attr(\"class\", \"legend\");\r\n\r\n\t\t\t// this.fire(\"legend\");\r\n\r\n\t\t\t// let items = legend.selectAll('.legend-item')\r\n\t\t\t// \t.on('click', (d, i) => {\r\n\t\t\t// \t\tlet target = items.nodes()[i];\r\n\t\t\t// \t\tlet name = target.getAttribute('data-name');\r\n\t\t\t// \t\tlet path = this._area.select('path[data-name=\"' + name + '\"]').node();\r\n\t\t\t// \t\t// this._fireEvt(\"elepath_toggle\", { path: path, name: name, legend: target });\r\n\t\t\t// \t});\r\n\r\n\t\t\treturn legend;\r\n\t\t};\r\n\t},\r\n\r\n\t/**\r\n\t * Calculates chart width.\r\n\t */\r\n\t_width: function() {\r\n\t\tlet opts = this.options;\r\n\t\treturn opts.width - opts.margins.left - opts.margins.right;\r\n\t},\r\n\r\n\t/**\r\n\t * Calculates chart height.\r\n\t */\r\n\t_height: function() {\r\n\t\tlet opts = this.options;\r\n\t\treturn opts.height - opts.margins.top - opts.margins.bottom;\r\n\t},\r\n\r\n\t/*\r\n\t * Handle drag operations.\r\n\t */\r\n\t_dragHandler: function() {\r\n\t\t//we don't want map events to occur here\r\n\t\td3.event.preventDefault();\r\n\t\td3.event.stopPropagation();\r\n\r\n\t\tthis._gotDragged = true;\r\n\t\tthis._drawDragRectangle();\r\n\t},\r\n\r\n\t/*\r\n\t * Handles start of drag operations.\r\n\t */\r\n\t_dragStartHandler: function() {\r\n\t\td3.event.preventDefault();\r\n\t\td3.event.stopPropagation();\r\n\r\n\t\tthis._gotDragged = false;\r\n\t\tthis._dragStartCoords = d3.mouse(this._focusRect.node());\r\n\t},\r\n\r\n\t/*\r\n\t * Draws the currently dragged rectangle over the chart.\r\n\t */\r\n\t_drawDragRectangle: function() {\r\n\t\tif (!this._dragStartCoords || !this._draggingEnabled) return;\r\n\t\tif (!this._dragRectangle) {\r\n\t\t\tthis._dragRectangle = this._focus.insert(\"rect\", \".mouse-focus-group\")\r\n\t\t\t\t.attr('class', 'mouse-drag')\r\n\t\t\t\t.style(\"pointer-events\", \"none\");\r\n\t\t}\r\n\t\tthis._dragRectangle.call(\r\n\t\t\tD3.DragRectangle({\r\n\t\t\t\tdragStartCoords: this._dragStartCoords,\r\n\t\t\t\tdragEndCoords: this._dragCurrentCoords = d3.mouse(this._focusRect.node()),\r\n\t\t\t\theight: this._height(),\r\n\t\t\t})\r\n\t\t);\r\n\t},\r\n\r\n\t/*\r\n\t * Handles end of drag operations. Zooms the map to the selected items extent.\r\n\t */\r\n\t_dragEndHandler: function() {\r\n\t\tif (!this._dragStartCoords || !this._dragCurrentCoords || !this._gotDragged) {\r\n\t\t\tthis._dragStartCoords = null;\r\n\t\t\tthis._gotDragged = false;\r\n\t\t\tif (this._draggingEnabled) this._resetDrag();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet start = this._findIndexForXCoord(this._dragStartCoords[0]);\r\n\t\tlet end = this._findIndexForXCoord(this._dragCurrentCoords[0]);\r\n\r\n\t\tif (start == end) return;\r\n\r\n\t\tthis._dragStartCoords = null;\r\n\t\tthis._gotDragged = false;\r\n\r\n\t\tthis.fire('dragged', { dragstart: this._data[start], dragend: this._data[end] });\r\n\t},\r\n\r\n\t/*\r\n\t * Handles the moueseenter over the chart.\r\n\t */\r\n\t_mouseenterHandler: function() {\r\n\t\tthis.fire(\"mouse_enter\");\r\n\t},\r\n\r\n\t/*\r\n\t * Handles the moueseover the chart and displays distance and altitude level.\r\n\t */\r\n\t_mousemoveHandler: function(d, i, ctx) {\r\n\t\tlet coords = d3.mouse(this._focusRect.node());\r\n\t\tlet xCoord = coords[0];\r\n\t\tlet item = this._data[this._findIndexForXCoord(xCoord)];\r\n\r\n\t\tthis.fire(\"mouse_move\", { item: item, xCoord: xCoord });\r\n\t},\r\n\r\n\t/*\r\n\t * Handles the moueseout over the chart.\r\n\t */\r\n\t_mouseoutHandler: function() {\r\n\t\tthis.fire(\"mouse_out\");\r\n\t},\r\n\r\n\t/*\r\n\t * Finds a data entry for a given x-coordinate of the diagram\r\n\t */\r\n\t_findIndexForXCoord: function(x) {\r\n\t\treturn d3\r\n\t\t\t.bisector(d => d[this.options.xAttr])\r\n\t\t\t.left(this._data || [0, 1], this._x.invert(x));\r\n\t},\r\n\r\n\t/*\r\n\t * Finds a data entry for a given latlng of the map\r\n\t */\r\n\t_findIndexForLatLng: function(latlng) {\r\n\t\treturn d3\r\n\t\t\t.bisector(d => d.latlng)\r\n\t\t\t.left(this._data, latlng)\r\n\t},\r\n\r\n\t/*\r\n\t * Removes the drag rectangle and zoms back to the total extent of the data.\r\n\t */\r\n\t_resetDrag: function() {\r\n\t\tif (this._dragRectangle) {\r\n\t\t\tthis._dragRectangle.remove();\r\n\t\t\tthis._dragRectangle = null;\r\n\t\t\tthis._hideDiagramIndicator();\r\n\t\t\tthis.fire('reset_drag');\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Display distance and altitude level (\"focus-rect\").\r\n\t */\r\n\t_showDiagramIndicator: function(item, xCoordinate) {\r\n\t\t// if (!this._chartEnabled) return;\r\n\r\n\t\tlet opts = this.options;\r\n\t\tlet yCoordinate = this._y(item[opts.yAttr]);\r\n\r\n\t\tthis._focusG.classed(\"hidden\", false);\r\n\r\n\t\tthis._focusline.call(\r\n\t\t\tD3.MouseFocusLine({\r\n\t\t\t\txCoord: xCoordinate,\r\n\t\t\t\theight: this._height()\r\n\t\t\t})\r\n\t\t);\r\n\t\tthis._focuslabel.call(\r\n\t\t\tD3.MouseFocusLabel({\r\n\t\t\t\txCoord: xCoordinate,\r\n\t\t\t\tyCoord: yCoordinate,\r\n\t\t\t\theight: this._height(),\r\n\t\t\t\twidth: this._width(),\r\n\t\t\t\tlabelX: _.formatNum(item[opts.xAttr], opts.decimalsX) + \" \" + this._xLabel,\r\n\t\t\t\tlabelY: _.formatNum(item[opts.yAttr], opts.decimalsY) + \" \" + this._yLabel,\r\n\t\t\t})\r\n\t\t);\r\n\t},\r\n\r\n\t_hideDiagramIndicator: function() {\r\n\t\tthis._focusG.classed(\"hidden\", true);\r\n\t},\r\n});\r\n\r\n// Chart.addInitHook(function() {\r\n// \tthis.on('mouse_move', function(e) {\r\n// \t\tif (e.item) this._showDiagramIndicator(e.item, e.xCoord);\r\n// \t});\r\n//\r\n// });\r\n","import 'leaflet-i18n';\r\nimport * as _ from './utils';\r\nimport * as D3 from './components';\r\n\r\nexport var Marker = L.Class.extend({\r\n\r\n\tinitialize: function(options) {\r\n\t\tthis.options = options;\r\n\r\n\t\tif (this.options.imperial) {\r\n\t\t\t// this._distanceFactor = this.__mileFactor;\r\n\t\t\t// this._heightFactor = this.__footFactor;\r\n\t\t\tthis._xLabel = \"mi\";\r\n\t\t\tthis._yLabel = \"ft\";\r\n\t\t} else {\r\n\t\t\t// this._distanceFactor = this.options.distanceFactor;\r\n\t\t\t// this._heightFactor = this.options.heightFactor;\r\n\t\t\tthis._xLabel = this.options.xLabel;\r\n\t\t\tthis._yLabel = this.options.yLabel;\r\n\t\t}\r\n\r\n\t\tif (this.options.marker == 'elevation-line') {\r\n\t\t\t// this._container = d3.create(\"g\").attr(\"class\", \"height-focus-group\");\r\n\t\t\tthis._focusline = d3.create('svg:line');\r\n\t\t\tthis._focusmarker = d3.create(\"svg:circle\");\r\n\t\t\tthis._focuslabel = d3.create(\"svg:text\");\r\n\t\t} else if (this.options.marker == 'position-marker') {\r\n\t\t\tthis._marker = L.marker([0, 0], { icon: this.options.markerIcon, zIndexOffset: 1000000, interactive: false });\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n\taddTo: function(map) {\r\n\t\tthis._map = map;\r\n\t\tif (this.options.marker == 'elevation-line') {\r\n\t\t\tlet g = this._container = d3.select(map.getPane('elevationPane')).select(\"svg > g\")\r\n\t\t\t\t.attr(\"class\", \"height-focus-group\");\r\n\t\t\tg.append(() => this._focusline.node());\r\n\t\t\tg.append(() => this._focusmarker.node());\r\n\t\t\tg.append(() => this._focuslabel.node());\r\n\t\t} else if (this.options.marker == 'position-marker') {\r\n\t\t\tthis._marker.addTo(map, { pane: 'elevationPane' });\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n\t/**\r\n\t * Update position marker (\"leaflet-marker\").\r\n\t */\r\n\tupdate: function(props) {\r\n\t\tif (props.options) this.options = props.options;\r\n\t\tif (!this._map) this.addTo(props.map);\r\n\r\n\t\tlet opts = this.options;\r\n\r\n\t\tthis._latlng = props.item.latlng;\r\n\r\n\t\tlet point = L.extend({}, props.item, this._map.latLngToLayerPoint(this._latlng));\r\n\r\n\t\tif (this.options.marker == 'elevation-line') {\r\n\r\n\t\t\tlet normalizedAlt = this._height() / props.maxElevation * point.z;\r\n\t\t\tlet normalizedY = point.y - normalizedAlt;\r\n\r\n\t\t\tthis._container.classed(\"hidden\", false);\r\n\r\n\t\t\tthis._focusmarker\r\n\t\t\t\t.call(\r\n\t\t\t\t\tD3.HeightFocusMarker({\r\n\t\t\t\t\t\ttheme: opts.theme,\r\n\t\t\t\t\t\txCoord: point.x,\r\n\t\t\t\t\t\tyCoord: point.y,\r\n\t\t\t\t\t}));\r\n\r\n\t\t\tthis._focusline\r\n\t\t\t\t.call(\r\n\t\t\t\t\tD3.HeightFocusLine({\r\n\t\t\t\t\t\ttheme: opts.theme,\r\n\t\t\t\t\t\txCoord: point.x,\r\n\t\t\t\t\t\tyCoord: point.y,\r\n\t\t\t\t\t\tlength: normalizedY\r\n\t\t\t\t\t})\r\n\t\t\t\t);\r\n\r\n\t\t\tthis._focuslabel\r\n\t\t\t\t.call(\r\n\t\t\t\t\tD3.HeightFocusLabel({\r\n\t\t\t\t\t\ttheme: opts.theme,\r\n\t\t\t\t\t\txCoord: point.x,\r\n\t\t\t\t\t\tyCoord: normalizedY,\r\n\t\t\t\t\t\tlabel: _.formatNum(point[opts.yAttr], opts.decimalsY) + \" \" + this._yLabel\r\n\t\t\t\t\t})\r\n\t\t\t\t);\r\n\t\t} else if (this.options.marker == 'position-marker') {\r\n\t\t\t_.removeClass(this._marker.getElement(), 'hidden');\r\n\t\t\tthis._marker.setLatLng(this._latlng);\r\n\t\t}\r\n\t},\r\n\r\n\t/*\r\n\t * Hides the position/height indicator marker drawn onto the map\r\n\t */\r\n\tremove: function() {\r\n\t\tif (this.options.marker == 'elevation-line') {\r\n\t\t\tif (this._container) this._container.classed(\"hidden\", true);\r\n\t\t} else if (this.options.marker == 'position-marker') {\r\n\t\t\t_.addClass(this._marker.getElement(), 'hidden');\r\n\t\t}\r\n\t},\r\n\r\n\tgetLatLng: function() {\r\n\t\treturn this._latlng;\r\n\t},\r\n\r\n\t/**\r\n\t * Calculates chart height.\r\n\t */\r\n\t_height: function() {\r\n\t\tlet opts = this.options;\r\n\t\treturn opts.height - opts.margins.top - opts.margins.bottom;\r\n\t},\r\n\r\n});\r\n","import 'leaflet-i18n';\r\nimport * as _ from './utils';\r\nimport * as D3 from './components';\r\n\r\nexport var Summary = L.Class.extend({\r\n\tinitialize: function(opts) {\r\n\t\tthis.options = opts;\r\n\r\n\t\tlet summary = this._container = _.create(\"div\", \"elevation-summary \" + (opts.summary ? opts.summary + \"-summary\" : ''));\r\n\t\t_.style(summary, 'max-width', opts.width ? opts.width + 'px' : '');\r\n\t},\r\n\r\n\trender: function() {\r\n\t\treturn container => container.append(() => this._container);\r\n\t},\r\n\r\n\treset: function() {\r\n\t\tthis._container.innerHTML = '';\r\n\t}\r\n\r\n});\r\n","import * as _ from './utils';\r\n\r\nexport var Options = {\r\n\tautohide: !L.Browser.mobile,\r\n\tautohideMarker: true,\r\n\tcollapsed: false,\r\n\tdetached: true,\r\n\tdistanceFactor: 1,\r\n\tdecimalsX: 2,\r\n\tdecimalsY: 0,\r\n\tdragging: !L.Browser.mobile,\r\n\tdownloadLink: 'link',\r\n\televationDiv: \"#elevation-div\",\r\n\tfollowMarker: true,\r\n\tforceAxisBounds: false,\r\n\tgpxOptions: {\r\n\t\tasync: true,\r\n\t\tmarker_options: {\r\n\t\t\tstartIconUrl: null,\r\n\t\t\tendIconUrl: null,\r\n\t\t\tshadowUrl: null,\r\n\t\t\twptIcons: {\r\n\t\t\t\t'': L.divIcon({\r\n\t\t\t\t\tclassName: 'elevation-waypoint-marker',\r\n\t\t\t\t\thtml: '<i class=\"elevation-waypoint-icon\"></i>',\r\n\t\t\t\t\ticonSize: [30, 30],\r\n\t\t\t\t\ticonAnchor: [8, 30],\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t},\r\n\t},\r\n\theight: 200,\r\n\theightFactor: 1,\r\n\timperial: false,\r\n\tinterpolation: \"curveLinear\",\r\n\tlazyLoadJS: true,\r\n\tlegend: true,\r\n\tloadData: {\r\n\t\tdefer: false,\r\n\t\tlazy: false,\r\n\t},\r\n\tmargins: {\r\n\t\ttop: 10,\r\n\t\tright: 20,\r\n\t\tbottom: 30,\r\n\t\tleft: 50\r\n\t},\r\n\tmarker: 'elevation-line',\r\n\tmarkerIcon: L.divIcon({\r\n\t\tclassName: 'elevation-position-marker',\r\n\t\thtml: '<i class=\"elevation-position-icon\"></i>',\r\n\t\ticonSize: [32, 32],\r\n\t\ticonAnchor: [16, 16],\r\n\t}),\r\n\tplaceholder: false,\r\n\tposition: \"topright\",\r\n\tpolyline: {\r\n\t\tclassName: 'elevation-polyline',\r\n\t\tcolor: '#000',\r\n\t\topacity: 0.75,\r\n\t\tweight: 5,\r\n\t\tlineCap: 'round'\r\n\t},\r\n\treverseCoords: false,\r\n\tskipNullZCoords: false,\r\n\ttheme: \"lightblue-theme\",\r\n\tresponsive: true,\r\n\tsummary: 'inline',\r\n\tslope: false,\r\n\tsDeltaMax: undefined,\r\n\tsInterpolation: \"curveStepAfter\",\r\n\tsRange: undefined,\r\n\twidth: 600,\r\n\txAttr: \"dist\",\r\n\txLabel: \"km\",\r\n\txTicks: undefined,\r\n\tyAttr: \"z\",\r\n\tyAxisMax: undefined,\r\n\tyAxisMin: undefined,\r\n\tyLabel: \"m\",\r\n\tyTicks: undefined,\r\n\tzFollow: 13,\r\n};\r\n","import 'leaflet-i18n';\r\nimport * as _ from './utils';\r\nimport * as D3 from './components';\r\nimport { Chart } from './chart';\r\nimport { Marker } from './marker';\r\nimport { Summary } from './summary';\r\nimport { Options } from './options';\r\n\r\nexport const Elevation = L.Control.Elevation = L.Control.extend({\r\n\r\n\tincludes: L.Evented ? L.Evented.prototype : L.Mixin.Events,\r\n\r\n\toptions: Options,\r\n\t_data: [],\r\n\t_layers: L.featureGroup(),\r\n\t_chartEnabled: true,\r\n\t__mileFactor: 0.621371,\r\n\t__footFactor: 3.28084,\r\n\t__D3: 'https://unpkg.com/d3@5.15.0/dist/d3.min.js',\r\n\t__LGPX: 'https://unpkg.com/leaflet-gpx@1.5.0/gpx.js',\r\n\r\n\t/*\r\n\t * Add data to the diagram either from GPX or GeoJSON and update the axis domain and data\r\n\t */\r\n\taddData: function(d, layer) {\r\n\t\tif ((typeof layer === \"undefined\" || layer === null) && d.on) {\r\n\t\t\tlayer = d;\r\n\t\t}\r\n\t\tElevation._d3LazyLoader = _.lazyLoader(\r\n\t\t\tthis.__D3,\r\n\t\t\ttypeof d3 !== 'object' || !this.options.lazyLoadJS,\r\n\t\t\tElevation._d3LazyLoader\r\n\t\t).then(() => {\r\n\t\t\tthis._addData(d);\r\n\t\t\tthis._addLayer(layer);\r\n\t\t\tthis._fireEvt(\"eledata_added\", { data: d, layer: layer, track_info: this.track_info });\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Adds the control to the given map.\r\n\t */\r\n\taddTo: function(map) {\r\n\t\tif (this.options.detached) {\r\n\t\t\tlet eleDiv = this._initElevationDiv();\r\n\t\t\tif (!eleDiv.isConnected) _.insert(map.getContainer(), eleDiv, 'afterend');\r\n\t\t\t_.append(eleDiv, this.onAdd(map));\r\n\t\t} else {\r\n\t\t\tL.Control.prototype.addTo.call(this, map);\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n\t/*\r\n\t * Reset data and display\r\n\t */\r\n\tclear: function() {\r\n\t\tthis._marker.remove();\r\n\t\tthis._chart.clear();\r\n\t\tthis._layers.clearLayers();\r\n\r\n\t\tthis._data = [];\r\n\t\tthis._distance = 0;\r\n\t\tthis.track_info = {};\r\n\r\n\t\tthis._fireEvt(\"eledata_clear\");\r\n\t},\r\n\r\n\t/**\r\n\t * Disable dragging chart on touch events.\r\n\t */\r\n\tdisableDragging: function() {\r\n\t\tthis._chart._draggingEnabled = false;\r\n\t\tthis._resetDrag();\r\n\t},\r\n\r\n\t/**\r\n\t * Enable dragging chart on touch events.\r\n\t */\r\n\tenableDragging: function() {\r\n\t\tthis._chart._draggingEnabled = true;\r\n\t},\r\n\r\n\t/**\r\n\t * Sets a map view that contains the given geographical bounds.\r\n\t */\r\n\tfitBounds: function(bounds) {\r\n\t\tbounds = bounds || this.getBounds();\r\n\t\tif (this._map && bounds.isValid()) this._map.fitBounds(bounds);\r\n\t},\r\n\r\n\tgetBounds: function(data) {\r\n\t\tdata = data || this._data;\r\n\t\treturn L.latLngBounds(data.map((d) => d.latlng));\r\n\t},\r\n\r\n\t/**\r\n\t * Get default zoom level when \"followMarker\" is true.\r\n\t */\r\n\tgetZFollow: function() {\r\n\t\treturn this._zFollow;\r\n\t},\r\n\r\n\t/**\r\n\t * Hide current elevation chart profile.\r\n\t */\r\n\thide: function() {\r\n\t\t_.style(this._container, \"display\", \"none\");\r\n\t},\r\n\r\n\t/**\r\n\t * Initialize chart control \"options\" and \"container\".\r\n\t */\r\n\tinitialize: function(options) {\r\n\t\tthis.options = _.deepMerge({}, this.options, options);\r\n\r\n\t\tif (this.options.imperial) {\r\n\t\t\tthis._distanceFactor = this.__mileFactor;\r\n\t\t\tthis._heightFactor = this.__footFactor;\r\n\t\t\tthis._xLabel = \"mi\";\r\n\t\t\tthis._yLabel = \"ft\";\r\n\t\t} else {\r\n\t\t\tthis._distanceFactor = this.options.distanceFactor;\r\n\t\t\tthis._heightFactor = this.options.heightFactor;\r\n\t\t\tthis._xLabel = this.options.xLabel;\r\n\t\t\tthis._yLabel = this.options.yLabel;\r\n\t\t}\r\n\r\n\t\tthis._zFollow = this.options.zFollow;\r\n\r\n\t\tif (this.options.followMarker) this._setMapView = L.Util.throttle(this._setMapView, 300, this);\r\n\t\tif (this.options.placeholder) this.options.loadData.lazy = this.options.loadData.defer = true;\r\n\r\n\t\tif (this.options.legend) this.options.margins.bottom += 30;\r\n\t},\r\n\r\n\t/**\r\n\t * Alias for loadData\r\n\t */\r\n\tload: function(data, opts) {\r\n\t\tthis.loadData(data, opts);\r\n\t},\r\n\r\n\t/**\r\n\t * Alias for addTo\r\n\t */\r\n\tloadChart: function(map) {\r\n\t\tthis.addTo(map);\r\n\t},\r\n\r\n\t/**\r\n\t * Load elevation data (GPX or GeoJSON).\r\n\t */\r\n\tloadData: function(data, opts) {\r\n\t\topts = L.extend({}, this.options.loadData, opts);\r\n\t\tif (opts.defer) {\r\n\t\t\tthis.loadDefer(data, opts);\r\n\t\t} else if (opts.lazy) {\r\n\t\t\tthis.loadLazy(data, opts);\r\n\t\t} else if (_.isXMLDoc(data)) {\r\n\t\t\tthis.loadGPX(data);\r\n\t\t} else if (_.isJSONDoc(data)) {\r\n\t\t\tthis.loadGeoJSON(data);\r\n\t\t} else {\r\n\t\t\tthis.loadFile(data);\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Wait for document load before download data.\r\n\t */\r\n\tloadDefer: function(data, opts) {\r\n\t\topts = L.extend({}, this.options.loadData, opts);\r\n\t\topts.defer = false;\r\n\t\t_.deferFunc(L.bind(this.loadData, this, data, opts));\r\n\t},\r\n\r\n\t/**\r\n\t * Load data from a remote url.\r\n\t */\r\n\tloadFile: function(url) {\r\n\t\t_.loadFile(url)\r\n\t\t\t.then((data) => {\r\n\t\t\t\tthis._downloadURL = url; // TODO: handle multiple urls?\r\n\t\t\t\tthis.loadData(data, { lazy: false, defer: false });\r\n\t\t\t})\r\n\t\t\t.catch((err) => console.warn(err));\r\n\t},\r\n\r\n\t/**\r\n\t * Load raw GeoJSON data.\r\n\t */\r\n\tloadGeoJSON: function(data) {\r\n\t\t_.GeoJSONLoader(data, this);\r\n\t},\r\n\r\n\t/**\r\n\t * Load raw GPX data.\r\n\t */\r\n\tloadGPX: function(data) {\r\n\t\tElevation._gpxLazyLoader = _.lazyLoader(\r\n\t\t\tthis.__LGPX,\r\n\t\t\ttypeof L.GPX !== 'function' || !this.options.lazyLoadJS,\r\n\t\t\tElevation._gpxLazyLoader\r\n\t\t).then(() => _.GPXLoader(data, this));\r\n\t},\r\n\r\n\t/**\r\n\t * Wait for chart container visible before download data.\r\n\t */\r\n\tloadLazy: function(data, opts) {\r\n\t\topts = L.extend({}, this.options.loadData, opts);\r\n\t\tlet elem = opts.lazy.parentNode ? opts.lazy : this.placeholder;\r\n\t\t_.waitHolder(elem)\r\n\t\t\t.then(() => {\r\n\t\t\t\topts.lazy = false;\r\n\t\t\t\tthis.loadData(data, opts)\r\n\t\t\t\tthis.once('eledata_loaded', () => opts.lazy.parentNode.removeChild(elem));\r\n\t\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Create container DOM element and related event listeners.\r\n\t * Called on control.addTo(map).\r\n\t */\r\n\tonAdd: function(map) {\r\n\t\tthis._map = map;\r\n\r\n\t\tlet container = this._container = _.create(\"div\", \"elevation-control elevation \" + this.options.theme);\r\n\r\n\t\tif (!this.options.detached) {\r\n\t\t\t_.addClass(container, 'leaflet-control');\r\n\t\t}\r\n\r\n\t\tif (this.options.placeholder && !this._data.length) {\r\n\t\t\tthis.placeholder = _.create('img', 'elevation-placeholder', typeof this.options.placeholder === 'string' ? { src: this.options.placeholder, alt: '' } : this.options.placeholder);\r\n\t\t\t_.insert(container, this.placeholder, 'beforebegin');\r\n\t\t}\r\n\r\n\t\tElevation._d3LazyLoader = _.lazyLoader(\r\n\t\t\tthis.__D3,\r\n\t\t\ttypeof d3 !== 'object' || !this.options.lazyLoadJS,\r\n\t\t\tElevation._d3LazyLoader\r\n\t\t).then(() => {\r\n\t\t\tthis._initButton(container);\r\n\t\t\tthis._initChart(container);\r\n\t\t\tthis._initSummary(container);\r\n\t\t\tthis._initMarker(map);\r\n\t\t\tthis._initLayer(map);\r\n\r\n\t\t\tmap\r\n\t\t\t\t.on('zoom viewreset zoomanim', this._hideMarker, this)\r\n\t\t\t\t.on('resize', this._resetView, this)\r\n\t\t\t\t.on('resize', this._resizeChart, this)\r\n\t\t\t\t.on('mousedown', this._resetDrag, this);\r\n\r\n\t\t\t_.on(map.getContainer(), 'mousewheel', this._resetDrag, this);\r\n\t\t\t_.on(map.getContainer(), 'touchstart', this._resetDrag, this);\r\n\r\n\t\t\tthis\r\n\t\t\t\t.on('eledata_added eledata_loaded', this._updateChart, this)\r\n\t\t\t\t.on('eledata_added eledata_loaded', this._updateSummary, this);\r\n\r\n\t\t\tthis._updateChart();\r\n\t\t\tthis._updateSummary();\r\n\t\t});\r\n\r\n\t\treturn container;\r\n\t},\r\n\r\n\t/**\r\n\t * Clean up control code and related event listeners.\r\n\t * Called on control.remove().\r\n\t */\r\n\tonRemove: function(map) {\r\n\t\tthis._container = null;\r\n\r\n\t\tmap\r\n\t\t\t.off('zoom viewreset zoomanim', this._hideMarker, this)\r\n\t\t\t.off('resize', this._resetView, this)\r\n\t\t\t.off('resize', this._resizeChart, this)\r\n\t\t\t.off('mousedown', this._resetDrag, this);\r\n\r\n\t\t_.off(map.getContainer(), 'mousewheel', this._resetDrag, this);\r\n\t\t_.off(map.getContainer(), 'touchstart', this._resetDrag, this);\r\n\r\n\t\tthis\r\n\t\t\t.off('eledata_added eledata_loaded', this._updateChart, this)\r\n\t\t\t.off('eledata_added eledata_loaded', this._updateSummary, this);\r\n\t},\r\n\r\n\t/**\r\n\t * Redraws the chart control. Sometimes useful after screen resize.\r\n\t */\r\n\tredraw: function() {\r\n\t\tthis._resizeChart();\r\n\t},\r\n\r\n\t/**\r\n\t * Set default zoom level when \"followMarker\" is true.\r\n\t */\r\n\tsetZFollow: function(zoom) {\r\n\t\tthis._zFollow = zoom;\r\n\t},\r\n\r\n\t/**\r\n\t * Hide current elevation chart profile.\r\n\t */\r\n\tshow: function() {\r\n\t\t_.style(this._container, \"display\", \"block\");\r\n\t},\r\n\r\n\t/*\r\n\t * Parsing data either from GPX or GeoJSON and update the diagram data\r\n\t */\r\n\t_addData: function(d) {\r\n\t\tlet geom = d && d.geometry;\r\n\t\tlet feat = d && d.type === \"FeatureCollection\";\r\n\t\tlet gpx = d && d._latlngs;\r\n\r\n\t\tif (geom) {\r\n\t\t\tswitch (geom.type) {\r\n\t\t\t\tcase 'LineString':\r\n\t\t\t\t\tthis._addGeoJSONData(geom.coordinates);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'MultiLineString':\r\n\t\t\t\t\t_.each(geom.coordinates, coords => this._addGeoJSONData(coords));\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tconsole.warn('Unsopperted GeoJSON feature geometry type:' + geom.type);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (feat) {\r\n\t\t\t_.each(d.features, feature => this._addData(feature));\r\n\t\t}\r\n\r\n\t\tif (gpx) {\r\n\t\t\tthis._addGPXData(d._latlngs);\r\n\t\t}\r\n\t},\r\n\r\n\t/*\r\n\t * Parsing of GeoJSON data lines and their elevation in z-coordinate\r\n\t */\r\n\t_addGeoJSONData: function(coords) {\r\n\t\t_.each(coords, point => this._addPoint(point[1], point[0], point[2]));\r\n\t},\r\n\r\n\t/*\r\n\t * Parsing function for GPX data and their elevation in z-coordinate\r\n\t */\r\n\t_addGPXData: function(coords) {\r\n\t\t_.each(coords, point => this._addPoint(point.lat, point.lng, point.meta.ele));\r\n\t},\r\n\r\n\t/*\r\n\t * Parse and push a single (x, y, z) point to current elevation profile.\r\n\t */\r\n\t_addPoint: function(x, y, z) {\r\n\t\tif (this.options.reverseCoords) {\r\n\t\t\t[x, y] = [y, x];\r\n\t\t}\r\n\r\n\t\tlet data = this._data || [];\r\n\t\tlet i = data.length;\r\n\t\tlet dist = this._distance || 0;\r\n\r\n\t\tlet curr = new L.LatLng(x, y);\r\n\t\tlet prev = i > 0 ? data[i - 1].latlng : curr;\r\n\r\n\t\tlet delta = curr.distanceTo(prev) * this._distanceFactor;\r\n\r\n\t\tdist = dist + Math.round(delta / 1000 * 100000) / 100000;\r\n\r\n\t\tz = z * this._heightFactor;\r\n\r\n\t\tdata.push({\r\n\t\t\tdist: dist,\r\n\t\t\tx: x,\r\n\t\t\ty: y,\r\n\t\t\tz: z,\r\n\t\t\tlatlng: curr\r\n\t\t});\r\n\r\n\t\tthis._data = data;\r\n\t\tthis.track_info = this.track_info || {};\r\n\t\tthis.track_info.distance = this._distance = dist;\r\n\r\n\t\tthis._fireEvt(\"eledata_updated\", { index: i });\r\n\t},\r\n\r\n\t_addLayer: function(layer) {\r\n\t\tif (layer) this._layers.addLayer(layer)\r\n\t},\r\n\r\n\t/**\r\n\t * Adds the control to the given \"detached\" div.\r\n\t */\r\n\t_initElevationDiv: function() {\r\n\t\tlet eleDiv = _.select(this.options.elevationDiv);\r\n\t\tif (!eleDiv) {\r\n\t\t\tthis.options.elevationDiv = '#elevation-div_' + _.randomId();\r\n\t\t\teleDiv = _.create('div', 'leaflet-control elevation elevation-div', { id: this.options.elevationDiv.substr(1) });\r\n\t\t}\r\n\t\tif (this.options.detached) {\r\n\t\t\t_.addClass(eleDiv, 'elevation-detached');\r\n\t\t\t_.removeClass(eleDiv, 'leaflet-control');\r\n\t\t}\r\n\t\tthis.eleDiv = eleDiv;\r\n\t\treturn this.eleDiv;\r\n\t},\r\n\r\n\t/*\r\n\t * Collapse current chart control.\r\n\t */\r\n\t_collapse: function() {\r\n\t\t_.removeClass(this._container, 'elevation-expanded');\r\n\t\t_.addClass(this._container, 'elevation-collapsed');\r\n\t},\r\n\r\n\t/*\r\n\t * Expand current chart control.\r\n\t */\r\n\t_expand: function() {\r\n\t\t_.removeClass(this._container, 'elevation-collapsed');\r\n\t\t_.addClass(this._container, 'elevation-expanded');\r\n\t},\r\n\r\n\t/*\r\n\t * Finds a data entry for the given LatLng\r\n\t */\r\n\t_findItemForLatLng: function(latlng) {\r\n\t\treturn this._data[this._chart._findIndexForLatLng(latlng)];\r\n\t},\r\n\r\n\t/*\r\n\t * Finds a data entry for the given xDiagCoord\r\n\t */\r\n\t_findItemForX: function(x) {\r\n\t\treturn this._data[this._chart._findIndexForXCoord(x)];\r\n\t},\r\n\r\n\t/**\r\n\t * Fires an event of the specified type.\r\n\t */\r\n\t_fireEvt: function(type, data, propagate) {\r\n\t\tif (this.fire) this.fire(type, data, propagate);\r\n\t\tif (this._map) this._map.fire(type, data, propagate);\r\n\t},\r\n\r\n\t/**\r\n\t * Calculates chart height.\r\n\t */\r\n\t_height: function() {\r\n\t\tlet opts = this.options;\r\n\t\treturn opts.height - opts.margins.top - opts.margins.bottom;\r\n\t},\r\n\r\n\t/*\r\n\t * Hides the position/height indicator marker drawn onto the map\r\n\t */\r\n\t_hideMarker: function() {\r\n\t\tif (this.options.autohideMarker) {\r\n\t\t\tthis._marker.remove();\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Generate \"svg\" chart DOM element.\r\n\t */\r\n\t_initChart: function(container) {\r\n\t\tlet opts = this.options;\r\n\t\topts.xTicks = opts.xTicks || Math.round(this._width() / 75);\r\n\t\topts.yTicks = opts.yTicks || Math.round(this._height() / 30);\r\n\r\n\t\tif (opts.responsive) {\r\n\t\t\tif (opts.detached) {\r\n\t\t\t\tlet offWi = this.eleDiv.offsetWidth;\r\n\t\t\t\tlet offHe = this.eleDiv.offsetHeight;\r\n\t\t\t\topts.width = offWi > 0 ? offWi : opts.width;\r\n\t\t\t\topts.height = (offHe - 20) > 0 ? offHe - 20 : opts.height; // 20 = horizontal scrollbar size.\r\n\t\t\t} else {\r\n\t\t\t\topts._maxWidth = opts._maxWidth > opts.width ? opts._maxWidth : opts.width;\r\n\t\t\t\tlet containerWidth = this._map.getContainer().clientWidth;\r\n\t\t\t\topts.width = opts._maxWidth > containerWidth ? containerWidth - 30 : opts.width;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet chart = this._chart = new Chart(opts);\r\n\r\n\t\td3\r\n\t\t\t.select(container)\r\n\t\t\t.call(chart.render())\r\n\r\n\t\tchart\r\n\t\t\t.on('reset_drag', this._hideMarker, this)\r\n\t\t\t.on('mouse_enter', this._fireEvt.bind('elechart_enter'), this)\r\n\t\t\t.on('dragged', this._dragendHandler, this)\r\n\t\t\t.on('mouse_move', this._mousemoveHandler, this)\r\n\t\t\t.on('mouse_out', this._mouseoutHandler, this);\r\n\r\n\t\tthis._fireEvt(\"elechart_axis\");\r\n\t\tif (this.options.legend) this._fireEvt(\"elechart_legend\");\r\n\r\n\t\tthis._fireEvt(\"elechart_init\");\r\n\t},\r\n\r\n\t_initLayer: function() {\r\n\t\tthis._layers\r\n\t\t\t.on('layeradd layerremove', (e) => {\r\n\t\t\t\tlet layer = e.layer\r\n\t\t\t\tlet toggleClass = e.type == 'layeradd' ? _.addClass : _.removeClass;\r\n\t\t\t\tlet toggleEvt = layer[e.type == 'layeradd' ? \"on\" : \"off\"].bind(layer);\r\n\t\t\t\ttoggleClass(layer.getElement(), this.options.polyline.className + ' ' + this.options.theme);\r\n\t\t\t\ttoggleEvt(\"mousemove\", this._mousemoveLayerHandler, this)\r\n\t\t\t\ttoggleEvt(\"mouseout\", this._mouseoutHandler, this);\r\n\t\t\t});\r\n\t},\r\n\r\n\t_initMarker: function(map) {\r\n\t\tlet pane = map.getPane('elevationPane');\r\n\t\tif (!pane) {\r\n\t\t\tpane = this._pane = map.createPane('elevationPane');\r\n\t\t\tpane.style.zIndex = 625; // This pane is above markers but below popups.\r\n\t\t\tpane.style.pointerEvents = 'none';\r\n\t\t}\r\n\t\tif (this._renderer) this._renderer.remove()\r\n\t\tthis._renderer = L.svg({ pane: \"elevationPane\" }).addTo(this._map); // default leaflet svg renderer\r\n\r\n\t\tthis._marker = (new Marker(this.options));\r\n\t},\r\n\r\n\t/**\r\n\t * Inspired by L.Control.Layers\r\n\t */\r\n\t_initButton: function(container) {\r\n\t\t//Makes this work on IE10 Touch devices by stopping it from firing a mouseout event when the touch is released\r\n\t\tcontainer.setAttribute('aria-haspopup', true);\r\n\r\n\t\tif (!this.options.detached) {\r\n\t\t\tL.DomEvent\r\n\t\t\t\t.disableClickPropagation(container);\r\n\t\t\t//.disableScrollPropagation(container);\r\n\t\t}\r\n\r\n\t\tif (L.Browser.mobile) {\r\n\t\t\t_.on(container, 'click', L.DomEvent.stopPropagation);\r\n\t\t}\r\n\r\n\t\t_.on(container, 'mousewheel', this._mousewheelHandler, this);\r\n\r\n\t\tif (!this.options.detached) {\r\n\t\t\tlet link = this._button = _.create('a', \"elevation-toggle elevation-toggle-icon\" + (this.options.autohide ? \"\" : \" close-button\"), { href: '#', title: L._('Elevation') }, container);\r\n\r\n\t\t\tif (this.options.collapsed) {\r\n\t\t\t\tthis._collapse();\r\n\t\t\t\tif (this.options.autohide) {\r\n\t\t\t\t\t_.on(container, 'mouseover', this._expand, this);\r\n\t\t\t\t\t_.on(container, 'mouseout', this._collapse, this);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t_.on(link, 'click', L.DomEvent.stop);\r\n\t\t\t\t\t_.on(link, 'click', this._toggle, this);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t_.on(link, 'focus', this._toggle, this);\r\n\r\n\t\t\t\tthis._map.on('click', this._collapse, this);\r\n\t\t\t\t// TODO: keyboard accessibility\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t// TODO: handle autohide when detached=true\r\n\t\t}\r\n\t},\r\n\r\n\t_initSummary: function(container) {\r\n\t\tlet summary = this._summary = new Summary({ summary: this.options.summary });\r\n\r\n\t\td3\r\n\t\t\t.select(container)\r\n\t\t\t.call(summary.render());\r\n\r\n\t\tthis.summaryDiv = this._summary._container;\r\n\t},\r\n\r\n\t_dragendHandler: function(e) {\r\n\t\tthis._hideMarker();\r\n\t\tthis.fitBounds(L.latLngBounds([e.dragstart.latlng, e.dragend.latlng]));\r\n\r\n\t\tthis._fireEvt(\"elechart_dragged\");\r\n\t},\r\n\r\n\t/*\r\n\t * Handles the moueseover the chart and displays distance and altitude level.\r\n\t */\r\n\t_mousemoveHandler: function(e) {\r\n\t\tif (!this._data.length || !this._chartEnabled) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet xCoord = e.xCoord;\r\n\t\tlet item = this._findItemForX(xCoord);\r\n\r\n\t\tif (this._chartEnabled) this._chart._showDiagramIndicator(item, xCoord);\r\n\r\n\t\tthis._updateMarker(item);\r\n\t\tthis._setMapView(item);\r\n\r\n\t\tif (this._map) {\r\n\t\t\t_.addClass(this._map.getContainer(), 'elechart-hover');\r\n\t\t}\r\n\r\n\t\tthis._fireEvt(\"elechart_change\", { data: item, xCoord: xCoord });\r\n\t\tthis._fireEvt(\"elechart_hover\", { data: item, xCoord: xCoord });\r\n\t},\r\n\r\n\t/*\r\n\t * Handles mouseover events of the data layers on the map.\r\n\t */\r\n\t_mousemoveLayerHandler: function(e) {\r\n\t\tif (!this._data.length) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet item = this._findItemForLatLng(e.latlng);\r\n\t\tif (item) {\r\n\t\t\tlet xCoord = item.xDiagCoord;\r\n\r\n\t\t\tif (this._chartEnabled) this._chart._showDiagramIndicator(item, xCoord);\r\n\r\n\t\t\tthis._updateMarker(item);\r\n\r\n\t\t\tthis._fireEvt(\"elechart_change\", { data: item, xCoord: xCoord });\r\n\t\t}\r\n\t},\r\n\r\n\t/*\r\n\t * Handles the moueseout over the chart.\r\n\t */\r\n\t_mouseoutHandler: function() {\r\n\t\tif (!this.options.detached) {\r\n\t\t\tthis._hideMarker();\r\n\t\t\tthis._chart._hideDiagramIndicator();\r\n\t\t}\r\n\r\n\t\tif (this._map) {\r\n\t\t\t_.removeClass(this._map.getContainer(), 'elechart-hover');\r\n\t\t}\r\n\r\n\t\tthis._fireEvt(\"elechart_leave\");\r\n\t},\r\n\r\n\t/*\r\n\t * Handles the mouesewheel over the chart.\r\n\t */\r\n\t_mousewheelHandler: function(e) {\r\n\t\tif (this._map.gestureHandling && this._map.gestureHandling._enabled) return;\r\n\t\tlet ll = this._marker.getLatLng() || this._map.getCenter();\r\n\t\tlet z = this._map.getZoom() + Math.sign(e.deltaY);\r\n\t\tthis._resetDrag();\r\n\t\tthis._map.flyTo(ll, z);\r\n\t},\r\n\r\n\t/*\r\n\t * Removes the drag rectangle and zoms back to the total extent of the data.\r\n\t */\r\n\t_resetDrag: function() {\r\n\t\tthis._chart._resetDrag();\r\n\t\tthis._hideMarker();\r\n\t},\r\n\r\n\t/**\r\n\t * Resets drag, marker and bounds.\r\n\t */\r\n\t_resetView: function() {\r\n\t\tif (this._map && this._map._isFullscreen) return;\r\n\t\tthis._resetDrag();\r\n\t\tthis._hideMarker();\r\n\t\tthis.fitBounds();\r\n\t},\r\n\r\n\t/**\r\n\t * Hacky way for handling chart resize. Deletes it and redraw chart.\r\n\t */\r\n\t_resizeChart: function() {\r\n\t\t// prevent displaying chart on resize if hidden\r\n\t\tif (_.style(this._container, \"display\") == \"none\") return;\r\n\r\n\t\tif (this.options.responsive) {\r\n\t\t\tif (this.options.detached) {\r\n\t\t\t\tlet newWidth = this.eleDiv.offsetWidth; // - 20;\r\n\t\t\t\tif (newWidth) {\r\n\t\t\t\t\tthis.options.width = newWidth;\r\n\t\t\t\t\tthis.eleDiv.innerHTML = \"\";\r\n\t\t\t\t\t_.append(this.eleDiv, this.onAdd(this._map));\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tthis._map.removeControl(this._container);\r\n\t\t\t\tthis.addTo(this._map);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Collapse or Expand current chart control.\r\n\t */\r\n\t_toggle: function() {\r\n\t\tif (_.hasClass(this._container, \"elevation-expanded\"))\r\n\t\t\tthis._collapse();\r\n\t\telse\r\n\t\t\tthis._expand();\r\n\t},\r\n\r\n\t/**\r\n\t * Sets the view of the map (center and zoom). Useful when \"followMarker\" is true.\r\n\t */\r\n\t_setMapView: function(item) {\r\n\t\tif (!this.options.followMarker || !this._map) return;\r\n\t\tlet zoom = this._map.getZoom();\r\n\t\tzoom = zoom < this._zFollow ? this._zFollow : zoom;\r\n\t\tthis._map.setView(item.latlng, zoom, { animate: true, duration: 0.25 });\r\n\t},\r\n\r\n\t/**\r\n\t * Calculates [x, y] domain and then update chart.\r\n\t */\r\n\t_updateChart: function() {\r\n\t\tif (!this._data.length || !this._container) return;\r\n\r\n\t\tthis._chart = this._chart.update({ data: this._data });\r\n\r\n\t\tthis._x = this._chart._x;\r\n\t\tthis._y = this._chart._y;\r\n\r\n\t\tthis._fireEvt(\"elechart_axis\");\r\n\r\n\t\tthis._fireEvt('elechart_updated');\r\n\t},\r\n\r\n\t/*\r\n\t * Update the position/height indicator marker drawn onto the map\r\n\t */\r\n\t_updateMarker: function(item) {\r\n\t\tthis._marker.update({\r\n\t\t\tmap: this._map,\r\n\t\t\titem: item,\r\n\t\t\tmaxElevation: this._maxElevation,\r\n\t\t\toptions: this.options\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Update chart summary.\r\n\t */\r\n\t_updateSummary: function() {\r\n\t\tthis.track_info = this.track_info || {};\r\n\t\tthis.track_info.distance = this._distance || 0;\r\n\t\tthis.track_info.elevation_max = this._maxElevation || 0;\r\n\t\tthis.track_info.elevation_min = this._minElevation || 0;\r\n\r\n\t\tthis._summary.reset();\r\n\r\n\t\tif (this.options.summary) {\r\n\t\t\tthis._fireEvt(\"elechart_summary\");\r\n\t\t}\r\n\t\tif (this.options.downloadLink && this._downloadURL) { // TODO: generate dynamically file content instead of using static file urls.\r\n\t\t\tthis.summaryDiv.innerHTML += '<span class=\"download\"><a href=\"#\">' + L._('Download') + '</a></span>'\r\n\t\t\t_.select('.download a', this.summaryDiv).onclick = (e) => {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tthis._fireEvt('eletrack_download', { downloadLink: this.options.downloadLink, confirm: _.saveFile.bind(this, this._downloadURL) });\r\n\t\t\t};\r\n\t\t};\r\n\t},\r\n\r\n\r\n\t/**\r\n\t * Calculates chart width.\r\n\t */\r\n\t_width: function() {\r\n\t\tlet opts = this.options;\r\n\t\treturn opts.width - opts.margins.left - opts.margins.right;\r\n\t},\r\n\r\n});\r\n\r\n/**\r\n * Attach here some useful elevation hooks.\r\n */\r\nElevation.addInitHook(function() {\r\n\r\n\tthis.on('waypoint_added', function(e) {\r\n\t\tlet p = e.point,\r\n\t\t\tpop = p._popup;\r\n\t\tif (pop) {\r\n\t\t\tpop.options.className = 'elevation-popup';\r\n\t\t}\r\n\t\tif (pop._content) {\r\n\t\t\tpop._content = decodeURI(pop._content);\r\n\t\t\tp.bindTooltip(pop._content, { direction: 'top', sticky: true, opacity: 1, className: 'elevation-tooltip' }).openTooltip();\r\n\t\t}\r\n\t});\r\n\r\n\t// autotoggle chart data on click\r\n\tthis.on('elepath_toggle', function(e) {\r\n\t\tlet path = e.path;\r\n\t\tlet enable = _.hasClass(path, 'hidden');\r\n\t\tlet label = _.select('text', e.legend);\r\n\t\tlet rect = _.select('rect', e.legend);\r\n\r\n\t\t_.style(label, \"text-decoration-line\", enable ? \"\" : \"line-through\")\r\n\t\t_.style(rect, \"fill-opacity\", enable ? \"\" : \"0\")\r\n\t\t_.toggleClass(path, 'hidden', !enable);\r\n\r\n\t\tthis._chartEnabled = this._chart._area.selectAll('path:not(.hidden)').nodes().length != 0;\r\n\t\tthis._layers.eachLayer(l => _.toggleClass(l.getElement(), this.options.polyline.className + ' ' + this.options.theme, this._chartEnabled));\r\n\r\n\t\tif (!this._chartEnabled) {\r\n\t\t\tthis._chart._hideDiagramIndicator();\r\n\t\t\tthis._marker.remove();\r\n\t\t}\r\n\t});\r\n\r\n\tthis.on(\"elechart_updated\", function() {\r\n\t\t// TODO: maybe should i listen for this inside chart.js?\r\n\t\tthis._chart._legend.selectAll('.legend-item')\r\n\t\t\t.on('click', (d, i, n) => {\r\n\t\t\t\tlet target = n[i];\r\n\t\t\t\tlet name = target.getAttribute('data-name');\r\n\t\t\t\tlet path = this._chart._area.select('path[data-name=\"' + name + '\"]').node();\r\n\t\t\t\tthis._fireEvt(\"elepath_toggle\", { path: path, name: name, legend: target });\r\n\t\t\t});\r\n\t});\r\n\r\n\tthis.on(\"eletrack_download\", function(e) {\r\n\t\tif (e.downloadLink == 'modal' && typeof CustomEvent === \"function\") {\r\n\t\t\tdocument.dispatchEvent(new CustomEvent(\"eletrack_download\", { detail: e }));\r\n\t\t} else if (e.downloadLink == 'link' || e.downloadLink === true) {\r\n\t\t\te.confirm();\r\n\t\t}\r\n\t});\r\n\r\n\tthis.on('eledata_loaded', function(e) {\r\n\t\tlet layer = e.layer;\r\n\t\tif (this._map) {\r\n\t\t\tthis._map.once('layeradd', function(e) {\r\n\t\t\t\tthis.fitBounds(layer.getBounds());\r\n\t\t\t}, this);\r\n\t\t\tlayer.addTo(this._map);\r\n\t\t} else {\r\n\t\t\tconsole.warn(\"Undefined elevation map object\");\r\n\t\t}\r\n\t});\r\n\r\n});\r\n","import 'leaflet-i18n';\r\nimport * as _ from './utils';\r\nimport * as D3 from './components';\r\nimport { Elevation } from './control';\r\n\r\nElevation.addInitHook(function() {\r\n\r\n\tthis.on(\"eledata_updated\", function(e) {\r\n\t\tlet data = this._data;\r\n\t\tlet i = e.index;\r\n\t\tlet z = data[i].z;\r\n\r\n\t\tlet eleMax = this._maxElevation || -Infinity;\r\n\t\tlet eleMin = this._minElevation || +Infinity;\r\n\r\n\t\t// check and fix missing elevation data on last added point\r\n\t\tif (!this.options.skipNullZCoords && i > 0) {\r\n\t\t\tlet prevZ = data[i - 1].z;\r\n\t\t\tif (isNaN(prevZ)) {\r\n\t\t\t\tlet lastZ = this._lastValidZ;\r\n\t\t\t\tlet currZ = z * this._heightFactor;\r\n\t\t\t\tif (!isNaN(lastZ) && !isNaN(currZ)) {\r\n\t\t\t\t\tprevZ = (lastZ + currZ) / 2;\r\n\t\t\t\t} else if (!isNaN(lastZ)) {\r\n\t\t\t\t\tprevZ = lastZ;\r\n\t\t\t\t} else if (!isNaN(currZ)) {\r\n\t\t\t\t\tprevZ = currZ;\r\n\t\t\t\t}\r\n\t\t\t\tif (!isNaN(prevZ)) data[i - 1].z = prevZ;\r\n\t\t\t\telse data.splice(i - 1, 1);\r\n\t\t\t}\r\n\t\t}\r\n\t\t// skip point if it has not elevation\r\n\t\tif (!isNaN(z)) {\r\n\t\t\teleMax = eleMax < z ? z : eleMax;\r\n\t\t\teleMin = eleMin > z ? z : eleMin;\r\n\t\t\tthis._lastValidZ = z;\r\n\t\t}\r\n\r\n\t\tthis.track_info.elevation_max = this._maxElevation = eleMax;\r\n\t\tthis.track_info.elevation_min = this._minElevation = eleMin;\r\n\t});\r\n\r\n\tthis.on(\"elechart_legend\", function() {\r\n\t\tthis._altitudeLegend = this._chart._legend.append('g')\r\n\t\t\t.call(\r\n\t\t\t\tD3.LegendItem({\r\n\t\t\t\t\tname: 'Altitude',\r\n\t\t\t\t\twidth: this._width(),\r\n\t\t\t\t\theight: this._height(),\r\n\t\t\t\t\tmargins: this.options.margins,\r\n\t\t\t\t})\r\n\t\t\t);\r\n\t});\r\n\r\n\tthis.on(\"elechart_summary\", function() {\r\n\t\tthis.summaryDiv.innerHTML +=\r\n\t\t\t'<span class=\"totlen\"><span class=\"summarylabel\">' + L._(\"Total Length: \") + '</span><span class=\"summaryvalue\">' + this.track_info.distance.toFixed(2) + '&nbsp;' + this._xLabel + '</span></span>' +\r\n\t\t\t'<span class=\"maxele\"><span class=\"summarylabel\">' + L._(\"Max Elevation: \") + '</span><span class=\"summaryvalue\">' + this.track_info.elevation_max.toFixed(2) + '&nbsp;' + this._yLabel + '</span></span>' +\r\n\t\t\t'<span class=\"minele\"><span class=\"summarylabel\">' + L._(\"Min Elevation: \") + '</span><span class=\"summaryvalue\">' + this.track_info.elevation_min.toFixed(2) + '&nbsp;' + this._yLabel + '</span></span>';\r\n\t});\r\n\r\n\tthis.on(\"eledata_clear\", function() {\r\n\t\tthis._maxElevation = null;\r\n\t\tthis._minElevation = null;\r\n\t});\r\n\r\n});\r\n","import 'leaflet-i18n';\r\nimport * as _ from './utils';\r\nimport * as D3 from './components';\r\nimport { Elevation } from './control';\r\n\r\nElevation.addInitHook(function() {\r\n\r\n\tif (!this.options.slope) return;\r\n\r\n\tlet opts = this.options;\r\n\tlet slope = {};\r\n\topts.margins.right = 50;\r\n\r\n\tif (this.options.slope != \"summary\") {\r\n\r\n\t\tthis.on(\"elechart_init\", function() {\r\n\t\t\tslope.path = this._chart._area.append('path')\r\n\t\t\t\t.style(\"pointer-events\", \"none\")\r\n\t\t\t\t// TODO: add a class here.\r\n\t\t\t\t.attr(\"fill\", \"#F00\")\r\n\t\t\t\t.attr(\"stroke\", \"#000\")\r\n\t\t\t\t.attr(\"stroke-opacity\", \"0.5\")\r\n\t\t\t\t.attr(\"fill-opacity\", \"0.25\");\r\n\t\t});\r\n\r\n\t\tthis.on(\"elechart_axis\", function() {\r\n\t\t\tslope.x = this._chart._x;\r\n\r\n\t\t\t// slope.x = D3.Scale({\r\n\t\t\t// \tdata: this._data,\r\n\t\t\t// \trange: [0, this._width()],\r\n\t\t\t// \tattr: opts.xAttr,\r\n\t\t\t// \tmin: opts.xAxisMin,\r\n\t\t\t// \tmax: opts.xAxisMax,\r\n\t\t\t// \tforceBounds: opts.forceAxisBounds,\r\n\t\t\t// });\r\n\r\n\t\t\tslope.y = D3.Scale({\r\n\t\t\t\tdata: this._data,\r\n\t\t\t\trange: [this._height(), 0],\r\n\t\t\t\tattr: \"slope\",\r\n\t\t\t\tmin: -1,\r\n\t\t\t\tmax: +1,\r\n\t\t\t\tforceBounds: opts.forceAxisBounds,\r\n\t\t\t});\r\n\r\n\t\t\tslope.axis = D3.Axis({\r\n\t\t\t\taxis: \"y\",\r\n\t\t\t\tposition: \"right\",\r\n\t\t\t\twidth: this._width(),\r\n\t\t\t\theight: this._height(),\r\n\t\t\t\tscale: slope.y,\r\n\t\t\t\tticks: this.options.yTicks,\r\n\t\t\t\ttickPadding: 16,\r\n\t\t\t\tlabel: \"%\",\r\n\t\t\t\tlabelX: 25,\r\n\t\t\t\tlabelY: 3,\r\n\t\t\t});\r\n\r\n\t\t\tthis._chart._axis.call(slope.axis);\r\n\t\t});\r\n\r\n\t\tthis.on(\"elechart_updated\", function() {\r\n\t\t\tslope.area = D3.Area({\r\n\t\t\t\tinterpolation: opts.sInterpolation,\r\n\t\t\t\tdata: this._data,\r\n\t\t\t\tname: 'Slope',\r\n\t\t\t\txAttr: opts.xAttr,\r\n\t\t\t\tyAttr: \"slope\",\r\n\t\t\t\twidth: this._width(),\r\n\t\t\t\theight: this._height(),\r\n\t\t\t\tscaleX: slope.x,\r\n\t\t\t\tscaleY: slope.y,\r\n\t\t\t});\r\n\r\n\t\t\tslope.path.call(slope.area);\r\n\t\t});\r\n\r\n\t\tthis.on(\"elechart_legend\", function() {\r\n\t\t\tslope.legend = this._chart._legend.append(\"g\")\r\n\t\t\t\t.call(\r\n\t\t\t\t\tD3.LegendItem({\r\n\t\t\t\t\t\tname: 'Slope',\r\n\t\t\t\t\t\twidth: this._width(),\r\n\t\t\t\t\t\theight: this._height(),\r\n\t\t\t\t\t\tmargins: this.options.margins,\r\n\t\t\t\t\t})\r\n\t\t\t\t);\r\n\r\n\t\t\tthis._altitudeLegend\r\n\t\t\t\t.attr(\"transform\", \"translate(-50, 0)\");\r\n\r\n\t\t\tslope.legend\r\n\t\t\t\t.attr(\"transform\", \"translate(50, 0)\");\r\n\r\n\t\t\tslope.legend.select(\"rect\")\r\n\t\t\t\t.classed(\"area\", false)\r\n\t\t\t\t// TODO: add a class here.\r\n\t\t\t\t.attr(\"fill\", \"#F00\")\r\n\t\t\t\t.attr(\"stroke\", \"#000\")\r\n\t\t\t\t.attr(\"stroke-opacity\", \"0.5\")\r\n\t\t\t\t.attr(\"fill-opacity\", \"0.25\");\r\n\r\n\t\t});\r\n\t}\r\n\r\n\tthis.on(\"eledata_updated\", function(e) {\r\n\t\tlet data = this._data;\r\n\t\tlet i = e.index;\r\n\t\tlet z = data[i].z;\r\n\r\n\t\tlet curr = data[i].latlng;\r\n\t\tlet prev = i > 0 ? data[i - 1].latlng : curr;\r\n\r\n\t\tlet delta = curr.distanceTo(prev) * this._distanceFactor;\r\n\r\n\t\t// Slope / Gain\r\n\t\tlet tAsc = this._tAsc || 0; // Total Ascent\r\n\t\tlet tDes = this._tDes || 0; // Total Descent\r\n\t\tlet sMax = this._sMax || 0; // Slope Max\r\n\t\tlet sMin = this._sMin || 0; // Slope Min\r\n\t\tlet slope = 0;\r\n\r\n\t\tif (!isNaN(z)) {\r\n\t\t\tlet deltaZ = i > 0 ? z - data[i - 1].z : 0;\r\n\t\t\tif (deltaZ > 0) tAsc += deltaZ;\r\n\t\t\telse if (deltaZ < 0) tDes -= deltaZ;\r\n\t\t\t// slope in % = ( height / length ) * 100\r\n\t\t\tslope = delta !== 0 ? (deltaZ / delta) * 100 : 0;\r\n\t\t}\r\n\r\n\t\t// Try to smooth \"crazy\" slope values.\r\n\t\tif (this.options.sDeltaMax) {\r\n\t\t\tlet deltaS = i > 0 ? slope - data[i - 1].slope : 0;\r\n\t\t\tlet maxDeltaS = this.options.sDeltaMax;\r\n\t\t\tif (Math.abs(deltaS) > maxDeltaS) {\r\n\t\t\t\tslope = data[i - 1].slope + maxDeltaS * Math.sign(deltaS);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Range of acceptable slope values.\r\n\t\tif (this.options.sRange) {\r\n\t\t\tlet range = this.options.sRange;\r\n\t\t\tif (slope < range[0]) slope = range[0];\r\n\t\t\telse if (slope > range[1]) slope = range[1];\r\n\t\t}\r\n\r\n\t\tslope = L.Util.formatNum(slope, 2);\r\n\r\n\t\tsMax = slope > sMax ? slope : sMax;\r\n\t\tsMin = slope < sMin ? slope : sMin;\r\n\r\n\t\tdata[i].slope = slope;\r\n\r\n\t\tthis.track_info.ascent = this._tAsc = tAsc;\r\n\t\tthis.track_info.descent = this._tDes = tDes;\r\n\t\tthis.track_info.slope_max = this._sMax = sMax;\r\n\t\tthis.track_info.slope_min = this._sMin = sMin;\r\n\t});\r\n\r\n\tthis.on(\"elechart_change\", function(e) {\r\n\t\tlet item = e.data;\r\n\t\tlet xCoordinate = e.xCoord;\r\n\t\tlet chart = this._chart;\r\n\r\n\t\tif (chart._focuslabel) {\r\n\t\t\tif (!chart._focuslabelSlope || !chart._focuslabelSlope.property('isConnected')) {\r\n\t\t\t\tchart._focuslabelSlope = chart._focuslabel.select('text').insert(\"svg:tspan\", \".mouse-focus-label-x\")\r\n\t\t\t\t\t.attr(\"class\", \"mouse-focus-label-slope\")\r\n\t\t\t\t\t.attr(\"dy\", \"1.5em\");\r\n\t\t\t}\r\n\r\n\t\t\tchart._focuslabelSlope.text(item.slope + \"%\");\r\n\r\n\t\t\tchart._focuslabel.select('.mouse-focus-label-x')\r\n\t\t\t\t.attr(\"dy\", \"1.5em\");\r\n\t\t}\r\n\r\n\t\tif (chart._mouseHeightFocusLabel) {\r\n\t\t\tif (!chart._mouseSlopeFocusLabel) {\r\n\t\t\t\tchart._mouseSlopeFocusLabel = chart._mouseHeightFocusLabel.append(\"svg:tspan\")\r\n\t\t\t\t\t.attr(\"class\", \"height-focus-slope \");\r\n\t\t\t}\r\n\r\n\t\t\tchart._mouseSlopeFocusLabel\r\n\t\t\t\t.attr(\"dy\", \"1.5em\")\r\n\t\t\t\t.text(Math.round(item.slope) + \"%\");\r\n\r\n\t\t\tchart._mouseHeightFocusLabel.select('.height-focus-y')\r\n\t\t\t\t.attr(\"dy\", \"-1.5em\");\r\n\t\t}\r\n\t});\r\n\r\n\tthis.on(\"elechart_summary\", function() {\r\n\t\tthis.track_info.ascent = this._tAsc || 0;\r\n\t\tthis.track_info.descent = this._tDes || 0;\r\n\t\tthis.track_info.slope_max = this._sMax || 0;\r\n\t\tthis.track_info.slope_min = this._sMin || 0;\r\n\r\n\t\tthis.summaryDiv.querySelector('.minele').insertAdjacentHTML('afterend', '<span class=\"ascent\"><span class=\"summarylabel\">' + L._(\"Total Ascent: \") + '</span><span class=\"summaryvalue\">' + Math.round(this.track_info.ascent) + '&nbsp;' +\r\n\t\t\tthis._yLabel +\r\n\t\t\t'</span></span>' + '<span class=\"descent\"><span class=\"summarylabel\">' + L._(\"Total Descent: \") + '</span><span class=\"summaryvalue\">' + Math.round(this.track_info.descent) + '&nbsp;' + this._yLabel +\r\n\t\t\t'</span></span>' + '<span class=\"minslope\"><span class=\"summarylabel\">' + L._(\"Min Slope: \") + '</span><span class=\"summaryvalue\">' + this.track_info.slope_min + '&nbsp;' + '%' +\r\n\t\t\t'</span></span>' + '<span class=\"maxslope\"><span class=\"summarylabel\">' + L._(\"Max Slope: \") + '</span><span class=\"summaryvalue\">' + this.track_info.slope_max + '&nbsp;' + '%' +\r\n\t\t\t'</span></span>');\r\n\t});\r\n\r\n\tthis.on(\"eledata_clear\", function() {\r\n\t\tthis._sMax = null;\r\n\t\tthis._sMin = null;\r\n\t\tthis._tAsc = null;\r\n\t\tthis._tDes = null;\r\n\t});\r\n\r\n});\r\n","/*\r\n * Copyright (c) 2019, GPL-3.0+ Project, Raruto\r\n *\r\n *  This file is free software: you may copy, redistribute and/or modify it\r\n *  under the terms of the GNU General Public License as published by the\r\n *  Free Software Foundation, either version 2 of the License, or (at your\r\n *  option) any later version.\r\n *\r\n *  This file is distributed in the hope that it will be useful, but\r\n *  WITHOUT ANY WARRANTY; without even the implied warranty of\r\n *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\r\n *  General Public License for more details.\r\n *\r\n *  You should have received a copy of the GNU General Public License\r\n *  along with this program.  If not, see .\r\n *\r\n * This file incorporates work covered by the following copyright and\r\n * permission notice:\r\n *\r\n *     Copyright (c) 2013-2016, MIT License, Felix “MrMufflon” Bache\r\n *\r\n *     Permission to use, copy, modify, and/or distribute this software\r\n *     for any purpose with or without fee is hereby granted, provided\r\n *     that the above copyright notice and this permission notice appear\r\n *     in all copies.\r\n *\r\n *     THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL\r\n *     WARRANTIES WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED\r\n *     WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE\r\n *     AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR\r\n *     CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS\r\n *     OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT,\r\n *     NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN\r\n *     CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.\r\n */\r\n\r\nimport 'leaflet-i18n';\r\nimport * as _ from './utils';\r\nimport * as D3 from './components';\r\nimport { Chart } from './chart';\r\nimport { Elevation } from './control';\r\nimport './altitude';\r\nimport './slope';\r\n\r\nElevation.Utils = _;\r\nElevation.Components = D3;\r\nElevation.Chart = Chart;\r\n\r\nL.control.elevation = (options) => new Elevation(options);\r\n"],"names":["factory","window","define","amd","exports","module","require","L","locales","locale","registerLocale","code","Util","extend","setLocale","i18n","_","translate","string","data","template","err","deepMerge","target","sources","length","source","shift","isObject","key","Object","assign","deferFunc","f","document","readyState","addEventListener","once","formatNum","num","dec","sep","toFixed","toString","split","join","GeoJSONLoader","control","JSON","parse","layer","geoJson","style","feature","options","polyline","theme","className","pointToLayer","latlng","marker","icon","gpxOptions","marker_options","wptIcons","desc","properties","name","bindPopup","openPopup","fire","point","point_type","element","onEachFeature","geometry","type","addData","track_info","Control","Elevation","_d3LazyLoader","then","_fireEvt","GPXLoader","polyline_options","GPX","on","e","line","get_name","isDomVisible","elem","offsetWidth","offsetHeight","getClientRects","item","Array","isArray","isVisible","styles","getComputedStyle","isVisibleByStyles","visibility","display","isAboveOtherElements","boundingRect","getBoundingClientRect","left","right","top","bottom","above","pointerEvents","elementFromPoint","isJSONDoc","doc","lazy","trim","indexOf","console","warn","isXMLDoc","documentElement","ownerDocument","nodeName","lazyLoader","url","skip","loader","Promise","resolve","reject","tag","createElement","src","head","appendChild","loadFile","success","xhr","XMLHttpRequest","responseType","open","onload","response","onerror","status","send","saveFile","dataURI","fileName","a","create","href","download","b","body","click","removeChild","waitHolder","ticking","scrollFn","requestAnimFrame","removeEventListener","addClass","targetNode","each","s","DomUtil","removeClass","toggleClass","conditional","call","value","getStyle","setProperty","tagName","attributes","parent","setAttributes","append","child","insert","position","insertAdjacentElement","attrs","k","setAttribute","select","selector","context","querySelector","DomEvent","off","hasClass","randomId","Math","random","substr","obj","fn","i","Area","xAttr","yAttr","scaleX","scaleY","height","interpolation","path","d3","area","curve","x","d","xDiagCoord","y0","y1","datum","attr","AreaPath","props","Axis","tickSize","tickPadding","width","axis","scale","ticks","tickFormat","label","labelX","labelY","g","w","h","axisScale","replace","l","toUpperCase","axisGroup","text","DragRectangle","dragStartCoords","dragEndCoords","rect","x1","min","x2","max","FocusRect","Grid","HeightFocusLine","xCoord","yCoord","HeightFocusLabel","y","node","selectAll","HeightFocusMarker","circle","LegendItem","margins","toLowerCase","MouseFocusLine","MouseFocusLabel","xAlign","yAlign","bbox","getBBox","Browser","webkit","Infinity","Scale","forceBounds","range","domain","extent","scaleLinear","Bisect","bisector","invert","Chart","Class","includes","Evented","prototype","Mixin","Events","initialize","opts","_data","_draggingEnabled","dragging","imperial","_xLabel","_yLabel","xLabel","yLabel","_xTicks","xTicks","_yTicks","yTicks","_updateScale","svg","_container","_appendGrid","_appendAxis","_appendAreaPath","_appendFocusable","_appendLegend","_grid","_area","_path","_axis","_focus","_focusRect","_legend","_x","_y","update","_updateAxis","_updateAreaPath","render","container","clear","_resetDrag","D3","_width","xAxisMin","xAxisMax","forceAxisBounds","_height","yAxisMin","yAxisMax","remove","_appendXGrid","_appendYGrid","_appendXaxis","_appendYaxis","_appendFocusRect","_appendMouseFocusG","focusRect","mobile","_dragStartHandler","bind","_dragHandler","_mousemoveHandler","_dragEndHandler","_mouseenterHandler","_mouseoutHandler","focusG","_focusG","_focusline","_focuslabel","legend","event","preventDefault","stopPropagation","_gotDragged","_drawDragRectangle","_dragStartCoords","mouse","_dragRectangle","_dragCurrentCoords","start","_findIndexForXCoord","end","dragstart","dragend","ctx","coords","_findIndexForLatLng","_hideDiagramIndicator","_showDiagramIndicator","xCoordinate","yCoordinate","classed","decimalsX","decimalsY","Marker","_focusmarker","_marker","markerIcon","zIndexOffset","interactive","addTo","map","_map","getPane","pane","_latlng","latLngToLayerPoint","normalizedAlt","maxElevation","z","normalizedY","getElement","setLatLng","getLatLng","Summary","summary","reset","innerHTML","Options","autohide","autohideMarker","collapsed","detached","distanceFactor","downloadLink","elevationDiv","followMarker","async","startIconUrl","endIconUrl","shadowUrl","divIcon","html","iconSize","iconAnchor","heightFactor","lazyLoadJS","loadData","defer","placeholder","color","opacity","weight","lineCap","reverseCoords","skipNullZCoords","responsive","slope","sDeltaMax","undefined","sInterpolation","sRange","zFollow","_layers","featureGroup","_chartEnabled","__mileFactor","__footFactor","__D3","__LGPX","_addData","_addLayer","eleDiv","_initElevationDiv","isConnected","getContainer","onAdd","_chart","clearLayers","_distance","disableDragging","enableDragging","fitBounds","bounds","getBounds","isValid","latLngBounds","getZFollow","_zFollow","hide","_distanceFactor","_heightFactor","_setMapView","throttle","load","loadChart","loadDefer","loadLazy","loadGPX","loadGeoJSON","_downloadURL","catch","_gpxLazyLoader","parentNode","alt","_initButton","_initChart","_initSummary","_initMarker","_initLayer","_hideMarker","_resetView","_resizeChart","_updateChart","_updateSummary","onRemove","redraw","setZFollow","zoom","show","geom","feat","gpx","_latlngs","_addGeoJSONData","coordinates","features","_addGPXData","_addPoint","lat","lng","meta","ele","dist","curr","LatLng","prev","delta","distanceTo","round","push","distance","index","addLayer","id","_collapse","_expand","_findItemForLatLng","_findItemForX","propagate","offWi","offHe","_maxWidth","containerWidth","clientWidth","chart","_dragendHandler","toggleEvt","_mousemoveLayerHandler","_pane","createPane","zIndex","_renderer","disableClickPropagation","_mousewheelHandler","link","_button","title","stop","_toggle","_summary","summaryDiv","_updateMarker","gestureHandling","_enabled","ll","getCenter","getZoom","sign","deltaY","flyTo","_isFullscreen","newWidth","removeControl","setView","animate","duration","_maxElevation","elevation_max","elevation_min","_minElevation","onclick","confirm","addInitHook","p","pop","_popup","_content","decodeURI","bindTooltip","direction","sticky","openTooltip","enable","nodes","eachLayer","n","getAttribute","CustomEvent","dispatchEvent","detail","eleMax","eleMin","prevZ","isNaN","lastZ","_lastValidZ","currZ","splice","_altitudeLegend","tAsc","_tAsc","tDes","_tDes","sMax","_sMax","sMin","_sMin","deltaZ","deltaS","maxDeltaS","abs","ascent","descent","slope_max","slope_min","_focuslabelSlope","property","_mouseHeightFocusLabel","_mouseSlopeFocusLabel","insertAdjacentHTML","Utils","Components","elevation"],"mappings":"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"}