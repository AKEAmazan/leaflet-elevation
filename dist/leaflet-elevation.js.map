{"version":3,"file":"leaflet-elevation.js","sources":["../node_modules/leaflet-i18n/Leaflet.i18n.js","../src/utils.js","../src/components.js","../src/chart.js","../src/marker.js","../src/summary.js","../src/options.js","../src/control.js","../src/altitude.js","../src/slope.js","../src/index.js"],"sourcesContent":["// Following https://github.com/Leaflet/Leaflet/blob/master/PLUGIN-GUIDE.md\n(function (factory, window) {\n\n    // define an AMD module that relies on 'leaflet'\n    if (typeof define === 'function' && define.amd) {\n        define(['leaflet'], factory);\n\n        // define a Common JS module that relies on 'leaflet'\n    } else if (typeof exports === 'object') {\n        module.exports = factory(require('leaflet'));\n    }\n\n    // attach your plugin to the global 'L' variable\n    if (typeof window !== 'undefined' && window.L) {\n        factory(window.L);\n\n    }\n}(function (L) {\n    L.locales = {};\n    L.locale = null;\n    L.registerLocale = function registerLocale(code, locale) {\n        L.locales[code] = L.Util.extend({}, L.locales[code], locale);\n    };\n    L.setLocale = function setLocale(code) {\n        L.locale = code;\n    };\n    return L.i18n = L._ = function translate(string, data) {\n        if (L.locale && L.locales[L.locale] && L.locales[L.locale][string]) {\n            string = L.locales[L.locale][string];\n        }\n        try {\n            // Do not fail if some data is missing\n            // a bad translation should not break the app\n            string = L.Util.template(string, data);\n        }\n        catch (err) {/*pass*/\n        }\n\n        return string;\n    };\n}, window));\n","/**\r\n * Recursive deep merge objects.\r\n * Alternative to L.Util.setOptions(this, options).\r\n */\r\nexport function deepMerge(target, ...sources) {\r\n\tif (!sources.length) return target;\r\n\tconst source = sources.shift();\r\n\tif (isObject(target) && isObject(source)) {\r\n\t\tfor (const key in source) {\r\n\t\t\tif (isObject(source[key])) {\r\n\t\t\t\tif (!target[key]) Object.assign(target, {\r\n\t\t\t\t\t[key]: {}\r\n\t\t\t\t});\r\n\t\t\t\tdeepMerge(target[key], source[key]);\r\n\t\t\t} else {\r\n\t\t\t\tObject.assign(target, {\r\n\t\t\t\t\t[key]: source[key]\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn deepMerge(target, ...sources);\r\n}\r\n\r\n/**\r\n * Wait for document load before execute function.\r\n */\r\nexport function deferFunc(f) {\r\n\tif (document.readyState !== 'complete') window.addEventListener(\"load\", f, { once: true });\r\n\telse f();\r\n}\r\n\r\n/*\r\n * Formatting funciton using the given decimals and seperator.\r\n */\r\nexport function formatter(num, dec, sep) {\r\n\tlet res = L.Util.formatNum(num, dec).toString();\r\n\tlet numbers = res.split(\".\");\r\n\tif (numbers[1]) {\r\n\t\tfor (let d = dec - numbers[1].length; d > 0; d--) {\r\n\t\t\tnumbers[1] += \"0\";\r\n\t\t}\r\n\t\tres = numbers.join(sep || \".\");\r\n\t}\r\n\treturn res;\r\n}\r\n\r\n/**\r\n * Simple GeoJSON data loader.\r\n */\r\nexport function GeoJSONLoader(data, control) {\r\n\tif (typeof data === \"string\") {\r\n\t\tdata = JSON.parse(data);\r\n\t}\r\n\tcontrol = control || this;\r\n\r\n\tlet layer = L.geoJson(data, {\r\n\t\tstyle: (feature) => {\r\n\t\t\tlet style = L.extend({}, control.options.polyline);\r\n\t\t\tif (control.options.theme) {\r\n\t\t\t\tstyle.className += ' ' + control.options.theme;\r\n\t\t\t}\r\n\t\t\treturn style;\r\n\t\t},\r\n\t\tpointToLayer: (feature, latlng) => {\r\n\t\t\tlet marker = L.marker(latlng, { icon: control.options.gpxOptions.marker_options.wptIcons[''] });\r\n\t\t\tlet desc = feature.properties.desc ? feature.properties.desc : '';\r\n\t\t\tlet name = feature.properties.name ? feature.properties.name : '';\r\n\t\t\tif (name || desc) {\r\n\t\t\t\tmarker.bindPopup(\"<b>\" + name + \"</b>\" + (desc.length > 0 ? '<br>' + desc : '')).openPopup();\r\n\t\t\t}\r\n\t\t\tcontrol.fire('waypoint_added', { point: marker, point_type: 'waypoint', element: latlng });\r\n\t\t\treturn marker;\r\n\t\t},\r\n\t\tonEachFeature: (feature, layer) => {\r\n\t\t\tif (feature.geometry.type == 'Point') return;\r\n\r\n\t\t\tcontrol.addData(feature, layer);\r\n\r\n\t\t\tcontrol.track_info = L.extend({}, control.track_info, { type: \"geojson\", name: data.name });\r\n\t\t},\r\n\t});\r\n\r\n\tL.Control.Elevation._d3LazyLoader.then(() => {\r\n\t\tcontrol._fireEvt(\"eledata_loaded\", { data: data, layer: layer, name: control.track_info.name, track_info: control.track_info })\r\n\t});\r\n\r\n\treturn layer;\r\n}\r\n\r\n/**\r\n * Simple GPX data loader.\r\n */\r\nexport function GPXLoader(data, control) {\r\n\tcontrol = control || this;\r\n\r\n\tcontrol.options.gpxOptions.polyline_options = L.extend({}, control.options.polyline, control.options.gpxOptions.polyline_options);\r\n\r\n\tif (control.options.theme) {\r\n\t\tcontrol.options.gpxOptions.polyline_options.className += ' ' + control.options.theme;\r\n\t}\r\n\r\n\tlet layer = new L.GPX(data, control.options.gpxOptions);\r\n\r\n\t// similar to L.GeoJSON.pointToLayer\r\n\tlayer.on('addpoint', (e) => {\r\n\t\tcontrol.fire(\"waypoint_added\", e);\r\n\t});\r\n\r\n\t// similar to L.GeoJSON.onEachFeature\r\n\tlayer.on(\"addline\", (e) => {\r\n\t\tcontrol.addData(e.line /*, layer*/ );\r\n\t\tcontrol.track_info = L.extend({}, control.track_info, { type: \"gpx\", name: layer.get_name() });\r\n\t});\r\n\r\n\t// unlike the L.GeoJSON, L.GPX parsing is async\r\n\tlayer.once('loaded', (e) => {\r\n\t\tL.Control.Elevation._d3LazyLoader.then(() => {\r\n\t\t\tcontrol._fireEvt(\"eledata_loaded\", { data: data, layer: layer, name: control.track_info.name, track_info: control.track_info });\r\n\t\t});\r\n\t});\r\n\r\n\treturn layer;\r\n}\r\n\r\n/**\r\n * Check DOM element visibility.\r\n */\r\nexport function isDomVisible(elem) {\r\n\treturn !!(elem.offsetWidth || elem.offsetHeight || elem.getClientRects().length);\r\n}\r\n\r\n/**\r\n * Check object type.\r\n */\r\nexport function isObject(item) {\r\n\treturn (item && typeof item === 'object' && !Array.isArray(item));\r\n}\r\n\r\n/**\r\n * Check DOM element viewport visibility.\r\n */\r\nexport function isVisible(elem) {\r\n\tif (!elem) return false;\r\n\r\n\tlet styles = window.getComputedStyle(elem);\r\n\r\n\tfunction isVisibleByStyles(elem, styles) {\r\n\t\treturn styles.visibility !== 'hidden' && styles.display !== 'none';\r\n\t}\r\n\r\n\tfunction isAboveOtherElements(elem, styles) {\r\n\t\tlet boundingRect = elem.getBoundingClientRect();\r\n\t\tlet left = boundingRect.left + 1;\r\n\t\tlet right = boundingRect.right - 1;\r\n\t\tlet top = boundingRect.top + 1;\r\n\t\tlet bottom = boundingRect.bottom - 1;\r\n\t\tlet above = true;\r\n\r\n\t\tlet pointerEvents = elem.style.pointerEvents;\r\n\r\n\t\tif (styles['pointer-events'] == 'none') elem.style.pointerEvents = 'auto';\r\n\r\n\t\tif (document.elementFromPoint(left, top) !== elem) above = false;\r\n\t\tif (document.elementFromPoint(right, top) !== elem) above = false;\r\n\r\n\t\t// Only for completely visible elements\r\n\t\t// if (document.elementFromPoint(left, bottom) !== elem) above = false;\r\n\t\t// if (document.elementFromPoint(right, bottom) !== elem) above = false;\r\n\r\n\t\telem.style.pointerEvents = pointerEvents;\r\n\r\n\t\treturn above;\r\n\t}\r\n\r\n\tif (!isVisibleByStyles(elem, styles)) return false;\r\n\tif (!isAboveOtherElements(elem, styles)) return false;\r\n\treturn true;\r\n}\r\n\r\n/**\r\n * Check JSON object type.\r\n */\r\nexport function isJSONDoc(doc, lazy) {\r\n\tlazy = typeof lazy === \"undefined\" ? true : lazy;\r\n\tif (typeof doc === \"string\" && lazy) {\r\n\t\tdoc = doc.trim();\r\n\t\treturn doc.indexOf(\"{\") == 0 || doc.indexOf(\"[\") == 0;\r\n\t} else {\r\n\t\ttry {\r\n\t\t\tJSON.parse(doc.toString());\r\n\t\t} catch (e) {\r\n\t\t\tif (typeof doc === \"object\" && lazy) return true;\r\n\t\t\tconsole.warn(e);\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n}\r\n\r\n/**\r\n * Check XML object type.\r\n */\r\nexport function isXMLDoc(doc, lazy) {\r\n\tlazy = typeof lazy === \"undefined\" ? true : lazy;\r\n\tif (typeof doc === \"string\" && lazy) {\r\n\t\tdoc = doc.trim();\r\n\t\treturn doc.indexOf(\"<\") == 0;\r\n\t} else {\r\n\t\tlet documentElement = (doc ? doc.ownerDocument || doc : 0).documentElement;\r\n\t\treturn documentElement ? documentElement.nodeName !== \"HTML\" : false;\r\n\t}\r\n}\r\n\r\n/**\r\n * Async JS script download.\r\n */\r\nexport function lazyLoader(url, skip, loader) {\r\n\tif (skip === false) {\r\n\t\treturn Promise.resolve();\r\n\t}\r\n\tif (loader instanceof Promise) {\r\n\t\treturn loader;\r\n\t}\r\n\treturn new Promise((resolve, reject) => {\r\n\t\tlet tag = document.createElement(\"script\");\r\n\t\ttag.addEventListener('load', resolve, { once: true });\r\n\t\ttag.src = url;\r\n\t\tdocument.head.appendChild(tag);\r\n\t});\r\n}\r\n\r\n/**\r\n * Download data from a remote url.\r\n */\r\nexport function loadFile(url, success) {\r\n\treturn new Promise((resolve, reject) => {\r\n\t\tlet xhr = new XMLHttpRequest();\r\n\t\txhr.responseType = \"text\";\r\n\t\txhr.open('GET', url);\r\n\t\txhr.onload = () => resolve(xhr.response);\r\n\t\txhr.onerror = () => reject(\"Error \" + xhr.status + \" while fetching remote file: \" + url);\r\n\t\txhr.send();\r\n\t});\r\n}\r\n\r\n/**\r\n * Generate download data event.\r\n */\r\nexport function saveFile(dataURI, fileName) {\r\n\tlet a = create('a', '', { href: dataURI, target: '_new', download: fileName || \"\", style: \"display:none;\" });\r\n\tlet b = document.body;\r\n\tb.appendChild(a);\r\n\ta.click();\r\n\tb.removeChild(a);\r\n}\r\n\r\n/**\r\n * Wait for element visible before execute function.\r\n */\r\nexport function waitHolder(elem) {\r\n\treturn new Promise((resolve, reject) => {\r\n\t\tlet ticking = false;\r\n\t\tlet scrollFn = () => {\r\n\t\t\tif (!ticking) {\r\n\t\t\t\tL.Util.requestAnimFrame(() => {\r\n\t\t\t\t\tif (isVisible(elem)) {\r\n\t\t\t\t\t\twindow.removeEventListener('scroll', scrollFn);\r\n\t\t\t\t\t\tresolve();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tticking = false;\r\n\t\t\t\t});\r\n\t\t\t\tticking = true;\r\n\t\t\t}\r\n\t\t};\r\n\t\twindow.addEventListener('scroll', scrollFn);\r\n\t\tif (elem) elem.addEventListener('mouseenter', scrollFn, { once: true });\r\n\t\tscrollFn();\r\n\t});\r\n}\r\n\r\n/**\r\n * A little bit safier than L.DomUtil.addClass\r\n */\r\nexport function addClass(targetNode, className) {\r\n\teach(className.split(\" \"), s => { if (targetNode && className) L.DomUtil.addClass(targetNode, s); });\r\n}\r\n\r\n/**\r\n * A little bit safier than L.DomUtil.removeClass()\r\n */\r\nexport function removeClass(targetNode, className) {\r\n\teach(className.split(\" \"), s => { if (targetNode && className) L.DomUtil.removeClass(targetNode, s); });\r\n}\r\n\r\nexport function toggleClass(targetNode, className, conditional) {\r\n\treturn (conditional ? addClass : removeClass).call(null, targetNode, className)\r\n}\r\n\r\nexport function style(targetNode, name, value) {\r\n\tif (typeof value === \"undefined\") return L.DomUtil.getStyle(targetNode, name);\r\n\telse return targetNode.style.setProperty(name, value);\r\n}\r\n\r\n/**\r\n * A little bit shorter than L.DomUtil.create()\r\n */\r\nexport function create(tagName, className, attributes, parent) {\r\n\tlet elem = L.DomUtil.create(tagName, className || \"\");\r\n\tif (attributes) setAttributes(elem, attributes);\r\n\tif (parent) append(parent, elem);\r\n\treturn elem;\r\n}\r\n\r\n/**\r\n * Same as node.appendChild()\r\n */\r\nexport function append(parent, child) {\r\n\treturn parent.appendChild(child);\r\n}\r\n\r\n/**\r\n * Same as node.insertAdjacentElement()\r\n */\r\nexport function insert(parent, child, position) {\r\n\treturn parent.insertAdjacentElement(position, child);\r\n}\r\n\r\n/**\r\n * Loop for node.setAttribute()\r\n */\r\nexport function setAttributes(elem, attrs) {\r\n\tfor (let k in attrs) { elem.setAttribute(k, attrs[k]); }\r\n}\r\n\r\n/**\r\n * Same as node.querySelector().\r\n */\r\nexport function select(selector, context) {\r\n\treturn (context || document).querySelector(selector);\r\n}\r\n\r\n/**\r\n * Alias for L.DomEvent.on.\r\n */\r\nexport const on = L.DomEvent.on;\r\n\r\n/**\r\n * Alias for L.DomEvent.off.\r\n */\r\nexport const off = L.DomEvent.off;\r\n\r\n/**\r\n * Alias for L.DomUtil.hasClass.\r\n */\r\nexport const hasClass = L.DomUtil.hasClass;\r\n\r\n\r\nexport function randomId() {\r\n\treturn Math.random().toString(36).substr(2, 9);\r\n}\r\n\r\nexport function each(obj, fn) {\r\n\tfor (let i in obj) fn(obj[i], i);\r\n}\r\n","export const Area = ({\r\n\tdata,\r\n\tname,\r\n\txAttr,\r\n\tyAttr,\r\n\tscaleX,\r\n\tscaleY,\r\n\theight,\r\n\tinterpolation = \"curveLinear\",\r\n}) => {\r\n\treturn path => {\r\n\t\tif (typeof interpolation === 'string') interpolation = d3[interpolation];\r\n\r\n\t\tlet area = d3.area().curve(interpolation)\r\n\t\t\t.x(d => (d.xDiagCoord = scaleX(d[xAttr])))\r\n\t\t\t.y0(height)\r\n\t\t\t.y1(d => scaleY(d[yAttr]));\r\n\r\n\t\tif (data) path.datum(data).attr(\"d\", area);\r\n\t\tif (name) path.attr('data-name', name);\r\n\r\n\t\treturn area;\r\n\t};\r\n};\r\n\r\nexport const AreaPath = (props) => {\r\n\treturn d3.create('svg:path')\r\n\t\t.attr(\"class\", \"area\")\r\n\t\t.call(Area(props));\r\n};\r\n\r\nexport const Axis = ({\r\n\ttype = \"axis\",\r\n\ttickSize = 6,\r\n\ttickPadding = 3,\r\n\tposition,\r\n\theight,\r\n\twidth,\r\n\taxis,\r\n\tscale,\r\n\tticks,\r\n\ttickFormat,\r\n\tlabel,\r\n\tlabelX,\r\n\tlabelY\r\n}) => {\r\n\treturn g => {\r\n\t\tlet [w, h] = [0, 0];\r\n\t\tif (position == \"bottom\") h = height;\r\n\t\tif (position == \"right\") w = width;\r\n\r\n\t\tif (axis == \"x\" && type == \"grid\") {\r\n\t\t\ttickSize = -height;\r\n\t\t} else if (axis == \"y\" && type == \"grid\") {\r\n\t\t\ttickSize = -width;\r\n\t\t}\r\n\r\n\t\tlet axisScale = d3[\"axis\" + position.replace(/\\b\\w/g, l => l.toUpperCase())]()\r\n\t\t\t.scale(scale)\r\n\t\t\t.ticks(ticks)\r\n\t\t\t.tickPadding(tickPadding)\r\n\t\t\t.tickSize(tickSize)\r\n\t\t\t.tickFormat(tickFormat);\r\n\r\n\t\tlet axisGroup = g.append(\"g\")\r\n\t\t\t.attr(\"class\", [axis, type, position].join(\" \"))\r\n\t\t\t.attr(\"transform\", \"translate(\" + w + \",\" + h + \")\")\r\n\t\t\t.call(axisScale);\r\n\r\n\t\tif (label) {\r\n\t\t\taxisGroup.append(\"text\")\r\n\t\t\t\t.attr(\"x\", labelX)\r\n\t\t\t\t.attr(\"y\", labelY)\r\n\t\t\t\t.text(label);\r\n\t\t}\r\n\r\n\t\treturn axisGroup;\r\n\t};\r\n};\r\n\r\nexport const DragRectangle = ({\r\n\tdragStartCoords,\r\n\tdragEndCoords,\r\n\theight,\r\n}) => {\r\n\treturn rect => {\r\n\t\tlet x1 = Math.min(dragStartCoords[0], dragEndCoords[0]);\r\n\t\tlet x2 = Math.max(dragStartCoords[0], dragEndCoords[0]);\r\n\r\n\t\treturn rect\r\n\t\t\t.attr(\"width\", x2 - x1)\r\n\t\t\t.attr(\"height\", height)\r\n\t\t\t.attr(\"x\", x1);\r\n\t};\r\n};\r\n\r\nexport const FocusRect = ({\r\n\twidth,\r\n\theight,\r\n}) => {\r\n\treturn rect => rect\r\n\t\t.attr(\"width\", width)\r\n\t\t.attr(\"height\", height)\r\n\t\t.style(\"fill\", \"none\")\r\n\t\t.style(\"stroke\", \"none\")\r\n\t\t.style(\"pointer-events\", \"all\");\r\n};\r\n\r\nexport const Grid = (props) => {\r\n\tprops.type = \"grid\";\r\n\treturn Axis(props);\r\n};\r\n\r\nexport const HeightFocusLine = ({\r\n\ttheme,\r\n\txCoord = 0,\r\n\tyCoord = 0,\r\n\tlength = 0,\r\n}) => {\r\n\treturn line => line\r\n\t\t.attr(\"class\", theme + \" height-focus line\")\r\n\t\t.attr(\"x1\", xCoord)\r\n\t\t.attr(\"x2\", xCoord)\r\n\t\t.attr(\"y1\", yCoord)\r\n\t\t.attr(\"y2\", length);\r\n};\r\n\r\nexport const HeightFocusLabel = ({\r\n\ttheme,\r\n\txCoord = 0,\r\n\tyCoord = 0,\r\n\tlabel,\r\n}) => {\r\n\treturn text => {\r\n\t\ttext\r\n\t\t\t.attr(\"class\", theme + \" height-focus-label\")\r\n\t\t\t.style(\"pointer-events\", \"none\")\r\n\t\t\t.attr(\"x\", xCoord + 5)\r\n\t\t\t.attr(\"y\", yCoord);\r\n\r\n\t\tlet y = text.select(\".height-focus-y\");\r\n\t\tif (!y.node()) y = text.append(\"svg:tspan\");\r\n\r\n\t\ty\r\n\t\t\t.attr(\"class\", \"height-focus-y\")\r\n\t\t\t.text(label);\r\n\r\n\t\ttext.selectAll('tspan').attr(\"x\", xCoord + 5);\r\n\r\n\t\treturn text;\r\n\t};\r\n};\r\n\r\nexport const HeightFocusPoint = ({\r\n\ttheme,\r\n\txCoord = 0,\r\n\tyCoord = 0,\r\n}) => {\r\n\treturn circle => circle\r\n\t\t.attr(\"class\", theme + \" height-focus circle-lower\")\r\n\t\t.attr(\"transform\", \"translate(\" + xCoord + \",\" + yCoord + \")\")\r\n\t\t.attr(\"r\", 6)\r\n\t\t.attr(\"cx\", 0)\r\n\t\t.attr(\"cy\", 0);\r\n};\r\n\r\n\r\nexport const LegendItem = ({\r\n\tname,\r\n\twidth,\r\n\theight,\r\n\tmargins = {},\r\n}) => {\r\n\treturn g => {\r\n\t\tg\r\n\t\t\t.attr(\"class\", \"legend-item legend-\" + name.toLowerCase())\r\n\t\t\t.attr(\"data-name\", name);\r\n\r\n\t\tg.append(\"rect\")\r\n\t\t\t.attr(\"class\", \"area\")\r\n\t\t\t.attr(\"x\", (width / 2) - 50)\r\n\t\t\t.attr(\"y\", height + margins.bottom / 2)\r\n\t\t\t.attr(\"width\", 50)\r\n\t\t\t.attr(\"height\", 10)\r\n\t\t\t.attr(\"opacity\", 0.75);\r\n\r\n\t\tg.append('text')\r\n\t\t\t.text(L._(name))\r\n\t\t\t.attr(\"x\", (width / 2) + 5)\r\n\t\t\t.attr(\"font-size\", 10)\r\n\t\t\t.style(\"text-decoration-thickness\", \"2px\")\r\n\t\t\t.style(\"font-weight\", \"700\")\r\n\t\t\t.attr('y', height + margins.bottom / 2)\r\n\t\t\t.attr('dy', \"0.75em\");\r\n\r\n\t\treturn g;\r\n\t}\r\n};\r\n\r\nexport const MouseFocusLine = ({\r\n\txCoord = 0,\r\n\theight,\r\n}) => {\r\n\treturn line => line\r\n\t\t.attr('class', 'mouse-focus-line')\r\n\t\t.attr('x2', xCoord)\r\n\t\t.attr('y2', 0)\r\n\t\t.attr('x1', xCoord)\r\n\t\t.attr('y1', height);\r\n};\r\n\r\nexport const MouseFocusLabel = ({\r\n\txCoord,\r\n\tyCoord,\r\n\tlabelX = \"\",\r\n\tlabelY = \"\",\r\n\twidth,\r\n}) => {\r\n\treturn g => {\r\n\r\n\t\tg.attr('class', 'mouse-focus-label');\r\n\r\n\t\tlet rect = g.select(\".mouse-focus-label-rect\");\r\n\t\tlet text = g.select(\".mouse-focus-label-text\");\r\n\t\tlet y = text.select(\".mouse-focus-label-y\");\r\n\t\tlet x = text.select(\".mouse-focus-label-x\");\r\n\r\n\t\tif (!rect.node()) rect = g.append(\"rect\");\r\n\t\tif (!text.node()) text = g.append(\"svg:text\");\r\n\t\tif (!y.node()) y = text.append(\"svg:tspan\");\r\n\t\tif (!x.node()) x = text.append(\"svg:tspan\");\r\n\r\n\t\ty.text(labelY);\r\n\t\tx.text(labelX);\r\n\r\n\t\t// Sets focus-label-text position to the left / right of the mouse-focus-line\r\n\t\tlet xAlign = 0;\r\n\t\tlet yAlign = 0;\r\n\t\tlet bbox = { width: 0, height: 0 };\r\n\t\ttry { bbox = text.node().getBBox(); } catch (e) { return g; }\r\n\r\n\t\tif (xCoord) xAlign = xCoord + (xCoord < width / 2 ? 10 : -bbox.width - 10);\r\n\t\tif (yCoord) yAlign = Math.max(yCoord - bbox.height, L.Browser.webkit ? 0 : -Infinity);\r\n\r\n\t\trect\r\n\t\t\t.attr(\"class\", \"mouse-focus-label-rect\")\r\n\t\t\t.attr(\"x\", xAlign - 5)\r\n\t\t\t.attr(\"y\", yAlign - 5)\r\n\t\t\t.attr(\"width\", bbox.width + 10)\r\n\t\t\t.attr(\"height\", bbox.height + 10)\r\n\t\t\t.attr(\"rx\", 3)\r\n\t\t\t.attr(\"ry\", 3);\r\n\t\ttext\r\n\t\t\t.attr(\"class\", \"mouse-focus-label-text\")\r\n\t\t\t.style(\"font-weight\", \"700\")\r\n\t\t\t.attr(\"y\", yAlign);\r\n\t\ty\r\n\t\t\t.attr(\"class\", \"mouse-focus-label-y\")\r\n\t\t\t.attr(\"dy\", \"1em\");\r\n\t\tx\r\n\t\t\t.attr(\"class\", \"mouse-focus-label-x\")\r\n\t\t\t.attr(\"dy\", \"2em\");\r\n\r\n\t\ttext.selectAll('tspan').attr(\"x\", xAlign);\r\n\r\n\t\treturn g;\r\n\t};\r\n};\r\n\r\nexport const Scale = ({\r\n\tdata,\r\n\tattr,\r\n\tmin,\r\n\tforceBounds,\r\n\trange,\r\n}) => {\r\n\tlet domain = data ? d3.extent(data, d => d[attr]) : [0, 1];\r\n\tif (typeof min !== \"undefined\" && (min < domain[0] || forceBounds)) {\r\n\t\tdomain[0] = min;\r\n\t}\r\n\tif (typeof max !== \"undefined\" && (max > domain[1] || forceBounds)) {\r\n\t\tdomain[1] = max;\r\n\t}\r\n\treturn d3.scaleLinear()\r\n\t\t.range(range)\r\n\t\t.domain(domain);\r\n};\r\n\r\nexport const Bisect = ({\r\n\tdata = [0, 1],\r\n\tscale,\r\n\tx,\r\n\tattr\r\n}) => {\r\n\treturn d3\r\n\t\t.bisector(d => d[attr])\r\n\t\t.left(data, scale.invert(x));\r\n};\r\n","import 'leaflet-i18n';\r\nimport * as _ from './utils';\r\nimport * as D3 from './components';\r\n\r\nexport var Chart = L.Class.extend({\r\n\r\n\tincludes: L.Evented ? L.Evented.prototype : L.Mixin.Events,\r\n\r\n\tinitialize: function(options) {\r\n\t\tlet opts = this.options = options;\r\n\r\n\t\tthis._data = [];\r\n\t\tthis._draggingEnabled = opts.dragging;\r\n\r\n\t\tif (this.options.imperial) {\r\n\t\t\t// this._distanceFactor = this.__mileFactor;\r\n\t\t\t// this._heightFactor = this.__footFactor;\r\n\t\t\tthis._xLabel = \"mi\";\r\n\t\t\tthis._yLabel = \"ft\";\r\n\t\t} else {\r\n\t\t\t// this._distanceFactor = this.options.distanceFactor;\r\n\t\t\t// this._heightFactor = this.options.heightFactor;\r\n\t\t\tthis._xLabel = this.options.xLabel;\r\n\t\t\tthis._yLabel = this.options.yLabel;\r\n\t\t}\r\n\r\n\t\tthis._xTicks = opts.xTicks;\r\n\t\tthis._yTicks = opts.yTicks;\r\n\r\n\t\tlet scale = this._updateScale();\r\n\r\n\t\tlet svg = this._svg = d3.create(\"svg\")\r\n\t\t\t.attr(\"class\", \"background\")\r\n\t\t\t.attr(\"width\", opts.width)\r\n\t\t\t.attr(\"height\", opts.height);\r\n\r\n\t\tlet g = svg\r\n\t\t\t.append(\"g\")\r\n\t\t\t.attr(\"transform\", \"translate(\" + opts.margins.left + \",\" + opts.margins.top + \")\")\r\n\t\t\t.call(this._appendGrid())\r\n\t\t\t.call(this._appendAxis())\r\n\t\t\t.call(this._appendAreaPath())\r\n\t\t\t.call(this._appendFocusable())\r\n\t\t\t.call(this._appendLegend());\r\n\r\n\t\tthis._grid = svg.select('.grid');\r\n\t\tthis._area = svg.select('.area');\r\n\t\tthis._path = svg.select('.area path');\r\n\t\tthis._axis = svg.select('.axis');\r\n\t\tthis._focus = svg.select('.focus');\r\n\t\tthis._focusRect = this._focus.select('rect');\r\n\t\tthis._legend = svg.select('.legend');\r\n\t\tthis._x = scale.x;\r\n\t\tthis._y = scale.y;\r\n\r\n\t},\r\n\r\n\tupdate: function(props) {\r\n\t\tif (props.data) this._data = props.data;\r\n\t\tif (props.options) this.options = props.options;\r\n\r\n\t\tthis._updateScale();\r\n\t\tthis._updateAxis();\r\n\t\tthis._updateAreaPath();\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\trender: function() {\r\n\t\treturn container => container.append(() => this._svg.node());\r\n\t},\r\n\r\n\t_updateScale: function() {\r\n\t\tlet opts = this.options;\r\n\r\n\t\tthis._x = D3.Scale({\r\n\t\t\tdata: this._data,\r\n\t\t\trange: [0, this._width()],\r\n\t\t\tattr: opts.xAttr,\r\n\t\t\tmin: opts.xAxisMin,\r\n\t\t\tmax: opts.xAxisMax,\r\n\t\t\tforceBounds: opts.forceAxisBounds,\r\n\t\t});\r\n\r\n\t\tthis._y = D3.Scale({\r\n\t\t\tdata: this._data,\r\n\t\t\trange: [this._height(), 0],\r\n\t\t\tattr: opts.yAttr,\r\n\t\t\tmin: opts.yAxisMin,\r\n\t\t\tmax: opts.yAxisMax,\r\n\t\t\tforceBounds: opts.forceAxisBounds,\r\n\t\t});\r\n\r\n\t\treturn { x: this._x, y: this._y };\r\n\t},\r\n\r\n\t/**\r\n\t * Update chart axis.\r\n\t */\r\n\t_updateAxis: function() {\r\n\t\tthis._grid.selectAll('g').remove();\r\n\t\tthis._axis.selectAll('g').remove();\r\n\t\tthis._grid\r\n\t\t\t.call(this._appendXGrid())\r\n\t\t\t.call(this._appendYGrid());\r\n\t\tthis._axis\r\n\t\t\t.call(this._appendXaxis())\r\n\t\t\t.call(this._appendYaxis());\r\n\r\n\t\t// this.fire('axis_updated');\r\n\t},\r\n\r\n\t_updateAreaPath: function() {\r\n\t\tlet opts = this.options;\r\n\t\tthis._path\r\n\t\t\t.call(\r\n\t\t\t\tD3.Area({\r\n\t\t\t\t\tinterpolation: opts.interpolation,\r\n\t\t\t\t\tdata: this._data,\r\n\t\t\t\t\tname: 'Altitude',\r\n\t\t\t\t\txAttr: opts.xAttr,\r\n\t\t\t\t\tyAttr: opts.yAttr,\r\n\t\t\t\t\twidth: this._width(),\r\n\t\t\t\t\theight: this._height(),\r\n\t\t\t\t\tscaleX: this._x,\r\n\t\t\t\t\tscaleY: this._y,\r\n\t\t\t\t})\r\n\t\t\t);\r\n\t},\r\n\r\n\t/**\r\n\t * Generate \"grid\".\r\n\t */\r\n\t_appendGrid: function() {\r\n\t\treturn g =>\r\n\t\t\tg.append(\"g\")\r\n\t\t\t.attr(\"class\", \"grid\")\r\n\t\t\t.call(this._appendXGrid())\r\n\t\t\t.call(this._appendYGrid());\r\n\t},\r\n\r\n\t/**\r\n\t * Generate \"x-grid\".\r\n\t */\r\n\t_appendXGrid: function() {\r\n\t\treturn D3.Grid({\r\n\t\t\taxis: \"x\",\r\n\t\t\tposition: \"bottom\",\r\n\t\t\twidth: this._width(),\r\n\t\t\theight: this._height(),\r\n\t\t\tscale: this._x,\r\n\t\t\tticks: this._xTicks,\r\n\t\t\ttickFormat: \"\",\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Generate \"y-grid\".\r\n\t */\r\n\t_appendYGrid: function() {\r\n\t\treturn D3.Grid({\r\n\t\t\taxis: \"y\",\r\n\t\t\tposition: \"left\",\r\n\t\t\twidth: this._width(),\r\n\t\t\theight: this._height(),\r\n\t\t\tscale: this._y,\r\n\t\t\tticks: this.options.yTicks,\r\n\t\t\ttickFormat: \"\",\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Generate \"axis\".\r\n\t */\r\n\t_appendAxis: function() {\r\n\t\treturn g =>\r\n\t\t\tg.append(\"g\")\r\n\t\t\t.attr(\"class\", \"axis\")\r\n\t\t\t.call(this._appendXaxis())\r\n\t\t\t.call(this._appendYaxis());\r\n\t},\r\n\r\n\t/**\r\n\t * Generate \"x-axis\".\r\n\t */\r\n\t_appendXaxis: function() {\r\n\t\treturn D3.Axis({\r\n\t\t\taxis: \"x\",\r\n\t\t\tposition: \"bottom\",\r\n\t\t\twidth: this._width(),\r\n\t\t\theight: this._height(),\r\n\t\t\tscale: this._x,\r\n\t\t\tticks: this._xTicks,\r\n\t\t\tlabel: this._xLabel,\r\n\t\t\tlabelY: 25,\r\n\t\t\tlabelX: this._width() + 6,\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Generate \"y-axis\".\r\n\t */\r\n\t_appendYaxis: function() {\r\n\t\treturn D3.Axis({\r\n\t\t\taxis: \"y\",\r\n\t\t\tposition: \"left\",\r\n\t\t\twidth: this._width(),\r\n\t\t\theight: this._height(),\r\n\t\t\tscale: this._y,\r\n\t\t\tticks: this.options.yTicks,\r\n\t\t\tlabel: this._yLabel,\r\n\t\t\tlabelX: -25,\r\n\t\t\tlabelY: 3,\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Generate \"path\".\r\n\t */\r\n\t_appendAreaPath: function() {\r\n\t\treturn g => g.append('g')\r\n\t\t\t.attr(\"class\", \"area\")\r\n\t\t\t.append('path');\r\n\t},\r\n\r\n\t_appendFocusable: function() {\r\n\t\treturn g => {\r\n\t\t\treturn g.append('g')\r\n\t\t\t\t.attr(\"class\", 'focus')\r\n\t\t\t\t.call(this._appendFocusRect())\r\n\t\t\t\t.call(this._appendMouseFocusG());\r\n\t\t};\r\n\t},\r\n\r\n\t/**\r\n\t * Generate \"mouse-focus\" and \"drag-rect\".\r\n\t */\r\n\t_appendFocusRect: function() {\r\n\t\treturn g => {\r\n\t\t\tlet focusRect = g.append(\"rect\")\r\n\t\t\t\t.call(\r\n\t\t\t\t\tD3.FocusRect({\r\n\t\t\t\t\t\twidth: this._width(),\r\n\t\t\t\t\t\theight: this._height()\r\n\t\t\t\t\t})\r\n\t\t\t\t);\r\n\r\n\t\t\tif (L.Browser.mobile) {\r\n\t\t\t\tfocusRect\r\n\t\t\t\t\t.on(\"touchstart.drag\", this._dragStartHandler.bind(this))\r\n\t\t\t\t\t.on(\"touchmove.drag\", this._dragHandler.bind(this))\r\n\t\t\t\t\t.on(\"touchstart.focus\", this._mousemoveHandler.bind(this))\r\n\t\t\t\t\t.on(\"touchmove.focus\", this._mousemoveHandler.bind(this));\r\n\t\t\t\tL.DomEvent.on(this._svg.node(), 'touchend', this._dragEndHandler, this);\r\n\t\t\t}\r\n\r\n\t\t\tfocusRect\r\n\t\t\t\t.on(\"mousedown.drag\", this._dragStartHandler.bind(this))\r\n\t\t\t\t.on(\"mousemove.drag\", this._dragHandler.bind(this))\r\n\t\t\t\t.on(\"mouseenter.focus\", this._mouseenterHandler.bind(this))\r\n\t\t\t\t.on(\"mousemove.focus\", this._mousemoveHandler.bind(this))\r\n\t\t\t\t.on(\"mouseout.focus\", this._mouseoutHandler.bind(this));\r\n\t\t\tL.DomEvent.on(this._svg.node(), 'mouseup', this._dragEndHandler, this);\r\n\r\n\t\t\treturn focusRect;\r\n\t\t};\r\n\t},\r\n\r\n\t/**\r\n\t * Generate \"mouse-focus\".\r\n\t */\r\n\t_appendMouseFocusG: function() {\r\n\t\treturn g => {\r\n\t\t\tlet focusG = this._focusG = g.append(\"g\")\r\n\t\t\t\t.attr(\"class\", \"mouse-focus-group hidden\");\r\n\r\n\t\t\tthis._focusline = focusG.append('svg:line')\r\n\t\t\t\t.call(\r\n\t\t\t\t\tD3.MouseFocusLine({\r\n\t\t\t\t\t\txCoord: 0,\r\n\t\t\t\t\t\theight: this._height()\r\n\t\t\t\t\t})\r\n\t\t\t\t);;\r\n\t\t\tthis._focuslabel = focusG.append(\"g\")\r\n\t\t\t\t.call(\r\n\t\t\t\t\tD3.MouseFocusLabel({\r\n\t\t\t\t\t\txCoord: 0,\r\n\t\t\t\t\t\tyCoord: 0,\r\n\t\t\t\t\t\theight: this._height(),\r\n\t\t\t\t\t\twidth: this._width(),\r\n\t\t\t\t\t\tlabelX: \"\",\r\n\t\t\t\t\t\tlabelY: \"\",\r\n\t\t\t\t\t})\r\n\t\t\t\t);\r\n\t\t\treturn focusG;\r\n\t\t};\r\n\t},\r\n\r\n\t/**\r\n\t * Generate \"legend\".\r\n\t */\r\n\t_appendLegend: function() {\r\n\t\treturn g => {\r\n\t\t\t// if (!this.options.legend) return;\r\n\r\n\t\t\tlet legend = g.append('g')\r\n\t\t\t\t.attr(\"class\", \"legend\");\r\n\r\n\t\t\t// this.fire(\"legend\");\r\n\r\n\t\t\t// let items = legend.selectAll('.legend-item')\r\n\t\t\t// \t.on('click', (d, i) => {\r\n\t\t\t// \t\tlet target = items.nodes()[i];\r\n\t\t\t// \t\tlet name = target.getAttribute('data-name');\r\n\t\t\t// \t\tlet path = this._area.select('path[data-name=\"' + name + '\"]').node();\r\n\t\t\t// \t\t// this._fireEvt(\"elepath_toggle\", { path: path, name: name, legend: target });\r\n\t\t\t// \t});\r\n\r\n\t\t\treturn legend;\r\n\t\t};\r\n\t},\r\n\r\n\t/**\r\n\t * Calculates chart width.\r\n\t */\r\n\t_width: function() {\r\n\t\tlet opts = this.options;\r\n\t\treturn opts.width - opts.margins.left - opts.margins.right;\r\n\t},\r\n\r\n\t/**\r\n\t * Calculates chart height.\r\n\t */\r\n\t_height: function() {\r\n\t\tlet opts = this.options;\r\n\t\treturn opts.height - opts.margins.top - opts.margins.bottom;\r\n\t},\r\n\r\n\t/*\r\n\t * Handle drag operations.\r\n\t */\r\n\t_dragHandler: function() {\r\n\t\t//we don't want map events to occur here\r\n\t\td3.event.preventDefault();\r\n\t\td3.event.stopPropagation();\r\n\r\n\t\tthis._gotDragged = true;\r\n\t\tthis._drawDragRectangle();\r\n\t},\r\n\r\n\t/*\r\n\t * Handles start of drag operations.\r\n\t */\r\n\t_dragStartHandler: function() {\r\n\t\td3.event.preventDefault();\r\n\t\td3.event.stopPropagation();\r\n\r\n\t\tthis._gotDragged = false;\r\n\t\tthis._dragStartCoords = d3.mouse(this._focusRect.node());\r\n\t},\r\n\r\n\t/*\r\n\t * Draws the currently dragged rectangle over the chart.\r\n\t */\r\n\t_drawDragRectangle: function() {\r\n\t\tif (!this._dragStartCoords || !this._draggingEnabled) return;\r\n\t\tif (!this._dragRectangle) {\r\n\t\t\tthis._dragRectangle = this._focus.insert(\"rect\", \".mouse-focus-group\")\r\n\t\t\t\t.attr('class', 'mouse-drag')\r\n\t\t\t\t.style(\"pointer-events\", \"none\");\r\n\t\t}\r\n\t\tthis._dragRectangle.call(\r\n\t\t\tD3.DragRectangle({\r\n\t\t\t\tdragStartCoords: this._dragStartCoords,\r\n\t\t\t\tdragEndCoords: this._dragCurrentCoords = d3.mouse(this._focusRect.node()),\r\n\t\t\t\theight: this._height(),\r\n\t\t\t})\r\n\t\t);\r\n\t},\r\n\r\n\t/*\r\n\t * Handles end of drag operations. Zooms the map to the selected items extent.\r\n\t */\r\n\t_dragEndHandler: function() {\r\n\t\tif (!this._dragStartCoords || !this._dragCurrentCoords || !this._gotDragged) {\r\n\t\t\tthis._dragStartCoords = null;\r\n\t\t\tthis._gotDragged = false;\r\n\t\t\tif (this._draggingEnabled) this._resetDrag();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet start = this._findIndexForXCoord(this._dragStartCoords[0]);\r\n\t\tlet end = this._findIndexForXCoord(this._dragCurrentCoords[0]);\r\n\r\n\t\tif (start == end) return;\r\n\r\n\t\tthis._dragStartCoords = null;\r\n\t\tthis._gotDragged = false;\r\n\r\n\t\tthis.fire('dragged', { dragstart: this._data[start], dragend: this._data[end] });\r\n\t},\r\n\r\n\t/*\r\n\t * Handles the moueseenter over the chart.\r\n\t */\r\n\t_mouseenterHandler: function() {\r\n\t\tthis.fire(\"mouse_enter\");\r\n\t},\r\n\r\n\t/*\r\n\t * Handles the moueseover the chart and displays distance and altitude level.\r\n\t */\r\n\t_mousemoveHandler: function(d, i, ctx) {\r\n\t\tlet coords = d3.mouse(this._focusRect.node());\r\n\t\tlet xCoord = coords[0];\r\n\t\tlet item = this._data[this._findIndexForXCoord(xCoord)];\r\n\r\n\t\tthis.fire(\"mouse_move\", { item: item, xCoord: xCoord });\r\n\t},\r\n\r\n\t/*\r\n\t * Handles the moueseout over the chart.\r\n\t */\r\n\t_mouseoutHandler: function() {\r\n\t\tthis.fire(\"mouse_out\");\r\n\t},\r\n\r\n\t/*\r\n\t * Finds a data entry for a given x-coordinate of the diagram\r\n\t */\r\n\t_findIndexForXCoord: function(x) {\r\n\t\treturn d3\r\n\t\t\t.bisector(d => d[this.options.xAttr])\r\n\t\t\t.left(this._data || [0, 1], this._x.invert(x));\r\n\t},\r\n\r\n\t/*\r\n\t * Finds a data entry for a given latlng of the map\r\n\t */\r\n\t_findIndexForLatLng: function(latlng) {\r\n\t\treturn d3\r\n\t\t\t.bisector(d => d.latlng)\r\n\t\t\t.left(this._data, latlng)\r\n\t},\r\n\r\n\t/*\r\n\t * Removes the drag rectangle and zoms back to the total extent of the data.\r\n\t */\r\n\t_resetDrag: function() {\r\n\t\tif (this._dragRectangle) {\r\n\t\t\tthis._dragRectangle.remove();\r\n\t\t\tthis._dragRectangle = null;\r\n\t\t\tthis._hideDiagramIndicator();\r\n\t\t\tthis.fire('reset_drag');\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Display distance and altitude level (\"focus-rect\").\r\n\t */\r\n\t_showDiagramIndicator: function(item, xCoordinate) {\r\n\t\t// if (!this._chartEnabled) return;\r\n\r\n\t\tthis._focusG.classed(\"hidden\", false);\r\n\r\n\t\tlet opts = this.options;\r\n\t\tlet formatter = opts.hoverNumber.formatter;\r\n\t\tlet [fx, fy] = [opts.hoverNumber.decimalsX, opts.hoverNumber.decimalsY];\r\n\t\tlet yCoordinate = this._y(item[opts.yAttr]);\r\n\r\n\t\tthis._focusline.call(\r\n\t\t\tD3.MouseFocusLine({\r\n\t\t\t\txCoord: xCoordinate,\r\n\t\t\t\theight: this._height()\r\n\t\t\t})\r\n\t\t);\r\n\t\tthis._focuslabel.call(\r\n\t\t\tD3.MouseFocusLabel({\r\n\t\t\t\txCoord: xCoordinate,\r\n\t\t\t\tyCoord: yCoordinate,\r\n\t\t\t\theight: this._height(),\r\n\t\t\t\twidth: this._width(),\r\n\t\t\t\tlabelX: formatter(item[opts.xAttr], fx) + \" \" + this._xLabel,\r\n\t\t\t\tlabelY: formatter(item[opts.yAttr], fy) + \" \" + this._yLabel,\r\n\t\t\t})\r\n\t\t);\r\n\t},\r\n\r\n\t_hideDiagramIndicator: function() {\r\n\t\tthis._focusG.classed(\"hidden\", true);\r\n\t},\r\n});\r\n\r\n// Chart.addInitHook(function() {\r\n// \tthis.on('mouse_move', function(e) {\r\n// \t\tif (e.item) this._showDiagramIndicator(e.item, e.xCoord);\r\n// \t});\r\n//\r\n// });\r\n","import 'leaflet-i18n';\r\nimport * as _ from './utils';\r\nimport * as D3 from './components';\r\n\r\nexport var Marker = L.Class.extend({\r\n\r\n\tinitialize: function(options) {\r\n\t\tthis.options = options;\r\n\r\n\t\tif (this.options.imperial) {\r\n\t\t\t// this._distanceFactor = this.__mileFactor;\r\n\t\t\t// this._heightFactor = this.__footFactor;\r\n\t\t\tthis._xLabel = \"mi\";\r\n\t\t\tthis._yLabel = \"ft\";\r\n\t\t} else {\r\n\t\t\t// this._distanceFactor = this.options.distanceFactor;\r\n\t\t\t// this._heightFactor = this.options.heightFactor;\r\n\t\t\tthis._xLabel = this.options.xLabel;\r\n\t\t\tthis._yLabel = this.options.yLabel;\r\n\t\t}\r\n\r\n\t\tif (this.options.marker == 'elevation-line') {\r\n\t\t\tlet g = this._heightG = d3.create(\"g\").attr(\"class\", \"height-focus-group\");\r\n\t\t\tthis._mouseHeightFocus = d3.create('svg:line');\r\n\t\t\tthis._pointG = d3.create(\"svg:circle\");\r\n\t\t\tthis._mouseHeightFocusLabel = d3.create(\"svg:text\");\r\n\t\t} else if (this.options.marker == 'position-marker') {\r\n\t\t\tthis._marker = L.marker([0, 0], { icon: this.options.markerIcon, zIndexOffset: 1000000, interactive: false });\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n\taddTo: function(map) {\r\n\t\tthis._map = map;\r\n\t\tlet pane, renderer;\r\n\t\tif (!map.getPane('elevationPane')) {\r\n\t\t\tpane = this._pane = map.createPane('elevationPane');\r\n\t\t\tpane.style.zIndex = 625; // This pane is above markers but below popups.\r\n\t\t\tpane.style.pointerEvents = 'none';\r\n\t\t}\r\n\t\tif (this.options.marker == 'elevation-line') {\r\n\t\t\trenderer = L.svg({ pane: \"elevationPane\" }).addTo(this._map); // default leaflet svg renderer\r\n\t\t\tlet g = this._heightG = d3.select(renderer.getPane()).select(\"svg > g\").attr(\"class\", \"height-focus-group\");\r\n\t\t\tg.append(() => this._mouseHeightFocus.node());\r\n\t\t\tg.append(() => this._pointG.node());\r\n\t\t\tg.append(() => this._mouseHeightFocusLabel.node());\r\n\t\t} else if (this.options.marker == 'position-marker') {\r\n\t\t\tthis._marker.addTo(map, { pane: 'elevationPane' });\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n\t/**\r\n\t * Update position marker (\"leaflet-marker\").\r\n\t */\r\n\tupdate: function(props) {\r\n\t\tif (props.options) this.options = props.options;\r\n\r\n\t\tlet opts = this.options;\r\n\r\n\t\tif (!this._map) this.addTo(props.map);\r\n\r\n\t\tthis._latlng = props.item.latlng;\r\n\r\n\t\tlet point = L.extend({}, props.item, this._map.latLngToLayerPoint(this._latlng));\r\n\r\n\t\tif (this.options.marker == 'elevation-line') {\r\n\r\n\t\t\tlet formatter = opts.hoverNumber.formatter;\r\n\t\t\tlet fy = opts.hoverNumber.decimalsY;\r\n\r\n\t\t\tlet normalizedAlt = this._height() / props.maxElevation * point.z;\r\n\t\t\tlet normalizedY = point.y - normalizedAlt;\r\n\r\n\t\t\tthis._heightG.classed(\"hidden\", false);\r\n\t\t\tthis._pointG.classed(\"hidden\", false);\r\n\r\n\t\t\tthis._pointG\r\n\t\t\t\t.call(\r\n\t\t\t\t\tD3.HeightFocusPoint({\r\n\t\t\t\t\t\ttheme: this.options.theme,\r\n\t\t\t\t\t\txCoord: point.x,\r\n\t\t\t\t\t\tyCoord: point.y,\r\n\t\t\t\t\t}));\r\n\r\n\t\t\tthis._mouseHeightFocus\r\n\t\t\t\t.call(\r\n\t\t\t\t\tD3.HeightFocusLine({\r\n\t\t\t\t\t\ttheme: this.options.theme,\r\n\t\t\t\t\t\txCoord: point.x,\r\n\t\t\t\t\t\tyCoord: point.y,\r\n\t\t\t\t\t\tlength: normalizedY\r\n\t\t\t\t\t})\r\n\t\t\t\t);\r\n\r\n\t\t\tthis._mouseHeightFocusLabel\r\n\t\t\t\t.call(\r\n\t\t\t\t\tD3.HeightFocusLabel({\r\n\t\t\t\t\t\ttheme: this.options.theme,\r\n\t\t\t\t\t\txCoord: point.x,\r\n\t\t\t\t\t\tyCoord: normalizedY,\r\n\t\t\t\t\t\tlabel: formatter(point[opts.yAttr], fy) + \" \" + this._yLabel\r\n\t\t\t\t\t})\r\n\t\t\t\t);\r\n\t\t} else if (this.options.marker == 'position-marker') {\r\n\t\t\t_.removeClass(this._marker.getElement(), 'hidden');\r\n\t\t\tthis._marker.setLatLng(this._latlng);\r\n\t\t}\r\n\t},\r\n\r\n\t/*\r\n\t * Hides the position/height indicator marker drawn onto the map\r\n\t */\r\n\tremove: function() {\r\n\t\tif (this.options.marker == 'elevation-line') {\r\n\t\t\tif (this._heightG) this._heightG.classed(\"hidden\", true);\r\n\t\t\tif (this._pointG) this._pointG.classed(\"hidden\", true);\r\n\t\t} else if (this.options.marker == 'position-marker') {\r\n\t\t\t_.addClass(this._marker.getElement(), 'hidden');\r\n\t\t}\r\n\t},\r\n\r\n\tgetLatLng: function() {\r\n\t\treturn this._latlng;\r\n\t},\r\n\r\n\t/**\r\n\t * Calculates chart height.\r\n\t */\r\n\t_height: function() {\r\n\t\tlet opts = this.options;\r\n\t\treturn opts.height - opts.margins.top - opts.margins.bottom;\r\n\t},\r\n\r\n});\r\n","import 'leaflet-i18n';\r\nimport * as _ from './utils';\r\nimport * as D3 from './components';\r\n\r\nexport var Summary = L.Class.extend({\r\n\tinitialize: function(options) {\r\n\t\tlet opts = this.options = options;\r\n\r\n\t\tlet summary = this._summary = _.create(\"div\", \"elevation-summary \" + (this.options.summary ? this.options.summary + \"-summary\" : ''), {\r\n\t\t\tstyle: 'max-width:' + this.options.width + 'px'\r\n\t\t});\r\n\t},\r\n\r\n\trender: function() {\r\n\t\treturn container => container.append(() => this._summary);\r\n\t},\r\n\r\n\treset: function(){\r\n\t\tthis._summary.innerHTML = '';\r\n\t}\r\n});\r\n","import * as _ from './utils';\r\n\r\nexport var Options = {\r\n\tautohide: !L.Browser.mobile,\r\n\tautohideMarker: true,\r\n\tcollapsed: false,\r\n\tdetached: true,\r\n\tdistanceFactor: 1,\r\n\tdragging: !L.Browser.mobile,\r\n\tdownloadLink: 'link',\r\n\televationDiv: \"#elevation-div\",\r\n\tfollowMarker: true,\r\n\tforceAxisBounds: false,\r\n\tgpxOptions: {\r\n\t\tasync: true,\r\n\t\tmarker_options: {\r\n\t\t\tstartIconUrl: null,\r\n\t\t\tendIconUrl: null,\r\n\t\t\tshadowUrl: null,\r\n\t\t\twptIcons: {\r\n\t\t\t\t'': L.divIcon({\r\n\t\t\t\t\tclassName: 'elevation-waypoint-marker',\r\n\t\t\t\t\thtml: '<i class=\"elevation-waypoint-icon\"></i>',\r\n\t\t\t\t\ticonSize: [30, 30],\r\n\t\t\t\t\ticonAnchor: [8, 30],\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t},\r\n\t},\r\n\theight: 200,\r\n\theightFactor: 1,\r\n\thoverNumber: {\r\n\t\tdecimalsX: 2,\r\n\t\tdecimalsY: 0,\r\n\t\tformatter: _.formatter,\r\n\t},\r\n\timperial: false,\r\n\tinterpolation: \"curveLinear\",\r\n\tlazyLoadJS: true,\r\n\tlegend: true,\r\n\tloadData: {\r\n\t\tdefer: false,\r\n\t\tlazy: false,\r\n\t},\r\n\tmargins: {\r\n\t\ttop: 10,\r\n\t\tright: 20,\r\n\t\tbottom: 30,\r\n\t\tleft: 50\r\n\t},\r\n\tmarker: 'elevation-line',\r\n\tmarkerIcon: L.divIcon({\r\n\t\tclassName: 'elevation-position-marker',\r\n\t\thtml: '<i class=\"elevation-position-icon\"></i>',\r\n\t\ticonSize: [32, 32],\r\n\t\ticonAnchor: [16, 16],\r\n\t}),\r\n\tplaceholder: false,\r\n\tposition: \"topright\",\r\n\tpolyline: {\r\n\t\tclassName: 'elevation-polyline',\r\n\t\tcolor: '#000',\r\n\t\topacity: 0.75,\r\n\t\tweight: 5,\r\n\t\tlineCap: 'round'\r\n\t},\r\n\treverseCoords: false,\r\n\tskipNullZCoords: false,\r\n\ttheme: \"lightblue-theme\",\r\n\tresponsive: true,\r\n\tsummary: 'inline',\r\n\tslope: false,\r\n\tsDeltaMax: false,\r\n\tsInterpolation: \"curveStepAfter\",\r\n\tsRange: false,\r\n\twidth: 600,\r\n\txAttr: \"dist\",\r\n\txLabel: \"km\",\r\n\txTicks: undefined,\r\n\tyAttr: \"z\",\r\n\tyAxisMax: undefined,\r\n\tyAxisMin: undefined,\r\n\tyLabel: \"m\",\r\n\tyTicks: undefined,\r\n\tzFollow: 13,\r\n};\r\n","import 'leaflet-i18n';\r\nimport * as _ from './utils';\r\nimport * as D3 from './components';\r\nimport { Chart } from './chart';\r\nimport { Marker } from './marker';\r\nimport { Summary } from './summary';\r\nimport { Options } from './options';\r\n\r\nexport const Elevation = L.Control.Elevation = L.Control.extend({\r\n\r\n\tincludes: L.Evented ? L.Evented.prototype : L.Mixin.Events,\r\n\r\n\toptions: Options,\r\n\t_data: [],\r\n\t_layers: L.featureGroup(),\r\n\t_chartEnabled: true,\r\n\t__mileFactor: 0.621371,\r\n\t__footFactor: 3.28084,\r\n\t__D3: 'https://unpkg.com/d3@5.15.0/dist/d3.min.js',\r\n\t__LGPX: 'https://unpkg.com/leaflet-gpx@1.5.0/gpx.js',\r\n\r\n\t/*\r\n\t * Add data to the diagram either from GPX or GeoJSON and update the axis domain and data\r\n\t */\r\n\taddData: function(d, layer) {\r\n\t\tif ((typeof layer === \"undefined\" || layer === null) && d.on) {\r\n\t\t\tlayer = d;\r\n\t\t}\r\n\t\tElevation._d3LazyLoader = _.lazyLoader(\r\n\t\t\tthis.__D3,\r\n\t\t\ttypeof d3 !== 'object' || !this.options.lazyLoadJS,\r\n\t\t\tElevation._d3LazyLoader\r\n\t\t).then(() => {\r\n\t\t\tthis._addData(d);\r\n\t\t\tthis._addLayer(layer);\r\n\t\t\tthis._fireEvt(\"eledata_added\", { data: d, layer: layer, track_info: this.track_info });\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Adds the control to the given map.\r\n\t */\r\n\taddTo: function(map) {\r\n\t\tif (this.options.detached) {\r\n\t\t\tlet eleDiv = this._initElevationDiv();\r\n\t\t\tif (!eleDiv.isConnected) _.insert(map._container, eleDiv, 'afterend');\r\n\t\t\t_.append(eleDiv, this.onAdd(map));\r\n\t\t} else {\r\n\t\t\tL.Control.prototype.addTo.call(this, map);\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n\t/*\r\n\t * Reset data and display\r\n\t */\r\n\tclear: function() {\r\n\t\tthis._marker.remove();\r\n\t\tthis._chart._resetDrag();\r\n\t\tthis._layers.clearLayers();\r\n\r\n\t\tthis._data = [];\r\n\t\tthis._distance = 0;\r\n\t\tthis.track_info = {};\r\n\r\n\t\tthis._fireEvt(\"eledata_clear\");\r\n\t},\r\n\r\n\t/**\r\n\t * Disable dragging chart on touch events.\r\n\t */\r\n\tdisableDragging: function() {\r\n\t\tthis._chart._draggingEnabled = false;\r\n\t\tthis._resetDrag();\r\n\t},\r\n\r\n\t/**\r\n\t * Enable dragging chart on touch events.\r\n\t */\r\n\tenableDragging: function() {\r\n\t\tthis._chart._draggingEnabled = true;\r\n\t},\r\n\r\n\t/**\r\n\t * Sets a map view that contains the given geographical bounds.\r\n\t */\r\n\tfitBounds: function(bounds) {\r\n\t\tbounds = bounds || this.getBounds();\r\n\t\tif (this._map && bounds.isValid()) this._map.fitBounds(bounds);\r\n\t},\r\n\r\n\tgetBounds: function(data) {\r\n\t\tdata = data || this._data;\r\n\t\treturn L.latLngBounds(data.map((d) => d.latlng));\r\n\t},\r\n\r\n\t/**\r\n\t * Get default zoom level when \"followMarker\" is true.\r\n\t */\r\n\tgetZFollow: function() {\r\n\t\treturn this._zFollow;\r\n\t},\r\n\r\n\t/**\r\n\t * Hide current elevation chart profile.\r\n\t */\r\n\thide: function() {\r\n\t\t_.style(this._container, \"display\", \"none\");\r\n\t},\r\n\r\n\t/**\r\n\t * Initialize chart control \"options\" and \"container\".\r\n\t */\r\n\tinitialize: function(options) {\r\n\t\tthis.options = _.deepMerge({}, this.options, options);\r\n\r\n\t\tif (this.options.imperial) {\r\n\t\t\tthis._distanceFactor = this.__mileFactor;\r\n\t\t\tthis._heightFactor = this.__footFactor;\r\n\t\t\tthis._xLabel = \"mi\";\r\n\t\t\tthis._yLabel = \"ft\";\r\n\t\t} else {\r\n\t\t\tthis._distanceFactor = this.options.distanceFactor;\r\n\t\t\tthis._heightFactor = this.options.heightFactor;\r\n\t\t\tthis._xLabel = this.options.xLabel;\r\n\t\t\tthis._yLabel = this.options.yLabel;\r\n\t\t}\r\n\r\n\t\tthis._zFollow = this.options.zFollow;\r\n\r\n\t\tif (this.options.followMarker) this._setMapView = L.Util.throttle(this._setMapView, 300, this);\r\n\t\tif (this.options.placeholder) this.options.loadData.lazy = this.options.loadData.defer = true;\r\n\r\n\t\tif (this.options.legend) this.options.margins.bottom += 30;\r\n\t},\r\n\r\n\t/**\r\n\t * Alias for loadData\r\n\t */\r\n\tload: function(data, opts) {\r\n\t\tthis.loadData(data, opts);\r\n\t},\r\n\r\n\t/**\r\n\t * Alias for addTo\r\n\t */\r\n\tloadChart: function(map) {\r\n\t\tthis.addTo(map);\r\n\t},\r\n\r\n\t/**\r\n\t * Load elevation data (GPX or GeoJSON).\r\n\t */\r\n\tloadData: function(data, opts) {\r\n\t\topts = L.extend({}, this.options.loadData, opts);\r\n\t\tif (opts.defer) {\r\n\t\t\tthis.loadDefer(data, opts);\r\n\t\t} else if (opts.lazy) {\r\n\t\t\tthis.loadLazy(data, opts);\r\n\t\t} else if (_.isXMLDoc(data)) {\r\n\t\t\tthis.loadGPX(data);\r\n\t\t} else if (_.isJSONDoc(data)) {\r\n\t\t\tthis.loadGeoJSON(data);\r\n\t\t} else {\r\n\t\t\tthis.loadFile(data);\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Wait for document load before download data.\r\n\t */\r\n\tloadDefer: function(data, opts) {\r\n\t\topts = L.extend({}, this.options.loadData, opts);\r\n\t\topts.defer = false;\r\n\t\t_.deferFunc(L.bind(this.loadData, this, data, opts));\r\n\t},\r\n\r\n\t/**\r\n\t * Load data from a remote url.\r\n\t */\r\n\tloadFile: function(url) {\r\n\t\t_.loadFile(url)\r\n\t\t\t.then((data) => {\r\n\t\t\t\tthis._downloadURL = url; // TODO: handle multiple urls?\r\n\t\t\t\tthis.loadData(data, { lazy: false, defer: false });\r\n\t\t\t})\r\n\t\t\t.catch((err) => console.warn(err));\r\n\t},\r\n\r\n\t/**\r\n\t * Load raw GeoJSON data.\r\n\t */\r\n\tloadGeoJSON: function(data) {\r\n\t\t_.GeoJSONLoader(data, this);\r\n\t},\r\n\r\n\t/**\r\n\t * Load raw GPX data.\r\n\t */\r\n\tloadGPX: function(data) {\r\n\t\tElevation._gpxLazyLoader = _.lazyLoader(\r\n\t\t\tthis.__LGPX,\r\n\t\t\ttypeof L.GPX !== 'function' || !this.options.lazyLoadJS,\r\n\t\t\tElevation._gpxLazyLoader\r\n\t\t).then(() => _.GPXLoader(data, this));\r\n\t},\r\n\r\n\t/**\r\n\t * Wait for chart container visible before download data.\r\n\t */\r\n\tloadLazy: function(data, opts) {\r\n\t\topts = L.extend({}, this.options.loadData, opts);\r\n\t\tlet elem = opts.lazy.parentNode ? opts.lazy : this.placeholder;\r\n\t\t_.waitHolder(elem)\r\n\t\t\t.then(() => {\r\n\t\t\t\topts.lazy = false;\r\n\t\t\t\tthis.loadData(data, opts)\r\n\t\t\t\tthis.once('eledata_loaded', () => opts.lazy.parentNode.removeChild(elem));\r\n\t\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Create container DOM element and related event listeners.\r\n\t * Called on control.addTo(map).\r\n\t */\r\n\tonAdd: function(map) {\r\n\t\tthis._map = map;\r\n\r\n\t\tlet container = this._container = _.create(\"div\", \"elevation-control elevation \" + this.options.theme);\r\n\r\n\t\tif (!this.options.detached) {\r\n\t\t\t_.addClass(container, 'leaflet-control');\r\n\t\t}\r\n\r\n\t\tif (this.options.placeholder && !this._data.length) {\r\n\t\t\tthis.placeholder = _.create('img', 'elevation-placeholder', typeof this.options.placeholder === 'string' ? { src: this.options.placeholder, alt: '' } : this.options.placeholder);\r\n\t\t\t_.insert(container, this.placeholder, 'beforebegin');\r\n\t\t}\r\n\r\n\t\tElevation._d3LazyLoader = _.lazyLoader(\r\n\t\t\tthis.__D3,\r\n\t\t\ttypeof d3 !== 'object' || !this.options.lazyLoadJS,\r\n\t\t\tElevation._d3LazyLoader\r\n\t\t).then(() => {\r\n\t\t\tthis._initToggle(container);\r\n\t\t\tthis._initChart(container);\r\n\t\t\tthis._initMarker(map);\r\n\t\t\tthis._initLayer(map);\r\n\r\n\t\t\tmap\r\n\t\t\t\t.on('zoom viewreset zoomanim', this._hideMarker, this)\r\n\t\t\t\t.on('resize', this._resetView, this)\r\n\t\t\t\t.on('resize', this._resizeChart, this)\r\n\t\t\t\t.on('mousedown', this._resetDrag, this);\r\n\r\n\t\t\t_.on(map._container, 'mousewheel', this._resetDrag, this);\r\n\t\t\t_.on(map._container, 'touchstart', this._resetDrag, this);\r\n\r\n\t\t\tthis\r\n\t\t\t\t.on('eledata_added eledata_loaded', this._updateChart, this)\r\n\t\t\t\t.on('eledata_added eledata_loaded', this._updateSummary, this);\r\n\r\n\t\t\tthis._updateChart();\r\n\t\t\tthis._updateSummary();\r\n\t\t});\r\n\r\n\t\treturn container;\r\n\t},\r\n\r\n\t/**\r\n\t * Clean up control code and related event listeners.\r\n\t * Called on control.remove().\r\n\t */\r\n\tonRemove: function(map) {\r\n\t\tthis._container = null;\r\n\r\n\t\tmap\r\n\t\t\t.off('zoom viewreset zoomanim', this._hideMarker, this)\r\n\t\t\t.off('resize', this._resetView, this)\r\n\t\t\t.off('resize', this._resizeChart, this)\r\n\t\t\t.off('mousedown', this._resetDrag, this);\r\n\r\n\t\t_.off(map._container, 'mousewheel', this._resetDrag, this);\r\n\t\t_.off(map._container, 'touchstart', this._resetDrag, this);\r\n\r\n\t\tthis\r\n\t\t\t.off('eledata_added eledata_loaded', this._updateChart, this)\r\n\t\t\t.off('eledata_added eledata_loaded', this._updateSummary, this);\r\n\t},\r\n\r\n\t/**\r\n\t * Redraws the chart control. Sometimes useful after screen resize.\r\n\t */\r\n\tredraw: function() {\r\n\t\tthis._resizeChart();\r\n\t},\r\n\r\n\t/**\r\n\t * Set default zoom level when \"followMarker\" is true.\r\n\t */\r\n\tsetZFollow: function(zoom) {\r\n\t\tthis._zFollow = zoom;\r\n\t},\r\n\r\n\t/**\r\n\t * Hide current elevation chart profile.\r\n\t */\r\n\tshow: function() {\r\n\t\t_.style(this._container, \"display\", \"block\");\r\n\t},\r\n\r\n\t/*\r\n\t * Parsing data either from GPX or GeoJSON and update the diagram data\r\n\t */\r\n\t_addData: function(d) {\r\n\t\tlet geom = d && d.geometry;\r\n\t\tlet feat = d && d.type === \"FeatureCollection\";\r\n\t\tlet gpx = d && d._latlngs;\r\n\r\n\t\tif (geom) {\r\n\t\t\tswitch (geom.type) {\r\n\t\t\t\tcase 'LineString':\r\n\t\t\t\t\tthis._addGeoJSONData(geom.coordinates);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'MultiLineString':\r\n\t\t\t\t\t_.each(geom.coordinates, coords => this._addGeoJSONData(coords));\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tconsole.warn('Unsopperted GeoJSON feature geometry type:' + geom.type);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (feat) {\r\n\t\t\t_.each(d.features, feature => this._addData(feature));\r\n\t\t}\r\n\r\n\t\tif (gpx) {\r\n\t\t\tthis._addGPXData(d._latlngs);\r\n\t\t}\r\n\t},\r\n\r\n\t/*\r\n\t * Parsing of GeoJSON data lines and their elevation in z-coordinate\r\n\t */\r\n\t_addGeoJSONData: function(coords) {\r\n\t\t_.each(coords, point => this._addPoint(point[1], point[0], point[2]));\r\n\t},\r\n\r\n\t/*\r\n\t * Parsing function for GPX data and their elevation in z-coordinate\r\n\t */\r\n\t_addGPXData: function(coords) {\r\n\t\t_.each(coords, point => this._addPoint(point.lat, point.lng, point.meta.ele));\r\n\t},\r\n\r\n\t/*\r\n\t * Parse and push a single (x, y, z) point to current elevation profile.\r\n\t */\r\n\t_addPoint: function(x, y, z) {\r\n\t\tif (this.options.reverseCoords) {\r\n\t\t\t[x, y] = [y, x];\r\n\t\t}\r\n\r\n\t\tlet data = this._data || [];\r\n\t\tlet i = data.length;\r\n\t\tlet dist = this._distance || 0;\r\n\r\n\t\tlet curr = new L.LatLng(x, y);\r\n\t\tlet prev = i > 0 ? data[i - 1].latlng : curr;\r\n\r\n\t\tlet delta = curr.distanceTo(prev) * this._distanceFactor;\r\n\r\n\t\tdist = dist + Math.round(delta / 1000 * 100000) / 100000;\r\n\r\n\t\tz = z * this._heightFactor;\r\n\r\n\t\tdata.push({\r\n\t\t\tdist: dist,\r\n\t\t\tx: x,\r\n\t\t\ty: y,\r\n\t\t\tz: z,\r\n\t\t\tlatlng: curr\r\n\t\t});\r\n\r\n\t\tthis._data = data;\r\n\t\tthis.track_info = this.track_info || {};\r\n\t\tthis.track_info.distance = this._distance = dist;\r\n\r\n\t\tthis._fireEvt(\"eledata_updated\", { index: i });\r\n\t},\r\n\r\n\t_addLayer: function(layer) {\r\n\t\tif (layer) this._layers.addLayer(layer)\r\n\t},\r\n\r\n\t/**\r\n\t * Adds the control to the given \"detached\" div.\r\n\t */\r\n\t_initElevationDiv: function() {\r\n\t\tlet eleDiv = _.select(this.options.elevationDiv);\r\n\t\tif (!eleDiv) {\r\n\t\t\tthis.options.elevationDiv = '#elevation-div_' + _.randomId();\r\n\t\t\teleDiv = _.create('div', 'leaflet-control elevation elevation-div', { id: this.options.elevationDiv.substr(1) });\r\n\t\t}\r\n\t\tif (this.options.detached) {\r\n\t\t\t_.addClass(eleDiv, 'elevation-detached');\r\n\t\t\t_.removeClass(eleDiv, 'leaflet-control');\r\n\t\t}\r\n\t\tthis.eleDiv = eleDiv;\r\n\t\treturn this.eleDiv;\r\n\t},\r\n\r\n\t/*\r\n\t * Collapse current chart control.\r\n\t */\r\n\t_collapse: function() {\r\n\t\t_.removeClass(this._container, 'elevation-expanded');\r\n\t\t_.addClass(this._container, 'elevation-collapsed');\r\n\t},\r\n\r\n\t/*\r\n\t * Expand current chart control.\r\n\t */\r\n\t_expand: function() {\r\n\t\t_.removeClass(this._container, 'elevation-collapsed');\r\n\t\t_.addClass(this._container, 'elevation-expanded');\r\n\t},\r\n\r\n\t/*\r\n\t * Finds a data entry for the given LatLng\r\n\t */\r\n\t_findItemForLatLng: function(latlng) {\r\n\t\treturn this._data[this._chart._findIndexForLatLng(latlng)];\r\n\t},\r\n\r\n\t/*\r\n\t * Finds a data entry for the given xDiagCoord\r\n\t */\r\n\t_findItemForX: function(x) {\r\n\t\treturn this._data[this._chart._findIndexForXCoord(x)];\r\n\t},\r\n\r\n\t/**\r\n\t * Fires an event of the specified type.\r\n\t */\r\n\t_fireEvt: function(type, data, propagate) {\r\n\t\tif (this.fire) this.fire(type, data, propagate);\r\n\t\tif (this._map) this._map.fire(type, data, propagate);\r\n\t},\r\n\r\n\t/**\r\n\t * Calculates chart height.\r\n\t */\r\n\t_height: function() {\r\n\t\tlet opts = this.options;\r\n\t\treturn opts.height - opts.margins.top - opts.margins.bottom;\r\n\t},\r\n\r\n\t/*\r\n\t * Hides the position/height indicator marker drawn onto the map\r\n\t */\r\n\t_hideMarker: function() {\r\n\t\tif (this.options.autohideMarker) {\r\n\t\t\tthis._marker.remove();\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Generate \"svg\" chart DOM element.\r\n\t */\r\n\t_initChart: function() {\r\n\t\tlet opts = this.options;\r\n\t\topts.xTicks = opts.xTicks || Math.round(this._width() / 75);\r\n\t\topts.yTicks = opts.yTicks || Math.round(this._height() / 30);\r\n\r\n\t\tif (opts.responsive) {\r\n\t\t\tif (opts.detached) {\r\n\t\t\t\tlet offWi = this.eleDiv.offsetWidth;\r\n\t\t\t\tlet offHe = this.eleDiv.offsetHeight;\r\n\t\t\t\topts.width = offWi > 0 ? offWi : opts.width;\r\n\t\t\t\topts.height = (offHe - 20) > 0 ? offHe - 20 : opts.height; // 20 = horizontal scrollbar size.\r\n\t\t\t} else {\r\n\t\t\t\topts._maxWidth = opts._maxWidth > opts.width ? opts._maxWidth : opts.width;\r\n\t\t\t\tlet containerWidth = this._map._container.clientWidth;\r\n\t\t\t\topts.width = opts._maxWidth > containerWidth ? containerWidth - 30 : opts.width;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet chart = this._chart = new Chart(opts);\r\n\t\tlet summary = this._summary = new Summary(opts);\r\n\r\n\t\tlet container = d3.select(this._container)\r\n\t\t\t.call(chart.render())\r\n\t\t\t.call(summary.render());\r\n\r\n\t\tthis._svg = chart._svg;\r\n\t\tthis._grid = chart._grid;\r\n\t\tthis._area = chart._area;\r\n\t\tthis._path = chart._path;\r\n\t\tthis._axis = chart._axis;\r\n\t\tthis._focus = chart._focus;\r\n\t\tthis._focusRect = chart._focusRect;\r\n\t\tthis._x = chart._x;\r\n\t\tthis._y = chart._y;\r\n\t\tthis._legend = chart._legend;\r\n\t\tthis._focuslabel = chart._focuslabel;\r\n\t\tthis._focusline = chart._focusline;\r\n\t\tthis.summaryDiv = summary._summary;\r\n\r\n\t\tchart\r\n\t\t\t.on('reset_drag', this._hideMarker, this)\r\n\t\t\t.on('mouse_enter', this._fireEvt.bind('elechart_enter'), this)\r\n\t\t\t.on('dragged', this._fireEvt.bind(\"elechart_dragged\"), this)\r\n\t\t\t.on('mouse_move', this._mousemoveHandler, this)\r\n\t\t\t.on('mouse_out', this._mouseoutHandler, this);\r\n\t\t// chart.on('legend', this._fireEvt.bind('elechart_legend'), this);\r\n\r\n\t\tif (this.options.legend) this._fireEvt(\"elechart_legend\");\r\n\r\n\t\tthis._fireEvt(\"elechart_init\");\r\n\t},\r\n\r\n\t_initLayer: function() {\r\n\t\tthis._layers\r\n\t\t\t.on('layeradd layerremove', (e) => {\r\n\t\t\t\tlet layer = e.layer\r\n\t\t\t\tlet toggleClass = e.type == 'layeradd' ? _.addClass : _.removeClass;\r\n\t\t\t\tlet toggleEvt = layer[e.type == 'layeradd' ? \"on\" : \"off\"].bind(layer);\r\n\t\t\t\ttoggleClass(layer.getElement(), this.options.polyline.className + ' ' + this.options.theme);\r\n\t\t\t\ttoggleEvt(\"mousemove\", this._mousemoveLayerHandler, this)\r\n\t\t\t\ttoggleEvt(\"mouseout\", this._mouseoutHandler, this);\r\n\t\t\t});\r\n\t},\r\n\r\n\t_initMarker: function(map) {\r\n\t\tthis._marker = (new Marker(this.options)).addTo(map);\r\n\r\n\t\tthis._mouseHeightFocusLabel = this._marker._mouseHeightFocusLabel;\r\n\t},\r\n\r\n\t/**\r\n\t * Inspired by L.Control.Layers\r\n\t */\r\n\t_initToggle: function(container) {\r\n\t\t//Makes this work on IE10 Touch devices by stopping it from firing a mouseout event when the touch is released\r\n\t\tcontainer.setAttribute('aria-haspopup', true);\r\n\r\n\t\tif (!this.options.detached) {\r\n\t\t\tL.DomEvent\r\n\t\t\t\t.disableClickPropagation(container);\r\n\t\t\t//.disableScrollPropagation(container);\r\n\t\t}\r\n\r\n\t\tif (L.Browser.mobile) {\r\n\t\t\t_.on(container, 'click', L.DomEvent.stopPropagation);\r\n\t\t}\r\n\r\n\t\t_.on(container, 'mousewheel', this._mousewheelHandler, this);\r\n\r\n\t\tif (!this.options.detached) {\r\n\t\t\tlet link = this._button = _.create('a', \"elevation-toggle elevation-toggle-icon\" + (this.options.autohide ? \"\" : \" close-button\"), { href: '#', title: L._('Elevation') }, container);\r\n\r\n\t\t\tif (this.options.collapsed) {\r\n\t\t\t\tthis._collapse();\r\n\t\t\t\tif (this.options.autohide) {\r\n\t\t\t\t\t_.on(container, 'mouseover', this._expand, this);\r\n\t\t\t\t\t_.on(container, 'mouseout', this._collapse, this);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t_.on(link, 'click', L.DomEvent.stop);\r\n\t\t\t\t\t_.on(link, 'click', this._toggle, this);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t_.on(link, 'focus', this._toggle, this);\r\n\r\n\t\t\t\tthis._map.on('click', this._collapse, this);\r\n\t\t\t\t// TODO: keyboard accessibility\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t// TODO: handle autohide when detached=true\r\n\t\t}\r\n\t},\r\n\r\n\t/*\r\n\t * Handles the moueseover the chart and displays distance and altitude level.\r\n\t */\r\n\t_mousemoveHandler: function(e) {\r\n\t\tif (!this._data.length || !this._chartEnabled) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet xCoord = e.xCoord;\r\n\t\tlet item = this._findItemForX(xCoord);\r\n\r\n\t\tif(this._chartEnabled) this._chart._showDiagramIndicator(item, xCoord);\r\n\r\n\t\tthis._updateMarker(item);\r\n\t\tthis._setMapView(item);\r\n\r\n\t\tif (this._map) {\r\n\t\t\t_.addClass(this._map._container, 'elechart-hover');\r\n\t\t}\r\n\r\n\t\tthis._fireEvt(\"elechart_change\", { data: item, xCoord: xCoord });\r\n\t\tthis._fireEvt(\"elechart_hover\", { data: item, xCoord: xCoord });\r\n\t},\r\n\r\n\t/*\r\n\t * Handles mouseover events of the data layers on the map.\r\n\t */\r\n\t_mousemoveLayerHandler: function(e) {\r\n\t\tif (!this._data.length) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet item = this._findItemForLatLng(e.latlng);\r\n\t\tif (item) {\r\n\t\t\tlet xCoord = item.xDiagCoord;\r\n\r\n\t\t\tif (this._chartEnabled) this._chart._showDiagramIndicator(item, xCoord);\r\n\r\n\t\t\tthis._updateMarker(item);\r\n\r\n\t\t\tthis._fireEvt(\"elechart_change\", { data: item, xCoord: xCoord });\r\n\t\t}\r\n\t},\r\n\r\n\t/*\r\n\t * Handles the moueseout over the chart.\r\n\t */\r\n\t_mouseoutHandler: function() {\r\n\t\tif (!this.options.detached) {\r\n\t\t\tthis._hideMarker();\r\n\t\t\tthis._chart._hideDiagramIndicator();\r\n\t\t}\r\n\r\n\t\tif (this._map) {\r\n\t\t\t_.removeClass(this._map._container, 'elechart-hover');\r\n\t\t}\r\n\r\n\t\tthis._fireEvt(\"elechart_leave\");\r\n\t},\r\n\r\n\t/*\r\n\t * Handles the mouesewheel over the chart.\r\n\t */\r\n\t_mousewheelHandler: function(e) {\r\n\t\tif (this._map.gestureHandling && this._map.gestureHandling._enabled) return;\r\n\t\tlet ll = this._marker.getLatLng() || this._map.getCenter();\r\n\t\tlet z = this._map.getZoom() + Math.sign(e.deltaY);\r\n\t\tthis._resetDrag();\r\n\t\tthis._map.flyTo(ll, z);\r\n\t},\r\n\r\n\t/*\r\n\t * Removes the drag rectangle and zoms back to the total extent of the data.\r\n\t */\r\n\t_resetDrag: function() {\r\n\t\tthis._chart._resetDrag();\r\n\t\tthis._hideMarker();\r\n\t},\r\n\r\n\t/**\r\n\t * Resets drag, marker and bounds.\r\n\t */\r\n\t_resetView: function() {\r\n\t\tif (this._map && this._map._isFullscreen) return;\r\n\t\tthis._resetDrag();\r\n\t\tthis._hideMarker();\r\n\t\tthis.fitBounds();\r\n\t},\r\n\r\n\t/**\r\n\t * Hacky way for handling chart resize. Deletes it and redraw chart.\r\n\t */\r\n\t_resizeChart: function() {\r\n\t\t// prevent displaying chart on resize if hidden\r\n\t\tif (_.style(this._container, \"display\") == \"none\") return;\r\n\r\n\t\tif (this.options.responsive) {\r\n\t\t\tif (this.options.detached) {\r\n\t\t\t\tlet newWidth = this.eleDiv.offsetWidth; // - 20;\r\n\t\t\t\tif (newWidth) {\r\n\t\t\t\t\tthis.options.width = newWidth;\r\n\t\t\t\t\tthis.eleDiv.innerHTML = \"\";\r\n\t\t\t\t\t_.append(this.eleDiv, this.onAdd(this._map));\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tthis._map.removeControl(this._container);\r\n\t\t\t\tthis.addTo(this._map);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Collapse or Expand current chart control.\r\n\t */\r\n\t_toggle: function() {\r\n\t\tif (_.hasClass(this._container, \"elevation-expanded\"))\r\n\t\t\tthis._collapse();\r\n\t\telse\r\n\t\t\tthis._expand();\r\n\t},\r\n\r\n\t/**\r\n\t * Sets the view of the map (center and zoom). Useful when \"followMarker\" is true.\r\n\t */\r\n\t_setMapView: function(item) {\r\n\t\tif (!this.options.followMarker || !this._map) return;\r\n\t\tlet zoom = this._map.getZoom();\r\n\t\tzoom = zoom < this._zFollow ? this._zFollow : zoom;\r\n\t\tthis._map.setView(item.latlng, zoom, { animate: true, duration: 0.25 });\r\n\t},\r\n\r\n\t/**\r\n\t * Calculates [x, y] domain and then update chart.\r\n\t */\r\n\t_updateChart: function() {\r\n\t\tif (!this._data.length || !this._container) return;\r\n\r\n\t\tthis._chart = this._chart.update({ data: this._data });\r\n\r\n\t\tthis._x = this._chart._x;\r\n\t\tthis._y = this._chart._y;\r\n\r\n\t\tthis._fireEvt(\"elechart_axis\");\r\n\r\n\t\tthis._fireEvt('elechart_updated');\r\n\t},\r\n\r\n\t/*\r\n\t * Update the position/height indicator marker drawn onto the map\r\n\t */\r\n\t_updateMarker: function(item) {\r\n\t\tthis._marker.update({ item: item, maxElevation: this._maxElevation, options: this.options });\r\n\t},\r\n\r\n\t/**\r\n\t * Update chart summary.\r\n\t */\r\n\t_updateSummary: function() {\r\n\t\tthis.track_info = this.track_info || {};\r\n\t\tthis.track_info.distance = this._distance || 0;\r\n\t\tthis.track_info.elevation_max = this._maxElevation || 0;\r\n\t\tthis.track_info.elevation_min = this._minElevation || 0;\r\n\r\n\t\tthis._summary.reset();\r\n\r\n\t\tif (this.options.summary) {\r\n\t\t\tthis._fireEvt(\"elechart_summary\");\r\n\t\t}\r\n\t\tif (this.options.downloadLink && this._downloadURL) { // TODO: generate dynamically file content instead of using static file urls.\r\n\t\t\tthis.summaryDiv.innerHTML += '<span class=\"download\"><a href=\"#\">' + L._('Download') + '</a></span>'\r\n\t\t\t_.select('.download a', this.summaryDiv).onclick = (e) => {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tthis._fireEvt('eletrack_download', { downloadLink: this.options.downloadLink, confirm: _.saveFile.bind(this, this._downloadURL) });\r\n\t\t\t};\r\n\t\t};\r\n\t},\r\n\r\n\r\n\t/**\r\n\t * Calculates chart width.\r\n\t */\r\n\t_width: function() {\r\n\t\tlet opts = this.options;\r\n\t\treturn opts.width - opts.margins.left - opts.margins.right;\r\n\t},\r\n\r\n});\r\n\r\n/**\r\n * Attach here some useful elevation hooks.\r\n */\r\nElevation.addInitHook(function() {\r\n\r\n\tthis.on('waypoint_added', function(e) {\r\n\t\tlet p = e.point,\r\n\t\t\tpop = p._popup;\r\n\t\tif (pop) {\r\n\t\t\tpop.options.className = 'elevation-popup';\r\n\t\t}\r\n\t\tif (pop._content) {\r\n\t\t\tpop._content = decodeURI(pop._content);\r\n\t\t\tp.bindTooltip(pop._content, { direction: 'top', sticky: true, opacity: 1, className: 'elevation-tooltip' }).openTooltip();\r\n\t\t}\r\n\t});\r\n\r\n\t// autotoggle chart data on click\r\n\tthis.on('elepath_toggle', function(e) {\r\n\t\tlet path = e.path;\r\n\t\tlet enable = _.hasClass(path, 'hidden');\r\n\t\tlet label = _.select('text', e.legend);\r\n\t\tlet rect = _.select('rect', e.legend);\r\n\r\n\t\t_.style(label, \"text-decoration-line\", enable ? \"\" : \"line-through\")\r\n\t\t_.style(rect, \"fill-opacity\", enable ? \"\" : \"0\")\r\n\t\t_.toggleClass(path, 'hidden', !enable);\r\n\r\n\t\tthis._chartEnabled = this._area.selectAll('path:not(.hidden)').nodes().length != 0;\r\n\t\tthis._layers.eachLayer(l => _.toggleClass(l.getElement(), this.options.polyline.className + ' ' + this.options.theme, this._chartEnabled));\r\n\r\n\t\tif (!this._chartEnabled) {\r\n\t\t\tthis._chart._hideDiagramIndicator();\r\n\t\t\tthis._marker.remove();\r\n\t\t}\r\n\t});\r\n\r\n\tthis.on(\"elechart_dragged\", function(e) {\r\n\t\tthis._hideMarker();\r\n\t\tthis.fitBounds(L.latLngBounds([e.dragstart.latlng, e.dragend.latlng]));\r\n\t});\r\n\r\n\tthis.on(\"elechart_updated\", function() {\r\n\t\t// TODO: maybe should i listen for this inside chart.js?\r\n\t\tthis._legend.selectAll('.legend-item')\r\n\t\t\t.on('click', (d, i, n) => {\r\n\t\t\t\tlet target = n[i];\r\n\t\t\t\tlet name = target.getAttribute('data-name');\r\n\t\t\t\tlet path = this._area.select('path[data-name=\"' + name + '\"]').node();\r\n\t\t\t\tthis._fireEvt(\"elepath_toggle\", { path: path, name: name, legend: target });\r\n\t\t\t});\r\n\t});\r\n\r\n\tthis.on(\"eletrack_download\", function(e) {\r\n\t\tif (e.downloadLink == 'modal' && typeof CustomEvent === \"function\") {\r\n\t\t\tdocument.dispatchEvent(new CustomEvent(\"eletrack_download\", { detail: e }));\r\n\t\t} else if (e.downloadLink == 'link' || e.downloadLink === true) {\r\n\t\t\te.confirm();\r\n\t\t}\r\n\t});\r\n\r\n\tthis.on('eledata_loaded', function(e) {\r\n\t\tlet layer = e.layer;\r\n\t\tif (this._map) {\r\n\t\t\tthis._map.once('layeradd', function(e) {\r\n\t\t\t\tthis.fitBounds(layer.getBounds());\r\n\t\t\t}, this);\r\n\t\t\tlayer.addTo(this._map);\r\n\t\t} else {\r\n\t\t\tconsole.warn(\"Undefined elevation map object\");\r\n\t\t}\r\n\t});\r\n\r\n\tthis.on('eledata_clear', function() {\r\n\t\tthis._area.selectAll('path')\r\n\t\t\t.attr(\"d\", \"M0 0\");\r\n\t\tif (this._path) {\r\n\t\t\t// this._x.domain([0, 1]);\r\n\t\t\t// this._y.domain([0, 1]);\r\n\t\t\t// this._updateAxis();\r\n\t\t}\r\n\t});\r\n});\r\n","import 'leaflet-i18n';\r\nimport * as _ from './utils';\r\nimport * as D3 from './components';\r\nimport { Elevation } from './control';\r\n\r\nElevation.addInitHook(function() {\r\n\r\n\tthis.on(\"eledata_updated\", function(e) {\r\n\t\tlet data = this._data;\r\n\t\tlet i = e.index;\r\n\t\tlet z = data[i].z;\r\n\r\n\t\tlet eleMax = this._maxElevation || -Infinity;\r\n\t\tlet eleMin = this._minElevation || +Infinity;\r\n\r\n\t\t// check and fix missing elevation data on last added point\r\n\t\tif (!this.options.skipNullZCoords && i > 0) {\r\n\t\t\tlet prevZ = data[i - 1].z;\r\n\t\t\tif (isNaN(prevZ)) {\r\n\t\t\t\tlet lastZ = this._lastValidZ;\r\n\t\t\t\tlet currZ = z * this._heightFactor;\r\n\t\t\t\tif (!isNaN(lastZ) && !isNaN(currZ)) {\r\n\t\t\t\t\tprevZ = (lastZ + currZ) / 2;\r\n\t\t\t\t} else if (!isNaN(lastZ)) {\r\n\t\t\t\t\tprevZ = lastZ;\r\n\t\t\t\t} else if (!isNaN(currZ)) {\r\n\t\t\t\t\tprevZ = currZ;\r\n\t\t\t\t}\r\n\t\t\t\tif (!isNaN(prevZ)) data[i - 1].z = prevZ;\r\n\t\t\t\telse data.splice(i - 1, 1);\r\n\t\t\t}\r\n\t\t}\r\n\t\t// skip point if it has not elevation\r\n\t\tif (!isNaN(z)) {\r\n\t\t\teleMax = eleMax < z ? z : eleMax;\r\n\t\t\teleMin = eleMin > z ? z : eleMin;\r\n\t\t\tthis._lastValidZ = z;\r\n\t\t}\r\n\r\n\t\tthis.track_info.elevation_max = this._maxElevation = eleMax;\r\n\t\tthis.track_info.elevation_min = this._minElevation = eleMin;\r\n\t});\r\n\r\n\tthis.on(\"elechart_legend\", function() {\r\n\t\tthis._altitudeLegend = this._legend.append('g')\r\n\t\t\t.call(\r\n\t\t\t\tD3.LegendItem({\r\n\t\t\t\t\tname: 'Altitude',\r\n\t\t\t\t\twidth: this._width(),\r\n\t\t\t\t\theight: this._height(),\r\n\t\t\t\t\tmargins: this.options.margins,\r\n\t\t\t\t})\r\n\t\t\t);\r\n\t});\r\n\r\n\tthis.on(\"elechart_summary\", function() {\r\n\t\tthis.summaryDiv.innerHTML +=\r\n\t\t\t'<span class=\"totlen\"><span class=\"summarylabel\">' + L._(\"Total Length: \") + '</span><span class=\"summaryvalue\">' + this.track_info.distance.toFixed(2) + '&nbsp;' + this._xLabel + '</span></span>' +\r\n\t\t\t'<span class=\"maxele\"><span class=\"summarylabel\">' + L._(\"Max Elevation: \") + '</span><span class=\"summaryvalue\">' + this.track_info.elevation_max.toFixed(2) + '&nbsp;' + this._yLabel + '</span></span>' +\r\n\t\t\t'<span class=\"minele\"><span class=\"summarylabel\">' + L._(\"Min Elevation: \") + '</span><span class=\"summaryvalue\">' + this.track_info.elevation_min.toFixed(2) + '&nbsp;' + this._yLabel + '</span></span>';\r\n\t});\r\n\r\n\tthis.on(\"eledata_clear\", function() {\r\n\t\tthis._maxElevation = null;\r\n\t\tthis._minElevation = null;\r\n\t});\r\n\r\n});\r\n","import 'leaflet-i18n';\r\nimport * as _ from './utils';\r\nimport * as D3 from './components';\r\nimport { Elevation } from './control';\r\n\r\nElevation.addInitHook(function() {\r\n\r\n\tif (!this.options.slope) return;\r\n\r\n\tlet opts = this.options;\r\n\tlet slope = {};\r\n\topts.margins.right = 50;\r\n\r\n\tif (this.options.slope != \"summary\") {\r\n\r\n\t\tthis.on(\"elechart_init\", function() {\r\n\t\t\tslope.path = this._area.append('path')\r\n\t\t\t\t.style(\"pointer-events\", \"none\")\r\n\t\t\t\t// TODO: add a class here.\r\n\t\t\t\t.attr(\"fill\", \"#F00\")\r\n\t\t\t\t.attr(\"stroke\", \"#000\")\r\n\t\t\t\t.attr(\"stroke-opacity\", \"0.5\")\r\n\t\t\t\t.attr(\"fill-opacity\", \"0.25\");\r\n\t\t});\r\n\r\n\t\tthis.on(\"elechart_axis\", function() {\r\n\t\t\tslope.x = this._x;\r\n\r\n\t\t\t// slope.x = D3.Scale({\r\n\t\t\t// \tdata: this._data,\r\n\t\t\t// \trange: [0, this._width()],\r\n\t\t\t// \tattr: opts.xAttr,\r\n\t\t\t// \tmin: opts.xAxisMin,\r\n\t\t\t// \tmax: opts.xAxisMax,\r\n\t\t\t// \tforceBounds: opts.forceAxisBounds,\r\n\t\t\t// });\r\n\r\n\t\t\tslope.y = D3.Scale({\r\n\t\t\t\tdata: this._data,\r\n\t\t\t\trange: [this._height(), 0],\r\n\t\t\t\tattr: \"slope\",\r\n\t\t\t\tmin: -1,\r\n\t\t\t\tmax: +1,\r\n\t\t\t\tforceBounds: opts.forceAxisBounds,\r\n\t\t\t});\r\n\r\n\t\t\tslope.axis = D3.Axis({\r\n\t\t\t\taxis: \"y\",\r\n\t\t\t\tposition: \"right\",\r\n\t\t\t\twidth: this._width(),\r\n\t\t\t\theight: this._height(),\r\n\t\t\t\tscale: slope.y,\r\n\t\t\t\tticks: this.options.yTicks,\r\n\t\t\t\ttickPadding: 16,\r\n\t\t\t\tlabel: \"%\",\r\n\t\t\t\tlabelX: 25,\r\n\t\t\t\tlabelY: 3,\r\n\t\t\t});\r\n\r\n\t\t\tthis._axis.call(slope.axis);\r\n\t\t});\r\n\r\n\t\tthis.on(\"elechart_updated\", function() {\r\n\t\t\tslope.area = D3.Area({\r\n\t\t\t\tinterpolation: opts.sInterpolation,\r\n\t\t\t\tdata: this._data,\r\n\t\t\t\tname: 'Slope',\r\n\t\t\t\txAttr: opts.xAttr,\r\n\t\t\t\tyAttr: \"slope\",\r\n\t\t\t\twidth: this._width(),\r\n\t\t\t\theight: this._height(),\r\n\t\t\t\tscaleX: slope.x,\r\n\t\t\t\tscaleY: slope.y,\r\n\t\t\t});\r\n\r\n\t\t\tslope.path.call(slope.area);\r\n\t\t});\r\n\r\n\t\tthis.on(\"elechart_legend\", function() {\r\n\t\t\tslope.legend = this._legend.append(\"g\")\r\n\t\t\t\t.call(\r\n\t\t\t\t\tD3.LegendItem({\r\n\t\t\t\t\t\tname: 'Slope',\r\n\t\t\t\t\t\twidth: this._width(),\r\n\t\t\t\t\t\theight: this._height(),\r\n\t\t\t\t\t\tmargins: this.options.margins,\r\n\t\t\t\t\t})\r\n\t\t\t\t);\r\n\r\n\t\t\tthis._altitudeLegend\r\n\t\t\t\t.attr(\"transform\", \"translate(-50, 0)\");\r\n\r\n\t\t\tslope.legend\r\n\t\t\t\t.attr(\"transform\", \"translate(50, 0)\");\r\n\r\n\t\t\tslope.legend.select(\"rect\")\r\n\t\t\t\t.classed(\"area\", false)\r\n\t\t\t\t// TODO: add a class here.\r\n\t\t\t\t.attr(\"fill\", \"#F00\")\r\n\t\t\t\t.attr(\"stroke\", \"#000\")\r\n\t\t\t\t.attr(\"stroke-opacity\", \"0.5\")\r\n\t\t\t\t.attr(\"fill-opacity\", \"0.25\");\r\n\r\n\t\t});\r\n\t}\r\n\r\n\tthis.on(\"eledata_updated\", function(e) {\r\n\t\tlet data = this._data;\r\n\t\tlet i = e.index;\r\n\t\tlet z = data[i].z;\r\n\r\n\t\tlet curr = data[i].latlng;\r\n\t\tlet prev = i > 0 ? data[i - 1].latlng : curr;\r\n\r\n\t\tlet delta = curr.distanceTo(prev) * this._distanceFactor;\r\n\r\n\t\t// Slope / Gain\r\n\t\tlet tAsc = this._tAsc || 0; // Total Ascent\r\n\t\tlet tDes = this._tDes || 0; // Total Descent\r\n\t\tlet sMax = this._sMax || 0; // Slope Max\r\n\t\tlet sMin = this._sMin || 0; // Slope Min\r\n\t\tlet slope = 0;\r\n\r\n\t\tif (!isNaN(z)) {\r\n\t\t\tlet deltaZ = i > 0 ? z - data[i - 1].z : 0;\r\n\t\t\tif (deltaZ > 0) tAsc += deltaZ;\r\n\t\t\telse if (deltaZ < 0) tDes -= deltaZ;\r\n\t\t\t// slope in % = ( height / length ) * 100\r\n\t\t\tslope = delta !== 0 ? (deltaZ / delta) * 100 : 0;\r\n\t\t}\r\n\r\n\t\tif (this.options.sDeltaMax) {\r\n\t\t\tlet deltaS = i > 0 ? slope - data[i - 1].slope : 0;\r\n\t\t\tlet maxDeltaS = this.options.sDeltaMax;\r\n\t\t\tif (Math.abs(deltaS) > maxDeltaS) {\r\n\t\t\t\tslope = data[i - 1].slope + maxDeltaS * Math.sign(deltaS);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.options.sRange) {\r\n\t\t\tlet range = this.options.sRange;\r\n\t\t\tif (slope < range[0]) slope = range[0];\r\n\t\t\telse if (slope > range[1]) slope = range[1];\r\n\t\t}\r\n\r\n\t\tslope = L.Util.formatNum(slope, 2);\r\n\r\n\t\tsMax = slope > sMax ? slope : sMax;\r\n\t\tsMin = slope < sMin ? slope : sMin;\r\n\r\n\t\tdata[i].slope = slope;\r\n\r\n\t\tthis.track_info.ascent = this._tAsc = tAsc;\r\n\t\tthis.track_info.descent = this._tDes = tDes;\r\n\t\tthis.track_info.slope_max = this._sMax = sMax;\r\n\t\tthis.track_info.slope_min = this._sMin = sMin;\r\n\t});\r\n\r\n\tthis.on(\"elechart_change\", function(e) {\r\n\t\tlet item = e.data;\r\n\t\tlet xCoordinate = e.xCoord;\r\n\r\n\t\tif (this._focuslabel) {\r\n\t\t\tif (!this._focuslabelSlope || !this._focuslabelSlope.property('isConnected')) {\r\n\t\t\t\tthis._focuslabelSlope = this._focuslabel.select('text').insert(\"svg:tspan\", \".mouse-focus-label-x\")\r\n\t\t\t\t\t.attr(\"class\", \"mouse-focus-label-slope\")\r\n\t\t\t\t\t.attr(\"dy\", \"1.5em\");\r\n\t\t\t}\r\n\r\n\t\t\tthis._focuslabelSlope.text(item.slope + \"%\");\r\n\r\n\t\t\tthis._focuslabel.select('.mouse-focus-label-x')\r\n\t\t\t\t.attr(\"dy\", \"1.5em\");\r\n\t\t}\r\n\r\n\t\tif (this._mouseHeightFocusLabel) {\r\n\t\t\tif (!this._mouseSlopeFocusLabel) {\r\n\t\t\t\tthis._mouseSlopeFocusLabel = this._mouseHeightFocusLabel.append(\"svg:tspan\")\r\n\t\t\t\t\t.attr(\"class\", \"height-focus-slope \");\r\n\t\t\t}\r\n\r\n\t\t\tthis._mouseSlopeFocusLabel\r\n\t\t\t\t.attr(\"dy\", \"1.5em\")\r\n\t\t\t\t.text(Math.round(item.slope) + \"%\");\r\n\r\n\t\t\tthis._mouseHeightFocusLabel.select('.height-focus-y')\r\n\t\t\t\t.attr(\"dy\", \"-1.5em\");\r\n\t\t}\r\n\t});\r\n\r\n\tthis.on(\"elechart_summary\", function() {\r\n\t\tthis.track_info.ascent = this._tAsc || 0;\r\n\t\tthis.track_info.descent = this._tDes || 0;\r\n\t\tthis.track_info.slope_max = this._sMax || 0;\r\n\t\tthis.track_info.slope_min = this._sMin || 0;\r\n\r\n\t\tthis.summaryDiv.querySelector('.minele').insertAdjacentHTML('afterend', '<span class=\"ascent\"><span class=\"summarylabel\">' + L._(\"Total Ascent: \") + '</span><span class=\"summaryvalue\">' + Math.round(this.track_info.ascent) + '&nbsp;' +\r\n\t\t\tthis._yLabel +\r\n\t\t\t'</span></span>' + '<span class=\"descent\"><span class=\"summarylabel\">' + L._(\"Total Descent: \") + '</span><span class=\"summaryvalue\">' + Math.round(this.track_info.descent) + '&nbsp;' + this._yLabel +\r\n\t\t\t'</span></span>' + '<span class=\"minslope\"><span class=\"summarylabel\">' + L._(\"Min Slope: \") + '</span><span class=\"summaryvalue\">' + this.track_info.slope_min + '&nbsp;' + '%' +\r\n\t\t\t'</span></span>' + '<span class=\"maxslope\"><span class=\"summarylabel\">' + L._(\"Max Slope: \") + '</span><span class=\"summaryvalue\">' + this.track_info.slope_max + '&nbsp;' + '%' +\r\n\t\t\t'</span></span>');\r\n\t});\r\n\r\n\tthis.on(\"eledata_clear\", function() {\r\n\t\tthis._sMax = null;\r\n\t\tthis._sMin = null;\r\n\t\tthis._tAsc = null;\r\n\t\tthis._tDes = null;\r\n\t});\r\n\r\n});\r\n","/*\r\n * Copyright (c) 2019, GPL-3.0+ Project, Raruto\r\n *\r\n *  This file is free software: you may copy, redistribute and/or modify it\r\n *  under the terms of the GNU General Public License as published by the\r\n *  Free Software Foundation, either version 2 of the License, or (at your\r\n *  option) any later version.\r\n *\r\n *  This file is distributed in the hope that it will be useful, but\r\n *  WITHOUT ANY WARRANTY; without even the implied warranty of\r\n *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\r\n *  General Public License for more details.\r\n *\r\n *  You should have received a copy of the GNU General Public License\r\n *  along with this program.  If not, see .\r\n *\r\n * This file incorporates work covered by the following copyright and\r\n * permission notice:\r\n *\r\n *     Copyright (c) 2013-2016, MIT License, Felix “MrMufflon” Bache\r\n *\r\n *     Permission to use, copy, modify, and/or distribute this software\r\n *     for any purpose with or without fee is hereby granted, provided\r\n *     that the above copyright notice and this permission notice appear\r\n *     in all copies.\r\n *\r\n *     THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL\r\n *     WARRANTIES WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED\r\n *     WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE\r\n *     AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR\r\n *     CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS\r\n *     OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT,\r\n *     NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN\r\n *     CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.\r\n */\r\n\r\nimport 'leaflet-i18n';\r\nimport * as _ from './utils';\r\nimport * as D3 from './components';\r\nimport { Chart } from './chart';\r\nimport { Elevation } from './control';\r\nimport './altitude';\r\nimport './slope';\r\n\r\nElevation.Utils = _;\r\nElevation.Components = D3;\r\nElevation.Chart = Chart;\r\n\r\nL.control.elevation = (options) => new Elevation(options);\r\n"],"names":["factory","window","define","amd","exports","module","require","L","locales","locale","registerLocale","code","Util","extend","setLocale","i18n","_","translate","string","data","template","err","deepMerge","target","sources","length","source","shift","isObject","key","Object","assign","deferFunc","f","document","readyState","addEventListener","once","formatter","num","dec","sep","res","formatNum","toString","numbers","split","d","join","GeoJSONLoader","control","JSON","parse","layer","geoJson","style","feature","options","polyline","theme","className","pointToLayer","latlng","marker","icon","gpxOptions","marker_options","wptIcons","desc","properties","name","bindPopup","openPopup","fire","point","point_type","element","onEachFeature","geometry","type","addData","track_info","Control","Elevation","_d3LazyLoader","then","_fireEvt","GPXLoader","polyline_options","GPX","on","e","line","get_name","isDomVisible","elem","offsetWidth","offsetHeight","getClientRects","item","Array","isArray","isVisible","styles","getComputedStyle","isVisibleByStyles","visibility","display","isAboveOtherElements","boundingRect","getBoundingClientRect","left","right","top","bottom","above","pointerEvents","elementFromPoint","isJSONDoc","doc","lazy","trim","indexOf","console","warn","isXMLDoc","documentElement","ownerDocument","nodeName","lazyLoader","url","skip","loader","Promise","resolve","reject","tag","createElement","src","head","appendChild","loadFile","success","xhr","XMLHttpRequest","responseType","open","onload","response","onerror","status","send","saveFile","dataURI","fileName","a","create","href","download","b","body","click","removeChild","waitHolder","ticking","scrollFn","requestAnimFrame","removeEventListener","addClass","targetNode","each","s","DomUtil","removeClass","toggleClass","conditional","call","value","getStyle","setProperty","tagName","attributes","parent","setAttributes","append","child","insert","position","insertAdjacentElement","attrs","k","setAttribute","select","selector","context","querySelector","DomEvent","off","hasClass","randomId","Math","random","substr","obj","fn","i","Area","xAttr","yAttr","scaleX","scaleY","height","interpolation","path","d3","area","curve","x","xDiagCoord","y0","y1","datum","attr","AreaPath","props","Axis","tickSize","tickPadding","width","axis","scale","ticks","tickFormat","label","labelX","labelY","g","w","h","axisScale","replace","l","toUpperCase","axisGroup","text","DragRectangle","dragStartCoords","dragEndCoords","rect","x1","min","x2","max","FocusRect","Grid","HeightFocusLine","xCoord","yCoord","HeightFocusLabel","y","node","selectAll","HeightFocusPoint","circle","LegendItem","margins","toLowerCase","MouseFocusLine","MouseFocusLabel","xAlign","yAlign","bbox","getBBox","Browser","webkit","Infinity","Scale","forceBounds","range","domain","extent","scaleLinear","Bisect","bisector","invert","Chart","Class","includes","Evented","prototype","Mixin","Events","initialize","opts","_data","_draggingEnabled","dragging","imperial","_xLabel","_yLabel","xLabel","yLabel","_xTicks","xTicks","_yTicks","yTicks","_updateScale","svg","_svg","_appendGrid","_appendAxis","_appendAreaPath","_appendFocusable","_appendLegend","_grid","_area","_path","_axis","_focus","_focusRect","_legend","_x","_y","update","_updateAxis","_updateAreaPath","render","container","D3","_width","xAxisMin","xAxisMax","forceAxisBounds","_height","yAxisMin","yAxisMax","remove","_appendXGrid","_appendYGrid","_appendXaxis","_appendYaxis","_appendFocusRect","_appendMouseFocusG","focusRect","mobile","_dragStartHandler","bind","_dragHandler","_mousemoveHandler","_dragEndHandler","_mouseenterHandler","_mouseoutHandler","focusG","_focusG","_focusline","_focuslabel","legend","event","preventDefault","stopPropagation","_gotDragged","_drawDragRectangle","_dragStartCoords","mouse","_dragRectangle","_dragCurrentCoords","_resetDrag","start","_findIndexForXCoord","end","dragstart","dragend","ctx","coords","_findIndexForLatLng","_hideDiagramIndicator","_showDiagramIndicator","xCoordinate","classed","hoverNumber","decimalsX","decimalsY","fx","fy","yCoordinate","Marker","_heightG","_mouseHeightFocus","_pointG","_mouseHeightFocusLabel","_marker","markerIcon","zIndexOffset","interactive","addTo","map","_map","pane","renderer","getPane","_pane","createPane","zIndex","_latlng","latLngToLayerPoint","normalizedAlt","maxElevation","z","normalizedY","getElement","setLatLng","getLatLng","Summary","summary","_summary","reset","innerHTML","Options","autohide","autohideMarker","collapsed","detached","distanceFactor","downloadLink","elevationDiv","followMarker","async","startIconUrl","endIconUrl","shadowUrl","divIcon","html","iconSize","iconAnchor","heightFactor","lazyLoadJS","loadData","defer","placeholder","color","opacity","weight","lineCap","reverseCoords","skipNullZCoords","responsive","slope","sDeltaMax","sInterpolation","sRange","undefined","zFollow","_layers","featureGroup","_chartEnabled","__mileFactor","__footFactor","__D3","__LGPX","_addData","_addLayer","eleDiv","_initElevationDiv","isConnected","_container","onAdd","clear","_chart","clearLayers","_distance","disableDragging","enableDragging","fitBounds","bounds","getBounds","isValid","latLngBounds","getZFollow","_zFollow","hide","_distanceFactor","_heightFactor","_setMapView","throttle","load","loadChart","loadDefer","loadLazy","loadGPX","loadGeoJSON","_downloadURL","catch","_gpxLazyLoader","parentNode","alt","_initToggle","_initChart","_initMarker","_initLayer","_hideMarker","_resetView","_resizeChart","_updateChart","_updateSummary","onRemove","redraw","setZFollow","zoom","show","geom","feat","gpx","_latlngs","_addGeoJSONData","coordinates","features","_addGPXData","_addPoint","lat","lng","meta","ele","dist","curr","LatLng","prev","delta","distanceTo","round","push","distance","index","addLayer","id","_collapse","_expand","_findItemForLatLng","_findItemForX","propagate","offWi","offHe","_maxWidth","containerWidth","clientWidth","chart","summaryDiv","toggleEvt","_mousemoveLayerHandler","disableClickPropagation","_mousewheelHandler","link","_button","title","stop","_toggle","_updateMarker","gestureHandling","_enabled","ll","getCenter","getZoom","sign","deltaY","flyTo","_isFullscreen","newWidth","removeControl","setView","animate","duration","_maxElevation","elevation_max","elevation_min","_minElevation","onclick","confirm","addInitHook","p","pop","_popup","_content","decodeURI","bindTooltip","direction","sticky","openTooltip","enable","nodes","eachLayer","n","getAttribute","CustomEvent","dispatchEvent","detail","eleMax","eleMin","prevZ","isNaN","lastZ","_lastValidZ","currZ","splice","_altitudeLegend","toFixed","tAsc","_tAsc","tDes","_tDes","sMax","_sMax","sMin","_sMin","deltaZ","deltaS","maxDeltaS","abs","ascent","descent","slope_max","slope_min","_focuslabelSlope","property","_mouseSlopeFocusLabel","insertAdjacentHTML","Utils","Components","elevation"],"mappings":"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"}